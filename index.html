<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Open Case Studies : Disparities in Youth Disconnection</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
#rmd-source-code {
  display: none;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Open Case Studies : Disparities in Youth Disconnection</h1>

</div>


<style>
#TOC {
  background: url("https://opencasestudies.github.io/img/logo.jpg");
  background-size: contain;
  padding-top: 240px !important;
  background-repeat: no-repeat;
}
</style>
<style>
div.red { background-color:#ffcccb; border-radius: 5px; padding: 20px;}
</style>
<div class="red">
<p><strong>MICHAEL ONTIVEROS</strong></p>
<p><em>There are some existing typos in the tables in addition to those produced during the use of Magick. I made some assumptions along the way, documenting them. These need to be checked for accuracy.</em></p>
</div>
<div id="section" class="section level4 outline">
<h4></h4>
</div>
<div id="section-1" class="section level4">
<h4></h4>
</div>
<div id="section-2" class="section level2 disclaimer_block">
<h2></h2>
<p><strong>Disclaimer</strong>: The purpose of the <a href="https://opencasestudies.github.io" target="_blank">Open Case Studies</a> project is <strong>to demonstrate the use of various data science methods, tools, and software in the context of messy, real-world data</strong>. A given case study does not cover all aspects of the research process, is not claiming to be the most appropriate way to analyze a given data set, and should not be used in the context of making policy decisions without external consultation from scientific experts.</p>
</div>
<div id="section-3" class="section level2 license_block">
<h2></h2>
<p>This work is licensed under the Creative Commons Attribution-NonCommercial 3.0 <a href="https://creativecommons.org/licenses/by-nc/3.0/us/" target="_blank">(CC BY-NC 3.0)</a> United States License.</p>
</div>
<div id="section-4" class="section level2 reference_block">
<h2></h2>
<p>To cite this case study please use:</p>
<p>Wright, Carrie, and Ontiveros, Michael and Jager, Leah and Taub, Margaret and Hicks, Stephanie. (2020). <a href="https://github.com/opencasestudies/ocs-youth-disconnection-case-study" class="uri">https://github.com/opencasestudies/ocs-youth-disconnection-case-study</a>. Disparities in Youth Disconnection (Version v1.0.0).</p>
</div>
<div id="motivation" class="section level2">
<h2><strong>Motivation</strong></h2>
<hr />
<p>According to this <a href="https://ssrc-static.s3.amazonaws.com/moa/Making%20the%20Connection.pdf">report</a> youth disconnection although generally showing decreasing trends for the past 7 years, shows racial and ethnic disparities, where some groups are showing increased rates of disconnection.</p>
<p>So what deos the term <strong>“youth disconnection”</strong> mean?</p>
<p>According to <a href="https://www.ssrc.org/programs/view/moa/" target="_blank">Measure of America</a> (a nonpartisan project of the nonprofit <a href="https://www.ssrc.org/" target="_blank">Social Science Research Council</a> that is focused on opportunity in the United States) disconnected youth are:</p>
<blockquote>
<p>“young people between the ages of <strong>16 and 24</strong> who are <strong>neither working nor in school</strong>”</p>
</blockquote>
<p>They state that such disconnection hinders these individuals to aquire skills and create relationships necessary to have a sucessful adulthood.</p>
<p>They state that:</p>
<blockquote>
<p>“people who experience a period of disconnection as young adults go on to <strong>earn less</strong> and are <strong>less likely</strong> to be <strong>employed, own a home, or report good health</strong> by the time they reach their thirties”</p>
</blockquote>
<p>We will expand beyond the <a href="https://ssrc-static.s3.amazonaws.com/moa/Making%20the%20Connection.pdf" target="_blank">Measure of America annual report</a> to create visualizations of percent disconnection of more specific groups of youths (gender, ethnic groups etc.) graphed together over time to allow for easier comparison.</p>
<p><a href="https://onlinelibrary.wiley.com/doi/full/10.1111/1468-0009.12425" class="uri">https://onlinelibrary.wiley.com/doi/full/10.1111/1468-0009.12425</a></p>
</div>
<div id="main-questions" class="section level2">
<h2><strong>Main Questions</strong></h2>
<hr />
<div id="section-5" class="section level4 main_question_block">
<h4></h4>
<p><b><u> Our main question: </u></b></p>
<ol style="list-style-type: decimal">
<li>What differences in youth disconnection rates exist in 2017?</li>
</ol>
<p>How have youth disconnection rates in American youth changed since 2008? In particular, how has this changed for different states, gender, and ethnic groups? Are any groups particularly disconnected?</p>
</div>
<div id="section-6" class="section level4">
<h4></h4>
</div>
</div>
<div id="learning-objectives" class="section level2">
<h2><strong>Learning Objectives</strong></h2>
<hr />
<p>In this case study, we will demonstrate how to import and wrangle data available in the <u><strong>P</strong></u>ortable <u><strong>D</strong></u>ocument <u><strong>F</strong></u>ormat (<strong>PDF</strong>). We will especially focus on using packages and functions from the <a href="https://www.tidyverse.org/" target="_blank"><code>Tidyverse</code></a>, such as <code>dplyr</code>, <code>ggplot2</code>. The tidyverse is a library of packages created by RStudio. While some students may be familiar with previous R programming packages, these packages make data science in R especially efficient.</p>
<p>The skills, methods, and concepts that students will be familiar with by the end of this case study are:</p>
<p>Data science skills:</p>
<ol style="list-style-type: decimal">
<li>Importing data from PDF files using the <code>magick</code> package</li>
<li>Apply action verbs in <code>dplyr</code> for data wrangling</li>
<li>How to pivot between “long” and “wide” datasets</li>
<li>Joining together multiple datasets using <code>dplyr</code></li>
<li>How to create data visualizations with <code>ggplot2</code> that are in a similar style to an existing image</li>
</ol>
<p>Statistical concepts and methods:</p>
<p><img src="https://tidyverse.tidyverse.org/logo.png" width="20%" style="display: block; margin: auto;" /></p>
<hr />
<p>We will begin by loading the packages that we will need:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(here)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">library</span>(pdftools)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw">library</span>(magick)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw">library</span>(cowplot)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="kw">library</span>(Kendall)</a></code></pre></div>
<style>
div.green { background-color:#90EE90; border-radius: 5px; padding: 20px;}
</style>
<div class="green">
<p><strong>MICHAEL ONTIVEROS</strong> <em>I changed the way the table looks below to present the package names in bold. Many of these case studies have lots of text. Having important features of a case study presented in bold, italics, or both may make the document more easily interpretable. This is just my two ¢. Feel free to disregard this suggestion for any reason.</em></p>
</div>
<table>
<thead>
<tr class="header">
<th>Package</th>
<th>Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="https://github.com/jennybc/here_here" target="_blank"><strong>here</strong></a></td>
<td>to easily load and save data</td>
</tr>
<tr class="even">
<td><a href="https://readr.tidyverse.org/" target="_blank"><strong>tidyverse</strong></a></td>
<td>for data science operations</td>
</tr>
<tr class="odd">
<td><a href="https://readr.tidyverse.org/" target="_blank"><strong>pdftools</strong></a></td>
<td>to manage PDF documents</td>
</tr>
<tr class="even">
<td><a href="https://cran.r-project.org/web/packages/magick/vignettes/intro.html#Kernel_convolution" target="_blank"><strong>magick</strong></a></td>
<td>for image processing</td>
</tr>
</tbody>
</table>
<p>The first time we use a function, we will use the <code>::</code> to indicate which package we are using. Unless we have overlapping function names, this is not necessary, but we will include it here to be informative about where the functions we will use come from.</p>
</div>
<div id="context" class="section level2">
<h2><strong>Context</strong></h2>
<hr />
<p><img src="img/risk_factors.png" width="800 px" style="display: block; margin: auto;" /> ##### <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6243446/pdf/10.1177_0033354918799344.pdf" target="_blank">[source]</a></p>
</div>
<div id="limitations" class="section level2">
<h2><strong>Limitations</strong></h2>
<hr />
<style>
div.green { background-color:#90EE90; border-radius: 5px; padding: 20px;}
</style>
<div class="green">
<p><strong>MICHAEL ONTIVEROS</strong></p>
<p><em>I compared the mechanics of image processing tools to a black box process. I feel it brings in some vocab while highlighting that this type of tool requires caution. Feel free to update as you think appropriate.</em></p>
</div>
<p>There are some important considerations regarding this data analysis to keep in mind:</p>
<ol style="list-style-type: decimal">
<li><p>The statistical procedures we are using may be overly simplistic. <em>We need to be wary about deriving meaning from the statistical procedures we use</em>.</p></li>
<li><p>Using image processing tools can be very helpful. The manner in which data is obtained with image processing tools is what we would describe as a <strong>black box process</strong>, <u><em>a process with known inputs and outputs but unknown mechanics</em></u>. Because we are unaware of how our outputs are generate from our inputs, we need to be wary of the output. With the small output we are creating in this case study, a visual inspection should suffice.</p></li>
</ol>
</div>
<div id="what-are-the-data" class="section level2">
<h2><strong>What are the data?</strong></h2>
<hr />
<p>In this case study we will be using data related to youth disconnection from the two following reports from the <a href="https://www.ssrc.org/programs/view/moa/" target="_blank">Measure of America</a> project:</p>
<blockquote>
<p>Measure of America is a nonpartisan project of the nonprofit <a href="https://www.ssrc.org/" target="_blank">Social Science Research Council</a> founded in 2007 to create easy-to-use yet methodologically sound tools for understanding well-being and opportunity in America. Through reports, interactive apps, and custom-built dashboards, Measure of America works with partners to breathe life into numbers, using data to identify areas of highest need, pinpoint levers for change, and track progress over time.</p>
</blockquote>
<ol style="list-style-type: decimal">
<li>Lewis, Kristen. <a href="https://ssrc-static.s3.amazonaws.com/moa/Making%20the%20Connection.pdf" target="_blank">Making the Connection: Transportation and Youth Disconnection</a> . New York: Measure of America, Social Science Research Council, 2019. (Data up to 2017)</li>
<li>: Lewis, Kristen. <a href="https://ssrc-static.s3.amazonaws.com/moa/ADecadeUndone.pdf" target="_blank">A Decade Undone: Youth Disconnection in the Age of Coronavirus</a> . New York: Measure of America, Social Science Research Council, 2020. (Data up to 2018)</li>
</ol>
</div>
<div id="data-import" class="section level2">
<h2><strong>Data Import</strong></h2>
<hr />
<p>One way to import data from a pdf is to use the <code>pdftools</code> packages.</p>
<p>From the output, it’s clear that a large amount of manipulation will be required to wrangle this data with the <code>pdftools</code> package.</p>
<div id="section-7" class="section level4 scrollable">
<h4></h4>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">pdf_data_example &lt;-<span class="st"> </span>pdftools<span class="op">::</span><span class="kw">pdf_data</span>(<span class="kw">here</span>(<span class="st">&quot;docs&quot;</span>, <span class="st">&quot;Making_the_Connection.pdf&quot;</span>))</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">utils<span class="op">::</span><span class="kw">head</span>(pdf_data_example, <span class="dv">1</span>)</a></code></pre></div>
<pre><code>[[1]]
# A tibble: 51 x 6
   width height     x     y space text    
   &lt;int&gt;  &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;lgl&gt; &lt;chr&gt;   
 1    74     23    36    53 TRUE  KRISTEN 
 2    54     23   115    53 FALSE LEWIS   
 3    31     11    36    79 TRUE  Rupsha  
 4    20     11    69    79 TRUE  Basu    
 5     2     11    94    79 TRUE  |       
 6    34     11   101    79 TRUE  REPORT  
 7    43     11   138    79 FALSE DESIGNER
 8    34     11    36    92 TRUE  Rebecca 
 9    31     11    73    92 TRUE  Gluskin 
10     2     11   109    92 TRUE  |       
# … with 41 more rows</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">pdf_tools_example &lt;-<span class="st"> </span>pdftools<span class="op">::</span><span class="kw">pdf_text</span>(<span class="kw">here</span>(<span class="st">&quot;docs&quot;</span>,<span class="st">&quot;Making_the_Connection.pdf&quot;</span>))</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="kw">head</span>(pdf_tools_example, <span class="dv">1</span>)</a></code></pre></div>
<pre><code>[1] &quot;KRISTEN LEWIS\nRupsha Basu | REPORT DESIGNER\nRebecca Gluskin | CHIEF STATISTICIAN\nLaura Laderman | DATA ANALYST\nVikki Lassiter | STAKEHOLDER ENGAGEMENT\nBecky Ofrane | RESEARCHER\nBeth Post | REPORT DESIGNER\nMarina Recio | RESEARCHER\nMAKING THE CONNECTION\nTRANSPORTATION AND YOUTH DISCONNECTION\n                                        MEA SUREOF AMERICA\n                                        of the Social Science Research Council\n&quot;</code></pre>
</div>
<div id="section-8" class="section level4">
<h4></h4>
<p>While not impossible, it’s hard not to argue that using the <code>pdftools</code> package in this scenario will require a lot of advanced data wrangling. While our output may be reproducible, the amount of time to achieve this reproducibility may not be any more efficient than typing the table by hand into a text or spreadsheet program.</p>
<p>Fortunately, there is another way we can proceed to wrangle the data.</p>
<p>We will demonstrate how to produce reproducible tables with image processing software in <code>R</code>.</p>
<p>For demonstrative purposes, we will import two sets of data. The first set of data will be used to highlight common errors that the image processing software may produce. The second set of data will be used to demonstrate how to circumvent these errors and produce reproducible datasets efficiently.</p>
<p>We will now import the data using the <code>magick</code> and <code>here</code> packages.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co">#bold is causing issues</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">image_example &lt;-<span class="st"> </span>magick<span class="op">::</span><span class="kw">image_read</span>(here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;img&quot;</span>, <span class="st">&quot;gender_race_ethnicity.png&quot;</span>))</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"></a>
<a class="sourceLine" id="cb6-4" data-line-number="4">magick<span class="op">::</span><span class="kw">image_info</span>(image_example)</a></code></pre></div>
<pre><code># A tibble: 1 x 7
  format width height colorspace matte filesize density
  &lt;chr&gt;  &lt;int&gt;  &lt;int&gt; &lt;chr&gt;      &lt;lgl&gt;    &lt;int&gt; &lt;chr&gt;  
1 PNG      997    711 sRGB       TRUE    164964 72x72  </code></pre>
<p>We import the same data—this time without regions of the table without special formatting—using the <code>magick</code> and <code>here</code> packages.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co">#bold is causing issues</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">image1 &lt;-<span class="st"> </span><span class="kw">image_read</span>(<span class="kw">here</span>(<span class="st">&quot;img&quot;</span>, <span class="st">&quot;gender_race_ethnicity2.png&quot;</span>))</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"></a>
<a class="sourceLine" id="cb8-4" data-line-number="4">magick<span class="op">::</span><span class="kw">image_info</span>(image1)</a></code></pre></div>
<pre><code># A tibble: 1 x 7
  format width height colorspace matte filesize density
  &lt;chr&gt;  &lt;int&gt;  &lt;int&gt; &lt;chr&gt;      &lt;lgl&gt;    &lt;int&gt; &lt;chr&gt;  
1 PNG     1259    731 sRGB       TRUE    188256 72x72  </code></pre>
</div>
</div>
<div id="data-exploration-and-wrangling" class="section level2">
<h2><strong>Data Exploration and Wrangling</strong></h2>
<hr />
<p>The first image we imported looks like this.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">image_example</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-8-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Parts of the table depicted in the image above contain <a href="https://en.wikipedia.org/wiki/Newline?oldformat=true"><strong>newline</strong></a> characters. A newline character denotes the end of a line of text and the start of a new line of text.</p>
<p>This makes it more difficult to wrangle this table. Wrangling the data via regular expressions may be very tedious. It’s unlikely that image processing software can handle the newline characters—or any other special characters—correctly.</p>
<p>Using <code>image_ocr()</code> by <code>magick</code> on the image above will render some errors in the first few lines.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">df1 &lt;-<span class="st"> </span>magick<span class="op">::</span><span class="kw">image_ocr</span>(image_example)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"></a>
<a class="sourceLine" id="cb11-3" data-line-number="3">df1 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="st">  </span>base<span class="op">::</span><span class="kw">strsplit</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="st">  </span>base<span class="op">::</span><span class="kw">unlist</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="st">  </span>tibble<span class="op">::</span><span class="kw">as_tibble</span>()</a></code></pre></div>
<pre><code># A tibble: 21 x 1
   value                                                  
   &lt;chr&gt;                                                  
 1 Youth Disconnection by Gender and by Race and Ethnicity
 2 byte) ee                                               
 3 MAJOR RACIAL AND Cr erent) ed Nas                      
 4 United States 126 147 14.1 13.21.7115 4,501,800 22.1   
 5 Male 12.3 15.2 14.5 13.3 12.1 11.8 2,382,500 -22.5     
 6 Female 12.9 14.1 13.7 13.0 11.2 11.1 2,119,400 -21.7   
 7 ASIAN 71 85 78 19 66 66 145,600 -21.7                  
 8 Asian Male 6.3 8.3 74 7.2 6.7 65 73,000 -21.4          
 9 Asian Female 7.9 8.6 8.1 8.6 6.6 6.7 72,600 -22.0      
10 WHITE 97 210897 9.4 1,961,700 -20.1                    
# … with 11 more rows</code></pre>
<p>If we remove these lines, some new errors emerge.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">df1 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="st">    </span>base<span class="op">::</span><span class="kw">strsplit</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="st">  </span>base<span class="op">::</span><span class="kw">unlist</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="st">  </span>tibble<span class="op">::</span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">slice</span>(<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>))</a></code></pre></div>
<pre><code># A tibble: 18 x 1
   value                                                           
   &lt;chr&gt;                                                           
 1 United States 126 147 14.1 13.21.7115 4,501,800 22.1            
 2 Male 12.3 15.2 14.5 13.3 12.1 11.8 2,382,500 -22.5              
 3 Female 12.9 14.1 13.7 13.0 11.2 11.1 2,119,400 -21.7            
 4 ASIAN 71 85 78 19 66 66 145,600 -21.7                           
 5 Asian Male 6.3 8.3 74 7.2 6.7 65 73,000 -21.4                   
 6 Asian Female 7.9 8.6 8.1 8.6 6.6 6.7 72,600 -22.0               
 7 WHITE 97 210897 9.4 1,961,700 -20.1                             
 8 White Male 95 12.3 11.5 10.8 10.0 9.6 1,031,200 -22.4           
 9 White Female 10.0 11.1 10.8 10.7 9.4 91 930,600 -17.4           
10 LATINO 167-185 17.3 15.2 13.7 =~ 138.2_—_—‘1,157,300 -28.7      
11 Latino Male 13.6 16.8 16.0 14.0 12.6 12.4 562,600 -26.0         
12 Latina Female 20.2 20.3 18.8 16.5 14.8 13.9 594,700 -31.5       
13 BLACK 20.4 225 224 206 17.2 17.9 999,700 -20.6                  
14 Black Male 23.7 26.0 25.6 23.5 20.1 20.8 591,600 -19.8          
15 Black Female 17.0 19.0 19.3 17.6 14.2 14.8 408,000 -22.1        
16 NATIVE AMERICAN 264 288 27.0 23 28 23.9 67,700 -17.1            
17 Native American Male 25.0 30.9 28.0 26.9 28.1 23.3 33,200 -24.5 
18 Native American Female 23.9 26.7 25.9 25.6 23.4 24.5 34,500 -B.4</code></pre>
<p>Data wrangling is not an exact science. The approaches we can take are extremely dependent on the data. We can exploit patterns in the data to render the output we desire.</p>
<p>We will now use a cropped version of the image above without the special formatting.</p>
<div id="section-9" class="section level4 scrollable">
<h4></h4>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw">rm</span>(df1)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2"></a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="kw">image_info</span>(image1)</a></code></pre></div>
<pre><code># A tibble: 1 x 7
  format width height colorspace matte filesize density
  &lt;chr&gt;  &lt;int&gt;  &lt;int&gt; &lt;chr&gt;      &lt;lgl&gt;    &lt;int&gt; &lt;chr&gt;  
1 PNG     1259    731 sRGB       TRUE    188256 72x72  </code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">base<span class="op">::</span><span class="kw">print</span>(image1)</a></code></pre></div>
<pre><code># A tibble: 1 x 7
  format width height colorspace matte filesize density
  &lt;chr&gt;  &lt;int&gt;  &lt;int&gt; &lt;chr&gt;      &lt;lgl&gt;    &lt;int&gt; &lt;chr&gt;  
1 PNG     1259    731 sRGB       TRUE    188256 72x72  </code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-11-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">df1 &lt;-<span class="st"> </span><span class="kw">image_ocr</span>(image1)</a>
<a class="sourceLine" id="cb19-2" data-line-number="2"></a>
<a class="sourceLine" id="cb19-3" data-line-number="3">df1 &lt;-<span class="st"> </span>df1 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="st">  </span><span class="kw">strsplit</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-5" data-line-number="5"><span class="st">  </span><span class="kw">unlist</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-6" data-line-number="6"><span class="st">  </span><span class="kw">as_tibble</span>()</a></code></pre></div>
</div>
<div id="section-10" class="section level4">
<h4></h4>
<p>We have several strings. Each cell of data is on a string separated by space.</p>
<p>We separate each string by space.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">df1 &lt;-<span class="st"> </span>df1 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(value) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="st">  </span><span class="kw">pull</span>(value) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="st">  </span><span class="kw">str_split</span>(<span class="st">&quot; &quot;</span>)</a></code></pre></div>
<p>We split the dataframe in two: a labels section and a “data” section containing the information we are interested in.</p>
<p>In the first half, we remove all digits and punctuation to ensure that we are left with character labels.</p>
<p>In the second-half, remove commas and periods, converting the resulting string character class to numeric and selectively multiplying columns to reintroduce the decimal point correctly</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">df1a &lt;-<span class="st"> </span>df1 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="st">  </span>purrr<span class="op">::</span><span class="kw">map</span>(<span class="op">~</span>base<span class="op">::</span><span class="kw">paste</span>(.,<span class="dt">collapse =</span> <span class="st">&quot;&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="st">  </span>purrr<span class="op">::</span><span class="kw">map</span>(<span class="op">~</span>base<span class="op">::</span><span class="kw">gsub</span>(<span class="st">&quot;[[:digit:]]+|[[:punct:]]+&quot;</span>, <span class="st">&quot;&quot;</span>,.)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-4" data-line-number="4"><span class="st">  </span>base<span class="op">::</span><span class="kw">do.call</span>(base<span class="op">::</span>rbind,.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-5" data-line-number="5"><span class="st">  </span>base<span class="op">::</span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-6" data-line-number="6"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">tibble</span>()</a>
<a class="sourceLine" id="cb21-7" data-line-number="7"></a>
<a class="sourceLine" id="cb21-8" data-line-number="8">df1b &lt;-<span class="st"> </span><span class="kw">map</span>(df1, tail, <span class="dv">8</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-9" data-line-number="9"><span class="st">  </span><span class="kw">map</span>(<span class="op">~</span><span class="kw">gsub</span>(<span class="st">&quot;[,]+|[.]+&quot;</span>, <span class="st">&quot;&quot;</span>,.)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-10" data-line-number="10"><span class="st">  </span><span class="kw">do.call</span>(rbind,.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-11" data-line-number="11"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-12" data-line-number="12"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_if</span>(base<span class="op">::</span>is.character, base<span class="op">::</span>as.numeric) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-13" data-line-number="13"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(<span class="op">-</span>X7), <span class="op">~</span><span class="st"> </span>. <span class="op">*</span><span class="st"> </span><span class="fl">0.1</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-14" data-line-number="14"><span class="st">  </span><span class="kw">tibble</span>() </a>
<a class="sourceLine" id="cb21-15" data-line-number="15"></a>
<a class="sourceLine" id="cb21-16" data-line-number="16">base<span class="op">::</span><span class="kw">rm</span>(df1)</a></code></pre></div>
<p>We combine the two sections of data to create our dataframe, removing and then adding column names.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">df1 &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">bind_cols</span>(df1a,</a>
<a class="sourceLine" id="cb22-2" data-line-number="2">                        df1b)</a>
<a class="sourceLine" id="cb22-3" data-line-number="3"></a>
<a class="sourceLine" id="cb22-4" data-line-number="4">base<span class="op">::</span><span class="kw">names</span>(df1) &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb22-5" data-line-number="5"></a>
<a class="sourceLine" id="cb22-6" data-line-number="6">column_names &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Group&quot;</span>,</a>
<a class="sourceLine" id="cb22-7" data-line-number="7">                  <span class="st">&quot;Perc_2008&quot;</span>,</a>
<a class="sourceLine" id="cb22-8" data-line-number="8">                  <span class="st">&quot;Perc_2010&quot;</span>,</a>
<a class="sourceLine" id="cb22-9" data-line-number="9">                  <span class="st">&quot;Perc_2012&quot;</span>,</a>
<a class="sourceLine" id="cb22-10" data-line-number="10">                  <span class="st">&quot;Perc_2014&quot;</span>,</a>
<a class="sourceLine" id="cb22-11" data-line-number="11">                  <span class="st">&quot;Perc_2016&quot;</span>,</a>
<a class="sourceLine" id="cb22-12" data-line-number="12">                  <span class="st">&quot;Perc_2017&quot;</span>,</a>
<a class="sourceLine" id="cb22-13" data-line-number="13">                  <span class="st">&quot;N_2017&quot;</span>,</a>
<a class="sourceLine" id="cb22-14" data-line-number="14">                  <span class="st">&quot;Delta_perc&quot;</span>)</a>
<a class="sourceLine" id="cb22-15" data-line-number="15"></a>
<a class="sourceLine" id="cb22-16" data-line-number="16">base<span class="op">::</span><span class="kw">colnames</span>(df1) &lt;-<span class="st"> </span>column_names</a></code></pre></div>
<p>We remove columns with information we don’t need and use the commmon pattern in the column names to convert the data into <a href="https://en.wikipedia.org/wiki/Wide_and_narrow_data?oldformat=true">long/narrow format</a>.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">df1 &lt;-<span class="st"> </span>df1 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>N_<span class="dv">2017</span>,</a>
<a class="sourceLine" id="cb23-3" data-line-number="3">                <span class="op">-</span>Delta_perc)</a>
<a class="sourceLine" id="cb23-4" data-line-number="4"></a>
<a class="sourceLine" id="cb23-5" data-line-number="5">df1 &lt;-<span class="st"> </span>df1 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-6" data-line-number="6"><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols=</span><span class="kw">contains</span>(<span class="st">&quot;Perc_&quot;</span>),</a>
<a class="sourceLine" id="cb23-7" data-line-number="7">                      <span class="dt">names_to =</span> <span class="st">&quot;Year&quot;</span>,</a>
<a class="sourceLine" id="cb23-8" data-line-number="8">                      <span class="dt">values_to =</span> <span class="st">&quot;Rate&quot;</span>,</a>
<a class="sourceLine" id="cb23-9" data-line-number="9">                      <span class="dt">names_prefix =</span> <span class="st">&quot;Perc_&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-10" data-line-number="10"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">Year =</span> <span class="kw">as.numeric</span>(Year))</a></code></pre></div>
<p>We use the <code>dplyr::case_when()</code> and <code>stringr::str_detect()</code> function to detect patterns and create an separate column with gender and race information.</p>
<p>The two columns created contain <code>TRUE/FALSE</code> statements. These are then used to create a third column that will allow us to separate the data by its summary level.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1">df1 &lt;-<span class="st"> </span>df1 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Gender =</span> dplyr<span class="op">::</span><span class="kw">case_when</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(Group, <span class="st">&quot;Female&quot;</span>) <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb24-3" data-line-number="3">                            stringr<span class="op">::</span><span class="kw">str_detect</span>(Group, <span class="st">&quot;Male&quot;</span>) <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb24-4" data-line-number="4">                            <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">NA</span>),</a>
<a class="sourceLine" id="cb24-5" data-line-number="5">         <span class="dt">Race =</span> stringr<span class="op">::</span><span class="kw">str_remove_all</span>(Group,</a>
<a class="sourceLine" id="cb24-6" data-line-number="6">                               <span class="dt">pattern =</span> <span class="kw">paste</span>(<span class="kw">c</span>(<span class="st">&quot;Female&quot;</span>,<span class="st">&quot;Male&quot;</span>,<span class="st">&quot;UnitedStates&quot;</span>),</a>
<a class="sourceLine" id="cb24-7" data-line-number="7">                                               <span class="dt">collapse =</span> <span class="st">&quot;|&quot;</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Race =</span> dplyr<span class="op">::</span><span class="kw">na_if</span>(Race, <span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb24-9" data-line-number="9"></a>
<a class="sourceLine" id="cb24-10" data-line-number="10">df1 &lt;-<span class="st"> </span>df1 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb24-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Type =</span> <span class="kw">case_when</span>(base<span class="op">::</span><span class="kw">is.na</span>(Gender) <span class="op">&amp;</span><span class="st"> </span>base<span class="op">::</span><span class="kw">is.na</span>(Race) <span class="op">~</span><span class="st"> &quot;US Total&quot;</span>,</a>
<a class="sourceLine" id="cb24-12" data-line-number="12">                          base<span class="op">::</span><span class="kw">is.na</span>(Gender) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span>base<span class="op">::</span><span class="kw">is.na</span>(Race) <span class="op">~</span><span class="st"> &quot;Race Total&quot;</span>,</a>
<a class="sourceLine" id="cb24-13" data-line-number="13">                          <span class="op">!</span>base<span class="op">::</span><span class="kw">is.na</span>(Gender) <span class="op">&amp;</span><span class="st"> </span>base<span class="op">::</span><span class="kw">is.na</span>(Race) <span class="op">~</span><span class="st"> &quot;Gender Total&quot;</span>,</a>
<a class="sourceLine" id="cb24-14" data-line-number="14">                          <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Subgroup Total&quot;</span>))</a>
<a class="sourceLine" id="cb24-15" data-line-number="15"></a>
<a class="sourceLine" id="cb24-16" data-line-number="16">df1 &lt;-<span class="st"> </span>df1 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-17" data-line-number="17"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Gender =</span> <span class="kw">case_when</span>(<span class="kw">str_detect</span>(Group, <span class="st">&quot;Female&quot;</span>) <span class="op">~</span><span class="st"> &quot;Female&quot;</span>,</a>
<a class="sourceLine" id="cb24-18" data-line-number="18">                            <span class="kw">str_detect</span>(Group, <span class="st">&quot;Male&quot;</span>) <span class="op">~</span><span class="st"> &quot;Male&quot;</span>))</a></code></pre></div>
<p>The columns of <code>character</code> class currently contain upper and lower case characters. We want to ensure that we use a cases consistently to ensure that there are no errors driven by case-sensitive function downstream.</p>
<p>To do this, we use the <code>base::to_upper()</code> function. This function makes all characters uppercase.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">df1 &lt;-<span class="st"> </span>df1 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate_if</span>(is.character, toupper)</a></code></pre></div>
<p>Finally, we homogenize the labels assigned for certain groups, fill in missing (<code>NA</code>) values with a string, and remove columns we no longer need from the dataframe.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1">df1 &lt;-<span class="st"> </span>df1 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb26-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Race =</span> <span class="kw">case_when</span>(Race <span class="op">==</span><span class="st"> &quot;LATINA&quot;</span> <span class="op">~</span><span class="st"> &quot;LATINO/A&quot;</span>,</a>
<a class="sourceLine" id="cb26-3" data-line-number="3">                          Race <span class="op">==</span><span class="st"> &quot;LATINO&quot;</span> <span class="op">~</span><span class="st"> &quot;LATINO/A&quot;</span>,</a>
<a class="sourceLine" id="cb26-4" data-line-number="4">                          Race <span class="op">==</span><span class="st"> &quot;NATIVEAMERICAN&quot;</span> <span class="op">~</span><span class="st"> &quot;NATIVE AMERICAN&quot;</span>,</a>
<a class="sourceLine" id="cb26-5" data-line-number="5">                          <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span>Race)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb26-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Gender =</span> tidyr<span class="op">::</span><span class="kw">replace_na</span>(Gender, <span class="st">&quot;ALL&quot;</span>),</a>
<a class="sourceLine" id="cb26-7" data-line-number="7">         <span class="dt">Race =</span> tidyr<span class="op">::</span><span class="kw">replace_na</span>(Race, <span class="st">&quot;ALL&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb26-8" data-line-number="8"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>Group)</a></code></pre></div>
<p>We can repeat this process for the other two tables listed on page 39.</p>
<p>Let’s look at the table without the special formatting.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">image2 &lt;-<span class="st"> </span><span class="kw">image_read</span>(<span class="kw">here</span>(<span class="st">&quot;img&quot;</span>, <span class="st">&quot;asian_subgroups.png&quot;</span>))</a>
<a class="sourceLine" id="cb27-2" data-line-number="2">image2</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-19-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>As you can see, there are empty spaces. According to the PDF, these spaces are empty to denote that the estimates are unreliable.</p>
<p>This may cause problems. Whitespace must be handled differently. We may not want to process the entire image for this reason.</p>
<p>Instead, we can use separate images to ensure a simpler process like that above.</p>
<p>We read the three images.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1">image2a &lt;-<span class="st"> </span><span class="kw">image_read</span>(<span class="kw">here</span>(<span class="st">&quot;img&quot;</span>, <span class="st">&quot;asian_subgroupsA.png&quot;</span>))</a>
<a class="sourceLine" id="cb28-2" data-line-number="2">image2b &lt;-<span class="st"> </span><span class="kw">image_read</span>(<span class="kw">here</span>(<span class="st">&quot;img&quot;</span>, <span class="st">&quot;asian_subgroupsB.png&quot;</span>))</a>
<a class="sourceLine" id="cb28-3" data-line-number="3">image2c &lt;-<span class="st"> </span><span class="kw">image_read</span>(<span class="kw">here</span>(<span class="st">&quot;img&quot;</span>, <span class="st">&quot;asian_subgroupsC.png&quot;</span>))</a>
<a class="sourceLine" id="cb28-4" data-line-number="4"></a>
<a class="sourceLine" id="cb28-5" data-line-number="5">magick<span class="op">::</span><span class="kw">image_info</span>(image2a)</a></code></pre></div>
<pre><code># A tibble: 1 x 7
  format width height colorspace matte filesize density
  &lt;chr&gt;  &lt;int&gt;  &lt;int&gt; &lt;chr&gt;      &lt;lgl&gt;    &lt;int&gt; &lt;chr&gt;  
1 PNG      757    687 sRGB       TRUE     95660 72x72  </code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">magick<span class="op">::</span><span class="kw">image_info</span>(image2b)</a></code></pre></div>
<pre><code># A tibble: 1 x 7
  format width height colorspace matte filesize density
  &lt;chr&gt;  &lt;int&gt;  &lt;int&gt; &lt;chr&gt;      &lt;lgl&gt;    &lt;int&gt; &lt;chr&gt;  
1 PNG      751    177 sRGB       TRUE     28913 72x72  </code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1">magick<span class="op">::</span><span class="kw">image_info</span>(image2c)</a></code></pre></div>
<pre><code># A tibble: 1 x 7
  format width height colorspace matte filesize density
  &lt;chr&gt;  &lt;int&gt;  &lt;int&gt; &lt;chr&gt;      &lt;lgl&gt;    &lt;int&gt; &lt;chr&gt;  
1 PNG      760    216 sRGB       TRUE     33402 72x72  </code></pre>
<p>The images look like this.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1">image2a</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-21-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1">image2b</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-21-2.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1">image2c</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-21-3.png" width="90%" style="display: block; margin: auto;" /></p>
<p>We save the text from the images into objects.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1">df2a &lt;-<span class="st"> </span>magick<span class="op">::</span><span class="kw">image_ocr</span>(image2a)</a>
<a class="sourceLine" id="cb37-2" data-line-number="2">df2b &lt;-<span class="st"> </span>magick<span class="op">::</span><span class="kw">image_ocr</span>(image2b)</a>
<a class="sourceLine" id="cb37-3" data-line-number="3">df2c &lt;-<span class="st"> </span>magick<span class="op">::</span><span class="kw">image_ocr</span>(image2c)</a></code></pre></div>
<p>We process these objects separately. Note that we use a very similar process to that employed in the wrangling of the previous table.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1">df2a &lt;-<span class="st"> </span>df2a <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb38-2" data-line-number="2"><span class="st">  </span><span class="kw">strsplit</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb38-3" data-line-number="3"><span class="st">  </span><span class="kw">unlist</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb38-4" data-line-number="4"><span class="st">  </span><span class="kw">as_tibble</span>()</a>
<a class="sourceLine" id="cb38-5" data-line-number="5"></a>
<a class="sourceLine" id="cb38-6" data-line-number="6">df2b &lt;-<span class="st"> </span>df2b <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb38-7" data-line-number="7"><span class="st">  </span><span class="kw">strsplit</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb38-8" data-line-number="8"><span class="st">  </span><span class="kw">unlist</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb38-9" data-line-number="9"><span class="st">  </span><span class="kw">as_tibble</span>()</a>
<a class="sourceLine" id="cb38-10" data-line-number="10"></a>
<a class="sourceLine" id="cb38-11" data-line-number="11">df2c &lt;-<span class="st"> </span>df2c <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb38-12" data-line-number="12"><span class="st">  </span><span class="kw">strsplit</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb38-13" data-line-number="13"><span class="st">  </span><span class="kw">unlist</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb38-14" data-line-number="14"><span class="st">  </span><span class="kw">as_tibble</span>()</a></code></pre></div>
<p>We then combine the objects with the <code>dplyr::bind_rows()</code> function.</p>
<p>The process is now very similar to the previous table.</p>
<style>
div.red { background-color:#ffcccb; border-radius: 5px; padding: 20px;}
</style>
<div class="red">
<p><strong>MICHAEL ONTIVEROS</strong></p>
<p><em>I used base R to remove the first three rows of a dataframe in the following chunk. I am not aware of a tidyverse solution for this; I am sure one exists.</em></p>
</div>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1">df2 &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(df2a,</a>
<a class="sourceLine" id="cb39-2" data-line-number="2">          df2b,</a>
<a class="sourceLine" id="cb39-3" data-line-number="3">          df2c)</a>
<a class="sourceLine" id="cb39-4" data-line-number="4"></a>
<a class="sourceLine" id="cb39-5" data-line-number="5">df2 &lt;-<span class="st"> </span>df2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb39-6" data-line-number="6"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(value) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb39-7" data-line-number="7"><span class="st">  </span><span class="kw">pull</span>(value) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb39-8" data-line-number="8"><span class="st">  </span><span class="kw">str_split</span>(<span class="st">&quot; &quot;</span>)</a>
<a class="sourceLine" id="cb39-9" data-line-number="9"></a>
<a class="sourceLine" id="cb39-10" data-line-number="10">df2b &lt;-<span class="st"> </span><span class="kw">map</span>(df2, tail, <span class="dv">2</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb39-11" data-line-number="11"><span class="st">  </span><span class="kw">map</span>(<span class="op">~</span><span class="kw">gsub</span>(<span class="st">&quot;[,]+|[.]+&quot;</span>, <span class="st">&quot;&quot;</span>,.)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb39-12" data-line-number="12"><span class="st">  </span><span class="kw">do.call</span>(rbind,.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb39-13" data-line-number="13"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb39-14" data-line-number="14"><span class="st">  </span><span class="kw">mutate_if</span>(is.character, as.numeric) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb39-15" data-line-number="15"><span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(<span class="op">-</span>X2), <span class="op">~</span><span class="st"> </span>. <span class="op">*</span><span class="st"> </span><span class="fl">0.1</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb39-16" data-line-number="16"><span class="st">  </span><span class="kw">tibble</span>() </a>
<a class="sourceLine" id="cb39-17" data-line-number="17"></a>
<a class="sourceLine" id="cb39-18" data-line-number="18">df2a &lt;-<span class="st"> </span>df2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb39-19" data-line-number="19"><span class="st">  </span><span class="kw">map</span>(<span class="op">~</span><span class="kw">paste</span>(.,<span class="dt">collapse =</span> <span class="st">&quot;&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb39-20" data-line-number="20"><span class="st">  </span><span class="kw">map</span>(<span class="op">~</span><span class="kw">gsub</span>(<span class="st">&quot;[[:digit:]]+|[[:punct:]]+&quot;</span>, <span class="st">&quot;&quot;</span>,.)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb39-21" data-line-number="21"><span class="st">  </span><span class="kw">do.call</span>(rbind,.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb39-22" data-line-number="22"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb39-23" data-line-number="23"><span class="st">  </span><span class="kw">tibble</span>()</a>
<a class="sourceLine" id="cb39-24" data-line-number="24"></a>
<a class="sourceLine" id="cb39-25" data-line-number="25">df2 &lt;-<span class="st"> </span><span class="kw">bind_cols</span>(df2a, df2b)</a>
<a class="sourceLine" id="cb39-26" data-line-number="26"></a>
<a class="sourceLine" id="cb39-27" data-line-number="27"><span class="kw">names</span>(df2) &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb39-28" data-line-number="28"></a>
<a class="sourceLine" id="cb39-29" data-line-number="29">column_names &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Group&quot;</span>,</a>
<a class="sourceLine" id="cb39-30" data-line-number="30">                  <span class="st">&quot;Rate&quot;</span>,</a>
<a class="sourceLine" id="cb39-31" data-line-number="31">                  <span class="st">&quot;N_2017&quot;</span>)</a>
<a class="sourceLine" id="cb39-32" data-line-number="32"></a>
<a class="sourceLine" id="cb39-33" data-line-number="33"><span class="kw">colnames</span>(df2) &lt;-<span class="st"> </span>column_names</a>
<a class="sourceLine" id="cb39-34" data-line-number="34"></a>
<a class="sourceLine" id="cb39-35" data-line-number="35">df2 &lt;-<span class="st"> </span>df2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb39-36" data-line-number="36"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>N_<span class="dv">2017</span>)</a>
<a class="sourceLine" id="cb39-37" data-line-number="37"></a>
<a class="sourceLine" id="cb39-38" data-line-number="38">df2 &lt;-<span class="st"> </span>df2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb39-39" data-line-number="39"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">Year =</span> <span class="dv">2017</span>)</a>
<a class="sourceLine" id="cb39-40" data-line-number="40"></a>
<a class="sourceLine" id="cb39-41" data-line-number="41">df2 &lt;-<span class="st"> </span>df2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb39-42" data-line-number="42"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Gender =</span> <span class="kw">case_when</span>(<span class="kw">str_detect</span>(Group, <span class="st">&quot;Female&quot;</span>) <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb39-43" data-line-number="43">                            <span class="kw">str_detect</span>(Group, <span class="st">&quot;Male&quot;</span>) <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb39-44" data-line-number="44">                            <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">NA</span>),</a>
<a class="sourceLine" id="cb39-45" data-line-number="45">         <span class="dt">Subgroup =</span> <span class="kw">str_remove_all</span>(Group,</a>
<a class="sourceLine" id="cb39-46" data-line-number="46">                                   <span class="dt">pattern =</span> <span class="kw">paste</span>(<span class="kw">c</span>(<span class="st">&quot;Female&quot;</span>,</a>
<a class="sourceLine" id="cb39-47" data-line-number="47">                                                     <span class="st">&quot;Male&quot;</span>,</a>
<a class="sourceLine" id="cb39-48" data-line-number="48">                                                     <span class="st">&quot;ASIAN&quot;</span>,</a>
<a class="sourceLine" id="cb39-49" data-line-number="49">                                                     <span class="st">&quot;Asian&quot;</span>),</a>
<a class="sourceLine" id="cb39-50" data-line-number="50">                                               <span class="dt">collapse =</span> <span class="st">&quot;|&quot;</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb39-51" data-line-number="51"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Subgroup =</span> <span class="kw">na_if</span>(Subgroup, <span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb39-52" data-line-number="52"></a>
<a class="sourceLine" id="cb39-53" data-line-number="53"><span class="kw">glimpse</span>(df2)</a></code></pre></div>
<pre><code>Rows: 25
Columns: 5
$ Group    &lt;chr&gt; &quot;UnitedStates&quot;, &quot;Male&quot;, &quot;Female&quot;, &quot;ASIAN&quot;, &quot;AsianMale&quot;, &quot;Asi…
$ Rate     &lt;dbl&gt; 11.5, 11.8, 11.1, 6.6, 6.5, 6.7, 4.3, 4.7, 3.9, 5.5, 7.5, 3.…
$ Year     &lt;dbl&gt; 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, …
$ Gender   &lt;lgl&gt; NA, FALSE, TRUE, NA, FALSE, TRUE, NA, FALSE, TRUE, NA, FALSE…
$ Subgroup &lt;chr&gt; &quot;UnitedStates&quot;, NA, NA, NA, NA, NA, &quot;CHINESE&quot;, &quot;Chinese&quot;, &quot;C…</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1">df2 &lt;-<span class="st"> </span>df2[<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>),]</a>
<a class="sourceLine" id="cb41-2" data-line-number="2"></a>
<a class="sourceLine" id="cb41-3" data-line-number="3">df2 &lt;-<span class="st"> </span>df2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb41-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Type =</span> <span class="kw">case_when</span>(<span class="kw">is.na</span>(Gender) <span class="op">&amp;</span><span class="st"> </span><span class="kw">is.na</span>(Subgroup) <span class="op">~</span><span class="st"> &quot;Asian Total&quot;</span>,</a>
<a class="sourceLine" id="cb41-5" data-line-number="5">                          <span class="kw">is.na</span>(Gender) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(Subgroup) <span class="op">~</span><span class="st"> &quot;Subgroup Total&quot;</span>,</a>
<a class="sourceLine" id="cb41-6" data-line-number="6">                          <span class="op">!</span><span class="kw">is.na</span>(Gender) <span class="op">&amp;</span><span class="st"> </span><span class="kw">is.na</span>(Subgroup) <span class="op">~</span><span class="st"> &quot;Gender Total&quot;</span>,</a>
<a class="sourceLine" id="cb41-7" data-line-number="7">                          <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Subgroup Total&quot;</span>))</a>
<a class="sourceLine" id="cb41-8" data-line-number="8"></a>
<a class="sourceLine" id="cb41-9" data-line-number="9"><span class="kw">glimpse</span>(df2)</a></code></pre></div>
<pre><code>Rows: 22
Columns: 6
$ Group    &lt;chr&gt; &quot;ASIAN&quot;, &quot;AsianMale&quot;, &quot;AsianFemale&quot;, &quot;CHINESE&quot;, &quot;ChineseMale…
$ Rate     &lt;dbl&gt; 6.6, 6.5, 6.7, 4.3, 4.7, 3.9, 5.5, 7.5, 3.4, 5.9, 4.1, 7.8, …
$ Year     &lt;dbl&gt; 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, …
$ Gender   &lt;lgl&gt; NA, FALSE, TRUE, NA, FALSE, TRUE, NA, FALSE, TRUE, NA, FALSE…
$ Subgroup &lt;chr&gt; NA, NA, NA, &quot;CHINESE&quot;, &quot;Chinese&quot;, &quot;Chinese&quot;, &quot;VIETNAMESE&quot;, &quot;…
$ Type     &lt;chr&gt; &quot;Asian Total&quot;, &quot;Gender Total&quot;, &quot;Gender Total&quot;, &quot;Subgroup Tot…</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1">df2 &lt;-<span class="st"> </span>df2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb43-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Gender =</span> <span class="kw">case_when</span>(<span class="kw">str_detect</span>(Group, <span class="st">&quot;Female&quot;</span>) <span class="op">~</span><span class="st"> &quot;Female&quot;</span>,</a>
<a class="sourceLine" id="cb43-3" data-line-number="3">                            <span class="kw">str_detect</span>(Group, <span class="st">&quot;Male&quot;</span>) <span class="op">~</span><span class="st"> &quot;Male&quot;</span>))</a>
<a class="sourceLine" id="cb43-4" data-line-number="4"></a>
<a class="sourceLine" id="cb43-5" data-line-number="5">df2 &lt;-<span class="st"> </span>df2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb43-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate_if</span>(is.character, tolower) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb43-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate_if</span>(is.character, toupper)</a>
<a class="sourceLine" id="cb43-8" data-line-number="8"></a>
<a class="sourceLine" id="cb43-9" data-line-number="9">df2 &lt;-<span class="st"> </span>df2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb43-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Gender =</span> <span class="kw">replace_na</span>(Gender, <span class="st">&quot;ALL&quot;</span>),</a>
<a class="sourceLine" id="cb43-11" data-line-number="11">         <span class="dt">Subgroup =</span> <span class="kw">replace_na</span>(Subgroup, <span class="st">&quot;ALL&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb43-12" data-line-number="12"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>Group) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb43-13" data-line-number="13"><span class="st">  </span><span class="kw">mutate</span>(Subgroup)</a>
<a class="sourceLine" id="cb43-14" data-line-number="14"></a>
<a class="sourceLine" id="cb43-15" data-line-number="15">df2 &lt;-<span class="st"> </span>df2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb43-16" data-line-number="16"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Subgroup =</span> <span class="kw">case_when</span>(Subgroup <span class="op">==</span><span class="st"> &quot;TWOORMORE&quot;</span> <span class="op">~</span><span class="st"> &quot;TWO OR MORE&quot;</span>,</a>
<a class="sourceLine" id="cb43-17" data-line-number="17">                              <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span>Subgroup))</a></code></pre></div>
<p>Note that we took a process that had successfully worked for us and modified it slightly for separate, similarly-sourced data.</p>
<p>This is a common approach in data science. Often, the duration of the wrangling process can limit the depth of an analysis for practical reasons. Using tried methods can help reduce the time needed to wrangle data and allow time for other parts of an analysis.</p>
<p>Let’s add the 2018 data for this group.</p>
<p>We import the image.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1">image5 &lt;-<span class="st"> </span><span class="kw">image_read</span>(<span class="kw">here</span>(<span class="st">&quot;img&quot;</span>, <span class="st">&quot;asian_subgroups_2018.png&quot;</span>))</a>
<a class="sourceLine" id="cb44-2" data-line-number="2"></a>
<a class="sourceLine" id="cb44-3" data-line-number="3">df2_<span class="dv">2018</span> &lt;-<span class="st"> </span>magick<span class="op">::</span><span class="kw">image_ocr</span>(image5)</a></code></pre></div>
<p>As you can see, we have repeated newlines (<code>\n</code>). We can remove these with some simplex regex.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1">df2_<span class="dv">2018</span> &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;([</span><span class="ch">\n</span><span class="st">])</span><span class="ch">\\</span><span class="st">1+&#39;</span>,</a>
<a class="sourceLine" id="cb45-2" data-line-number="2">                 <span class="st">&#39;</span><span class="ch">\\</span><span class="st">1&#39;</span>,</a>
<a class="sourceLine" id="cb45-3" data-line-number="3">                 df2_<span class="dv">2018</span>)</a>
<a class="sourceLine" id="cb45-4" data-line-number="4"></a>
<a class="sourceLine" id="cb45-5" data-line-number="5">df2_<span class="dv">2018</span> &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;[[:punct:]]+&quot;</span>,</a>
<a class="sourceLine" id="cb45-6" data-line-number="6">                 <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb45-7" data-line-number="7">                 df2_<span class="dv">2018</span>)</a>
<a class="sourceLine" id="cb45-8" data-line-number="8"></a>
<a class="sourceLine" id="cb45-9" data-line-number="9">df2_<span class="dv">2018</span> &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot; i &quot;</span>,</a>
<a class="sourceLine" id="cb45-10" data-line-number="10">                 <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb45-11" data-line-number="11">                 df2_<span class="dv">2018</span>)</a></code></pre></div>
<p>We proceed, making slight modifications to the process as needed.</p>
<p>The bold font appears to have caused a typos.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1">df2_<span class="dv">2018</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb46-2" data-line-number="2"><span class="st">  </span><span class="kw">strsplit</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb46-3" data-line-number="3"><span class="st">  </span><span class="kw">unlist</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb46-4" data-line-number="4"><span class="st">  </span><span class="kw">as_tibble</span>()</a></code></pre></div>
<pre><code># A tibble: 17 x 1
   value                
   &lt;chr&gt;                
 1 CHINESE  41  23300   
 2 Men  45  12500       
 3 Women  37 10800      
 4 INDIAN  B44  21800   
 5 Men  47  10400       
 6 Women  61  11300     
 7 KOREAN  55  9000     
 8 Men  56  4700        
 9 Women  54  4300      
10 VIETNAMESE  63  15300
11 Men  76  9000        
12 Women  50  6400      
13 FILIPINO  68  20800  
14 Men  63  10000       
15 Women74  10800       
16 HMONG102  5300       
17 CAMBODIAN 138  4200  </code></pre>
<p>We fix the typos.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1">df2_<span class="dv">2018</span> &lt;-<span class="st"> </span>df2_<span class="dv">2018</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb48-2" data-line-number="2"><span class="st">  </span><span class="kw">strsplit</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb48-3" data-line-number="3"><span class="st">  </span><span class="kw">unlist</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb48-4" data-line-number="4"><span class="st">  </span><span class="kw">gsub</span>(<span class="st">&quot; B44 &quot;</span>,<span class="st">&quot;54&quot;</span>,.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb48-5" data-line-number="5"><span class="st">  </span><span class="kw">gsub</span>(<span class="st">&quot;Women74&quot;</span>,<span class="st">&quot;Women 74&quot;</span>,.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb48-6" data-line-number="6"><span class="st">  </span><span class="kw">gsub</span>(<span class="st">&quot;HMONG102&quot;</span>,<span class="st">&quot;HMONG 102&quot;</span>,.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb48-7" data-line-number="7"><span class="st">  </span><span class="kw">as_tibble</span>()</a>
<a class="sourceLine" id="cb48-8" data-line-number="8"></a>
<a class="sourceLine" id="cb48-9" data-line-number="9">df2_<span class="dv">2018</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb48-10" data-line-number="10"><span class="st">  </span><span class="kw">print</span>(.,<span class="dt">n =</span> <span class="kw">dim</span>(.)[<span class="dv">1</span>])</a></code></pre></div>
<pre><code># A tibble: 17 x 1
   value                
   &lt;chr&gt;                
 1 CHINESE  41  23300   
 2 Men  45  12500       
 3 Women  37 10800      
 4 INDIAN 54 21800      
 5 Men  47  10400       
 6 Women  61  11300     
 7 KOREAN  55  9000     
 8 Men  56  4700        
 9 Women  54  4300      
10 VIETNAMESE  63  15300
11 Men  76  9000        
12 Women  50  6400      
13 FILIPINO  68  20800  
14 Men  63  10000       
15 Women 74  10800      
16 HMONG 102  5300      
17 CAMBODIAN 138  4200  </code></pre>
<p>We then continue as we would normally.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1">df2_<span class="dv">2018</span> &lt;-<span class="st"> </span>df2_<span class="dv">2018</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb50-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(value) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb50-3" data-line-number="3"><span class="st">  </span><span class="kw">pull</span>(value) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb50-4" data-line-number="4"><span class="st">  </span><span class="kw">str_split</span>(<span class="st">&quot; &quot;</span>)</a>
<a class="sourceLine" id="cb50-5" data-line-number="5"></a>
<a class="sourceLine" id="cb50-6" data-line-number="6">df2_<span class="dv">2018</span> &lt;-<span class="st"> </span><span class="kw">lapply</span>(df2_<span class="dv">2018</span>,</a>
<a class="sourceLine" id="cb50-7" data-line-number="7">                   <span class="cf">function</span>(x) x[<span class="kw">nchar</span>(x) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb50-8" data-line-number="8"></a>
<a class="sourceLine" id="cb50-9" data-line-number="9">df2a_<span class="dv">2018</span> &lt;-<span class="st"> </span>df2_<span class="dv">2018</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb50-10" data-line-number="10"><span class="st">  </span><span class="kw">map</span>(<span class="op">~</span><span class="kw">paste</span>(.,<span class="dt">collapse =</span> <span class="st">&quot;&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb50-11" data-line-number="11"><span class="st">  </span><span class="kw">map</span>(<span class="op">~</span><span class="kw">gsub</span>(<span class="st">&quot;[[:digit:]]+|[[:punct:]]+&quot;</span>, <span class="st">&quot;&quot;</span>,.)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb50-12" data-line-number="12"><span class="st">  </span><span class="kw">do.call</span>(rbind,.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb50-13" data-line-number="13"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb50-14" data-line-number="14"><span class="st">  </span><span class="kw">tibble</span>()</a>
<a class="sourceLine" id="cb50-15" data-line-number="15"></a>
<a class="sourceLine" id="cb50-16" data-line-number="16">df2b_<span class="dv">2018</span> &lt;-<span class="st"> </span><span class="kw">map</span>(df2_<span class="dv">2018</span>, tail, <span class="dv">2</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb50-17" data-line-number="17"><span class="st">  </span><span class="kw">do.call</span>(rbind,.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb50-18" data-line-number="18"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb50-19" data-line-number="19"><span class="st">  </span><span class="kw">mutate_if</span>(is.character, as.numeric) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb50-20" data-line-number="20"><span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(<span class="op">-</span>X2), <span class="op">~</span><span class="st"> </span>. <span class="op">*</span><span class="st"> </span><span class="fl">0.1</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb50-21" data-line-number="21"><span class="st">  </span><span class="kw">tibble</span>() </a>
<a class="sourceLine" id="cb50-22" data-line-number="22"></a>
<a class="sourceLine" id="cb50-23" data-line-number="23"><span class="kw">rm</span>(df2_<span class="dv">2018</span>)</a>
<a class="sourceLine" id="cb50-24" data-line-number="24">  </a>
<a class="sourceLine" id="cb50-25" data-line-number="25">df2_<span class="dv">2018</span> &lt;-<span class="st"> </span><span class="kw">bind_cols</span>(df2a_<span class="dv">2018</span>,</a>
<a class="sourceLine" id="cb50-26" data-line-number="26">                      df2b_<span class="dv">2018</span>)</a>
<a class="sourceLine" id="cb50-27" data-line-number="27"><span class="kw">names</span>(df2_<span class="dv">2018</span>) &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb50-28" data-line-number="28"></a>
<a class="sourceLine" id="cb50-29" data-line-number="29">column_names &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Group&quot;</span>,</a>
<a class="sourceLine" id="cb50-30" data-line-number="30">                  <span class="st">&quot;Rate&quot;</span>,</a>
<a class="sourceLine" id="cb50-31" data-line-number="31">                  <span class="st">&quot;N_2017&quot;</span>)</a>
<a class="sourceLine" id="cb50-32" data-line-number="32"></a>
<a class="sourceLine" id="cb50-33" data-line-number="33"><span class="kw">colnames</span>(df2_<span class="dv">2018</span>) &lt;-<span class="st"> </span>column_names</a>
<a class="sourceLine" id="cb50-34" data-line-number="34"></a>
<a class="sourceLine" id="cb50-35" data-line-number="35">df2_<span class="dv">2018</span> &lt;-<span class="st"> </span>df2_<span class="dv">2018</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb50-36" data-line-number="36"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>N_<span class="dv">2017</span>)</a>
<a class="sourceLine" id="cb50-37" data-line-number="37"></a>
<a class="sourceLine" id="cb50-38" data-line-number="38">df2_<span class="dv">2018</span> &lt;-<span class="st"> </span>df2_<span class="dv">2018</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb50-39" data-line-number="39"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">Year =</span> <span class="dv">2018</span>)</a>
<a class="sourceLine" id="cb50-40" data-line-number="40"></a>
<a class="sourceLine" id="cb50-41" data-line-number="41">df2_<span class="dv">2018</span> &lt;-<span class="st"> </span>df2_<span class="dv">2018</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb50-42" data-line-number="42"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Gender =</span> <span class="kw">case_when</span>(<span class="kw">str_detect</span>(Group, <span class="st">&quot;Women&quot;</span>) <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb50-43" data-line-number="43">                            <span class="kw">str_detect</span>(Group, <span class="st">&quot;Men&quot;</span>) <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb50-44" data-line-number="44">                            <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">NA</span>))</a>
<a class="sourceLine" id="cb50-45" data-line-number="45"></a>
<a class="sourceLine" id="cb50-46" data-line-number="46">labels &lt;-<span class="st"> </span><span class="kw">unlist</span>(df2_<span class="dv">2018</span>[<span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">15</span>, <span class="dt">by=</span><span class="dv">3</span>),<span class="dv">16</span>,<span class="dv">17</span>),<span class="dv">1</span>], <span class="dt">use.names =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb50-47" data-line-number="47"></a>
<a class="sourceLine" id="cb50-48" data-line-number="48"><span class="kw">dim</span>(df2_<span class="dv">2018</span>)[<span class="dv">1</span>]</a></code></pre></div>
<pre><code>[1] 17</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1">labels_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(labels[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>], <span class="dt">each =</span> <span class="kw">dim</span>(df2_<span class="dv">2018</span>)[<span class="dv">1</span>]<span class="op">/</span>(<span class="kw">length</span>(labels)<span class="op">-</span><span class="dv">2</span>)),</a>
<a class="sourceLine" id="cb52-2" data-line-number="2">              <span class="st">&quot;HMONG&quot;</span>,</a>
<a class="sourceLine" id="cb52-3" data-line-number="3">              <span class="st">&quot;CAMBODIAN&quot;</span>)</a>
<a class="sourceLine" id="cb52-4" data-line-number="4"></a>
<a class="sourceLine" id="cb52-5" data-line-number="5">df2_<span class="dv">2018</span><span class="op">$</span>Subgroup &lt;-<span class="st"> </span>labels_<span class="dv">3</span></a>
<a class="sourceLine" id="cb52-6" data-line-number="6"></a>
<a class="sourceLine" id="cb52-7" data-line-number="7">df2_<span class="dv">2018</span> &lt;-<span class="st"> </span>df2_<span class="dv">2018</span> <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb52-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Type =</span> <span class="st">&quot;Subgroup Total&quot;</span>)</a>
<a class="sourceLine" id="cb52-9" data-line-number="9"></a>
<a class="sourceLine" id="cb52-10" data-line-number="10"><span class="kw">glimpse</span>(df2_<span class="dv">2018</span>)</a></code></pre></div>
<pre><code>Rows: 17
Columns: 6
$ Group    &lt;chr&gt; &quot;CHINESE&quot;, &quot;Men&quot;, &quot;Women&quot;, &quot;INDIAN&quot;, &quot;Men&quot;, &quot;Women&quot;, &quot;KOREAN…
$ Rate     &lt;dbl&gt; 4.1, 4.5, 3.7, 5.4, 4.7, 6.1, 5.5, 5.6, 5.4, 6.3, 7.6, 5.0, …
$ Year     &lt;dbl&gt; 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, …
$ Gender   &lt;lgl&gt; NA, FALSE, TRUE, NA, FALSE, TRUE, NA, FALSE, TRUE, NA, FALSE…
$ Subgroup &lt;chr&gt; &quot;CHINESE&quot;, &quot;CHINESE&quot;, &quot;CHINESE&quot;, &quot;INDIAN&quot;, &quot;INDIAN&quot;, &quot;INDIAN…
$ Type     &lt;chr&gt; &quot;Subgroup Total&quot;, &quot;Subgroup Total&quot;, &quot;Subgroup Total&quot;, &quot;Subgr…</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1">df2_<span class="dv">2018</span> &lt;-<span class="st"> </span>df2_<span class="dv">2018</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb54-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Gender =</span> <span class="kw">case_when</span>(Gender <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Female&quot;</span>,</a>
<a class="sourceLine" id="cb54-3" data-line-number="3">                            Gender <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">~</span><span class="st"> &quot;Male&quot;</span>,</a>
<a class="sourceLine" id="cb54-4" data-line-number="4">                            <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;All&quot;</span>))</a>
<a class="sourceLine" id="cb54-5" data-line-number="5"></a>
<a class="sourceLine" id="cb54-6" data-line-number="6">df2_<span class="dv">2018</span> &lt;-<span class="st"> </span>df2_<span class="dv">2018</span> <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb54-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate_if</span>(is.character, tolower) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb54-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate_if</span>(is.character, toupper)</a>
<a class="sourceLine" id="cb54-9" data-line-number="9"></a>
<a class="sourceLine" id="cb54-10" data-line-number="10">df2_<span class="dv">2018</span> &lt;-<span class="st"> </span>df2_<span class="dv">2018</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb54-11" data-line-number="11"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>Group)</a></code></pre></div>
<p>The dataframe we produced does not contain totals.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1">df2_<span class="dv">2018</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb55-2" data-line-number="2"><span class="st">  </span><span class="kw">print</span>(., <span class="dt">n =</span> <span class="kw">dim</span>(.)[<span class="dv">1</span>])</a></code></pre></div>
<pre><code># A tibble: 17 x 5
    Rate  Year Gender Subgroup   Type          
   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;         
 1   4.1  2018 ALL    CHINESE    SUBGROUP TOTAL
 2   4.5  2018 MALE   CHINESE    SUBGROUP TOTAL
 3   3.7  2018 FEMALE CHINESE    SUBGROUP TOTAL
 4   5.4  2018 ALL    INDIAN     SUBGROUP TOTAL
 5   4.7  2018 MALE   INDIAN     SUBGROUP TOTAL
 6   6.1  2018 FEMALE INDIAN     SUBGROUP TOTAL
 7   5.5  2018 ALL    KOREAN     SUBGROUP TOTAL
 8   5.6  2018 MALE   KOREAN     SUBGROUP TOTAL
 9   5.4  2018 FEMALE KOREAN     SUBGROUP TOTAL
10   6.3  2018 ALL    VIETNAMESE SUBGROUP TOTAL
11   7.6  2018 MALE   VIETNAMESE SUBGROUP TOTAL
12   5    2018 FEMALE VIETNAMESE SUBGROUP TOTAL
13   6.8  2018 ALL    FILIPINO   SUBGROUP TOTAL
14   6.3  2018 MALE   FILIPINO   SUBGROUP TOTAL
15   7.4  2018 FEMALE FILIPINO   SUBGROUP TOTAL
16  10.2  2018 ALL    HMONG      SUBGROUP TOTAL
17  13.8  2018 ALL    CAMBODIAN  SUBGROUP TOTAL</code></pre>
<p>We can find these totals in the PDF directly and create rows as needed</p>
<p>We load the PDF.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1">excerpt &lt;-<span class="st"> </span><span class="kw">image_read</span>(<span class="kw">here</span>(<span class="st">&quot;img&quot;</span>, <span class="st">&quot;asian_youth_excerpt.png&quot;</span>))</a>
<a class="sourceLine" id="cb57-2" data-line-number="2"></a>
<a class="sourceLine" id="cb57-3" data-line-number="3">excerpt</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-31-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>We add the rows.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" data-line-number="1">df2_<span class="dv">2018</span> &lt;-<span class="st"> </span>df2_<span class="dv">2018</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb58-2" data-line-number="2"><span class="st">  </span><span class="kw">add_row</span>(<span class="dt">Rate =</span> <span class="fl">6.2</span>,</a>
<a class="sourceLine" id="cb58-3" data-line-number="3">          <span class="dt">Year =</span> <span class="dv">2018</span>,</a>
<a class="sourceLine" id="cb58-4" data-line-number="4">          <span class="dt">Gender =</span> <span class="st">&quot;ALL&quot;</span>,</a>
<a class="sourceLine" id="cb58-5" data-line-number="5">          <span class="dt">Subgroup =</span> <span class="st">&quot;ALL&quot;</span>, </a>
<a class="sourceLine" id="cb58-6" data-line-number="6">          <span class="dt">Type =</span> <span class="st">&quot;ASIAN TOTAL&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb58-7" data-line-number="7"><span class="st">  </span><span class="kw">add_row</span>(<span class="dt">Rate =</span> <span class="fl">6.1</span>,</a>
<a class="sourceLine" id="cb58-8" data-line-number="8">          <span class="dt">Year =</span> <span class="dv">2018</span>,</a>
<a class="sourceLine" id="cb58-9" data-line-number="9">          <span class="dt">Gender =</span> <span class="st">&quot;FEMALE&quot;</span>,</a>
<a class="sourceLine" id="cb58-10" data-line-number="10">          <span class="dt">Subgroup =</span> <span class="st">&quot;ALL&quot;</span>, </a>
<a class="sourceLine" id="cb58-11" data-line-number="11">          <span class="dt">Type =</span> <span class="st">&quot;GENDER TOTAL&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb58-12" data-line-number="12"><span class="st">  </span><span class="kw">add_row</span>(<span class="dt">Rate =</span> <span class="fl">6.4</span>,</a>
<a class="sourceLine" id="cb58-13" data-line-number="13">          <span class="dt">Year =</span> <span class="dv">2018</span>,</a>
<a class="sourceLine" id="cb58-14" data-line-number="14">          <span class="dt">Gender =</span> <span class="st">&quot;MALE&quot;</span>,</a>
<a class="sourceLine" id="cb58-15" data-line-number="15">          <span class="dt">Subgroup =</span> <span class="st">&quot;ALL&quot;</span>, </a>
<a class="sourceLine" id="cb58-16" data-line-number="16">          <span class="dt">Type =</span> <span class="st">&quot;GENDER TOTAL&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" data-line-number="1">df2 &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(df2,</a>
<a class="sourceLine" id="cb59-2" data-line-number="2">                 df2_<span class="dv">2018</span>)</a></code></pre></div>
<p>We repeat this process again for Latino/a subgroups.</p>
<p>The table, without the special formatting, looks like this.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" data-line-number="1">image3 &lt;-<span class="st"> </span><span class="kw">image_read</span>(<span class="kw">here</span>(<span class="st">&quot;img&quot;</span>, <span class="st">&quot;latino_a_subgroups.png&quot;</span>))</a></code></pre></div>
<p>There are no whitespaces in this table.</p>
<p>We proceed using what we’ve learned while wrangling the first two tables.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" data-line-number="1">df3 &lt;-<span class="st"> </span>magick<span class="op">::</span><span class="kw">image_ocr</span>(image3)</a>
<a class="sourceLine" id="cb61-2" data-line-number="2"></a>
<a class="sourceLine" id="cb61-3" data-line-number="3">df3 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb61-4" data-line-number="4"><span class="st">  </span>base<span class="op">::</span><span class="kw">strsplit</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb61-5" data-line-number="5"><span class="st">  </span>base<span class="op">::</span><span class="kw">unlist</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb61-6" data-line-number="6"><span class="st">  </span>tibble<span class="op">::</span><span class="kw">as_tibble</span>()</a></code></pre></div>
<pre><code># A tibble: 17 x 1
   value                              
   &lt;chr&gt;                              
 1 LATINO 13.2 1,157,300              
 2 Latino Male 12.4 562,600           
 3 Latina Female 13.9 594,700         
 4 SOUTH AMERICAN 8.4 37,600          
 5 South American Male 9.1 20,400     
 6 South American Female 17 17,200    
 7 CENTRAL AMERICAN 12.0 93,100       
 8 Central American Male 9.3 37,900   
 9 Central American Female 15.0 55,200
10 MEXICAN 13.3 762,400               
11 Mexican Male 12.2 358,200          
12 Mexican Female 14.4 404,200        
13 OTHER LATINO 13.6 44,800           
14 Other Latino Male 15.3 27,600      
15 Other Latina Female 11.5 17,300    
16 PR, DR, Cuban Female 15.7 114,500  
17 PR, DR, Cuban Female 14.4 96,600   </code></pre>
<p>We are often presented with scenarios where stand-alone approaches are difficult or time-consuming.</p>
<p>It is always best to document the steps take to respond to these scenarios. Wrangling this third table is a prime example of this.</p>
<p>We are missing a row. Let’s manually add the row.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" data-line-number="1">df3 &lt;-<span class="st"> </span>df3 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb63-2" data-line-number="2"><span class="st">  </span><span class="kw">strsplit</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb63-3" data-line-number="3"><span class="st">  </span><span class="kw">unlist</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb63-4" data-line-number="4"><span class="st">  </span><span class="kw">as_tibble</span>()</a>
<a class="sourceLine" id="cb63-5" data-line-number="5"></a>
<a class="sourceLine" id="cb63-6" data-line-number="6">df3 &lt;-<span class="st"> </span>df3 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb63-7" data-line-number="7"><span class="st">  </span><span class="kw">rbind</span>(<span class="st">&quot;PR, DR, Cuban 15.1 211,200&quot;</span>)</a></code></pre></div>
<p>We can now proceed as we did with the previous tables.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" data-line-number="1">df3 &lt;-<span class="st"> </span>df3 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(value) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-3" data-line-number="3"><span class="st">  </span><span class="kw">pull</span>(value) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-4" data-line-number="4"><span class="st">  </span><span class="kw">str_split</span>(<span class="st">&quot; &quot;</span>)</a>
<a class="sourceLine" id="cb64-5" data-line-number="5"></a>
<a class="sourceLine" id="cb64-6" data-line-number="6">df3b &lt;-<span class="st"> </span><span class="kw">map</span>(df3, tail, <span class="dv">2</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-7" data-line-number="7"><span class="st">  </span><span class="kw">map</span>(<span class="op">~</span><span class="kw">gsub</span>(<span class="st">&quot;[,]+|[.]+&quot;</span>, <span class="st">&quot;&quot;</span>,.)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-8" data-line-number="8"><span class="st">  </span><span class="kw">do.call</span>(rbind,.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-9" data-line-number="9"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate_if</span>(is.character, as.numeric) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(<span class="op">-</span>X2), <span class="op">~</span><span class="st"> </span>. <span class="op">*</span><span class="st"> </span><span class="fl">0.1</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-12" data-line-number="12"><span class="st">  </span><span class="kw">tibble</span>() </a>
<a class="sourceLine" id="cb64-13" data-line-number="13"></a>
<a class="sourceLine" id="cb64-14" data-line-number="14">df3a &lt;-<span class="st"> </span>df3 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-15" data-line-number="15"><span class="st">  </span><span class="kw">map</span>(<span class="op">~</span><span class="kw">paste</span>(.,<span class="dt">collapse =</span> <span class="st">&quot;&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-16" data-line-number="16"><span class="st">  </span><span class="kw">map</span>(<span class="op">~</span><span class="kw">gsub</span>(<span class="st">&quot;[[:digit:]]+|[[:punct:]]+&quot;</span>, <span class="st">&quot;&quot;</span>,.)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-17" data-line-number="17"><span class="st">  </span><span class="kw">do.call</span>(rbind,.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-18" data-line-number="18"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-19" data-line-number="19"><span class="st">  </span><span class="kw">tibble</span>()</a>
<a class="sourceLine" id="cb64-20" data-line-number="20"></a>
<a class="sourceLine" id="cb64-21" data-line-number="21"><span class="kw">rm</span>(df3)</a>
<a class="sourceLine" id="cb64-22" data-line-number="22">  </a>
<a class="sourceLine" id="cb64-23" data-line-number="23">df3 &lt;-<span class="st"> </span><span class="kw">bind_cols</span>(df3a, df3b)</a>
<a class="sourceLine" id="cb64-24" data-line-number="24"><span class="kw">names</span>(df3) &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb64-25" data-line-number="25"></a>
<a class="sourceLine" id="cb64-26" data-line-number="26">column_names &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Group&quot;</span>,</a>
<a class="sourceLine" id="cb64-27" data-line-number="27">                  <span class="st">&quot;Rate&quot;</span>,</a>
<a class="sourceLine" id="cb64-28" data-line-number="28">                  <span class="st">&quot;N_2017&quot;</span>)</a>
<a class="sourceLine" id="cb64-29" data-line-number="29"></a>
<a class="sourceLine" id="cb64-30" data-line-number="30"><span class="kw">colnames</span>(df3) &lt;-<span class="st"> </span>column_names</a></code></pre></div>
<p>If we look at the last few rows, we see that there is a typo. There are two female groups.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" data-line-number="1"><span class="kw">tail</span>(df3)</a></code></pre></div>
<pre><code># A tibble: 6 x 3
  Group              Rate N_2017
  &lt;chr&gt;             &lt;dbl&gt;  &lt;dbl&gt;
1 OTHERLATINO        13.6  44800
2 OtherLatinoMale    15.3  27600
3 OtherLatinaFemale  11.5  17300
4 PRDRCubanFemale    15.7 114500
5 PRDRCubanFemale    14.4  96600
6 PRDRCuban          15.1 211200</code></pre>
<p>Sometimes when wrangling text data, we will come across a typo. We need to determine how to respond to the typo and make note of it. It’s often best to consult a secondary source to confirm that changes made are accurate.</p>
<p>For the purposes of this case study, we will assume that the first of the two rows represents male disconnection rates in the Latino/a subgroup; this would be consistent with the ordering of genders in the previous subgroups.</p>
<p>Let’s make the correction to the typo.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" data-line-number="1">df3 &lt;-<span class="st"> </span>df3 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb67-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Group =</span> <span class="kw">case_when</span>(Group <span class="op">==</span><span class="st"> &quot;PRDRCubanFemale&quot;</span> <span class="op">&amp;</span><span class="st"> </span>N_<span class="dv">2017</span> <span class="op">==</span><span class="st"> </span><span class="dv">114500</span> <span class="op">~</span><span class="st"> &quot;PRDRCubanMale&quot;</span>,</a>
<a class="sourceLine" id="cb67-3" data-line-number="3">                         <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span>Group))</a></code></pre></div>
<p>It looks like we’ve succesfully corrected the typo.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" data-line-number="1"><span class="kw">tail</span>(df3)</a></code></pre></div>
<pre><code># A tibble: 6 x 3
  Group              Rate N_2017
  &lt;chr&gt;             &lt;dbl&gt;  &lt;dbl&gt;
1 OTHERLATINO        13.6  44800
2 OtherLatinoMale    15.3  27600
3 OtherLatinaFemale  11.5  17300
4 PRDRCubanMale      15.7 114500
5 PRDRCubanFemale    14.4  96600
6 PRDRCuban          15.1 211200</code></pre>
<p>We can continue with the process we’ve developed now that we have made the correction.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" data-line-number="1">df3 &lt;-<span class="st"> </span>df3 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb70-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>N_<span class="dv">2017</span>)</a>
<a class="sourceLine" id="cb70-3" data-line-number="3"></a>
<a class="sourceLine" id="cb70-4" data-line-number="4">df3 &lt;-<span class="st"> </span>df3 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb70-5" data-line-number="5"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">Year =</span> <span class="dv">2017</span>)</a>
<a class="sourceLine" id="cb70-6" data-line-number="6"></a>
<a class="sourceLine" id="cb70-7" data-line-number="7">df3 &lt;-<span class="st"> </span>df3 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb70-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Gender =</span> <span class="kw">case_when</span>(<span class="kw">str_detect</span>(Group, <span class="st">&quot;Female&quot;</span>) <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb70-9" data-line-number="9">                            <span class="kw">str_detect</span>(Group, <span class="st">&quot;Male&quot;</span>) <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb70-10" data-line-number="10">                            <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">NA</span>),</a>
<a class="sourceLine" id="cb70-11" data-line-number="11">         <span class="dt">Subgroup =</span> <span class="kw">str_remove_all</span>(Group,</a>
<a class="sourceLine" id="cb70-12" data-line-number="12">                                   <span class="dt">pattern =</span> <span class="kw">paste</span>(<span class="kw">c</span>(<span class="st">&quot;Female&quot;</span>,</a>
<a class="sourceLine" id="cb70-13" data-line-number="13">                                                     <span class="st">&quot;Male&quot;</span>,</a>
<a class="sourceLine" id="cb70-14" data-line-number="14">                                                     <span class="st">&quot;LATINO&quot;</span>,</a>
<a class="sourceLine" id="cb70-15" data-line-number="15">                                                     <span class="st">&quot;Latino&quot;</span>,</a>
<a class="sourceLine" id="cb70-16" data-line-number="16">                                                     <span class="st">&quot;Latina&quot;</span>),</a>
<a class="sourceLine" id="cb70-17" data-line-number="17">                                               <span class="dt">collapse =</span> <span class="st">&quot;|&quot;</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb70-18" data-line-number="18"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Subgroup =</span> <span class="kw">na_if</span>(Subgroup, <span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb70-19" data-line-number="19"></a>
<a class="sourceLine" id="cb70-20" data-line-number="20"><span class="kw">glimpse</span>(df3)</a></code></pre></div>
<pre><code>Rows: 18
Columns: 5
$ Group    &lt;chr&gt; &quot;LATINO&quot;, &quot;LatinoMale&quot;, &quot;LatinaFemale&quot;, &quot;SOUTHAMERICAN&quot;, &quot;So…
$ Rate     &lt;dbl&gt; 13.2, 12.4, 13.9, 8.4, 9.1, 1.7, 12.0, 9.3, 15.0, 13.3, 12.2…
$ Year     &lt;dbl&gt; 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, …
$ Gender   &lt;lgl&gt; NA, FALSE, TRUE, NA, FALSE, TRUE, NA, FALSE, TRUE, NA, FALSE…
$ Subgroup &lt;chr&gt; NA, NA, NA, &quot;SOUTHAMERICAN&quot;, &quot;SouthAmerican&quot;, &quot;SouthAmerican…</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" data-line-number="1">df3 &lt;-<span class="st"> </span>df3 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb72-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Type =</span> <span class="kw">case_when</span>(<span class="kw">is.na</span>(Gender) <span class="op">&amp;</span><span class="st"> </span><span class="kw">is.na</span>(Subgroup) <span class="op">~</span><span class="st"> &quot;Latino/a Total&quot;</span>,</a>
<a class="sourceLine" id="cb72-3" data-line-number="3">                          <span class="kw">is.na</span>(Gender) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(Subgroup) <span class="op">~</span><span class="st"> &quot;Subgroup Total&quot;</span>,</a>
<a class="sourceLine" id="cb72-4" data-line-number="4">                          <span class="op">!</span><span class="kw">is.na</span>(Gender) <span class="op">&amp;</span><span class="st"> </span><span class="kw">is.na</span>(Subgroup) <span class="op">~</span><span class="st"> &quot;Gender Total&quot;</span>,</a>
<a class="sourceLine" id="cb72-5" data-line-number="5">                          <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Subgroup Total&quot;</span>))</a>
<a class="sourceLine" id="cb72-6" data-line-number="6"></a>
<a class="sourceLine" id="cb72-7" data-line-number="7"><span class="kw">glimpse</span>(df3)</a></code></pre></div>
<pre><code>Rows: 18
Columns: 6
$ Group    &lt;chr&gt; &quot;LATINO&quot;, &quot;LatinoMale&quot;, &quot;LatinaFemale&quot;, &quot;SOUTHAMERICAN&quot;, &quot;So…
$ Rate     &lt;dbl&gt; 13.2, 12.4, 13.9, 8.4, 9.1, 1.7, 12.0, 9.3, 15.0, 13.3, 12.2…
$ Year     &lt;dbl&gt; 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, …
$ Gender   &lt;lgl&gt; NA, FALSE, TRUE, NA, FALSE, TRUE, NA, FALSE, TRUE, NA, FALSE…
$ Subgroup &lt;chr&gt; NA, NA, NA, &quot;SOUTHAMERICAN&quot;, &quot;SouthAmerican&quot;, &quot;SouthAmerican…
$ Type     &lt;chr&gt; &quot;Latino/a Total&quot;, &quot;Gender Total&quot;, &quot;Gender Total&quot;, &quot;Subgroup …</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" data-line-number="1">df3 &lt;-<span class="st"> </span>df3 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb74-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Gender =</span> <span class="kw">case_when</span>(<span class="kw">str_detect</span>(Group, <span class="st">&quot;Female&quot;</span>) <span class="op">~</span><span class="st"> &quot;Female&quot;</span>,</a>
<a class="sourceLine" id="cb74-3" data-line-number="3">                            <span class="kw">str_detect</span>(Group, <span class="st">&quot;Male&quot;</span>) <span class="op">~</span><span class="st"> &quot;Male&quot;</span>))</a>
<a class="sourceLine" id="cb74-4" data-line-number="4"></a>
<a class="sourceLine" id="cb74-5" data-line-number="5">df3 &lt;-<span class="st"> </span>df3 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb74-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate_if</span>(is.character, tolower) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb74-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate_if</span>(is.character, toupper)</a>
<a class="sourceLine" id="cb74-8" data-line-number="8"></a>
<a class="sourceLine" id="cb74-9" data-line-number="9">df3 &lt;-<span class="st"> </span>df3 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb74-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Gender =</span> <span class="kw">replace_na</span>(Gender, <span class="st">&quot;ALL&quot;</span>),</a>
<a class="sourceLine" id="cb74-11" data-line-number="11">         <span class="dt">Subgroup =</span> <span class="kw">replace_na</span>(Subgroup, <span class="st">&quot;ALL&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb74-12" data-line-number="12"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>Group) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb74-13" data-line-number="13"><span class="st">  </span><span class="kw">mutate</span>(Subgroup)</a>
<a class="sourceLine" id="cb74-14" data-line-number="14"></a>
<a class="sourceLine" id="cb74-15" data-line-number="15">df3 &lt;-<span class="st"> </span>df3 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb74-16" data-line-number="16"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Subgroup =</span> <span class="kw">case_when</span>(Subgroup <span class="op">==</span><span class="st"> &quot;SOUTHAMERICAN&quot;</span> <span class="op">~</span><span class="st"> &quot;SOUTH AMERICAN&quot;</span>,</a>
<a class="sourceLine" id="cb74-17" data-line-number="17">                              Subgroup <span class="op">==</span><span class="st"> &quot;CENTRALAMERICAN&quot;</span> <span class="op">~</span><span class="st"> &quot;CENTRAL AMERICAN&quot;</span>,</a>
<a class="sourceLine" id="cb74-18" data-line-number="18">                              Subgroup <span class="op">==</span><span class="st"> &quot;PRDRCUBAN&quot;</span> <span class="op">~</span><span class="st"> &quot;PR/DR/CUBAN&quot;</span>,</a>
<a class="sourceLine" id="cb74-19" data-line-number="19">                              <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span>Subgroup))</a></code></pre></div>
<p>Let’s add the 2018 data to this dataframe.</p>
<p>We import the image.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" data-line-number="1">image5 &lt;-<span class="st"> </span><span class="kw">image_read</span>(<span class="kw">here</span>(<span class="st">&quot;img&quot;</span>, <span class="st">&quot;latino_a_subgroups_2018.png&quot;</span>))</a>
<a class="sourceLine" id="cb75-2" data-line-number="2"></a>
<a class="sourceLine" id="cb75-3" data-line-number="3">df3_<span class="dv">2018</span> &lt;-<span class="st"> </span>magick<span class="op">::</span><span class="kw">image_ocr</span>(image5)</a></code></pre></div>
<p>As you can see, we have repeated newlines (<code>\n</code>). We can remove these with some simplex regex.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" data-line-number="1">df3_<span class="dv">2018</span> &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;([</span><span class="ch">\n</span><span class="st">])</span><span class="ch">\\</span><span class="st">1+&#39;</span>,</a>
<a class="sourceLine" id="cb76-2" data-line-number="2">                 <span class="st">&#39;</span><span class="ch">\\</span><span class="st">2&#39;</span>,</a>
<a class="sourceLine" id="cb76-3" data-line-number="3">                 df3_<span class="dv">2018</span>)</a>
<a class="sourceLine" id="cb76-4" data-line-number="4"></a>
<a class="sourceLine" id="cb76-5" data-line-number="5">df3_<span class="dv">2018</span> &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;[[:punct:]]+&quot;</span>,</a>
<a class="sourceLine" id="cb76-6" data-line-number="6">                 <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb76-7" data-line-number="7">                 df3_<span class="dv">2018</span>)</a></code></pre></div>
<p>We proceed, making slight modifications to the process as needed.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" data-line-number="1">df3_<span class="dv">2018</span> &lt;-<span class="st"> </span>df3_<span class="dv">2018</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb77-2" data-line-number="2"><span class="st">  </span><span class="kw">strsplit</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb77-3" data-line-number="3"><span class="st">  </span><span class="kw">unlist</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb77-4" data-line-number="4"><span class="st">  </span><span class="kw">as_tibble</span>()</a>
<a class="sourceLine" id="cb77-5" data-line-number="5"></a>
<a class="sourceLine" id="cb77-6" data-line-number="6">df3_<span class="dv">2018</span> &lt;-<span class="st"> </span>df3_<span class="dv">2018</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb77-7" data-line-number="7"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(value) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb77-8" data-line-number="8"><span class="st">  </span><span class="kw">pull</span>(value) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb77-9" data-line-number="9"><span class="st">  </span><span class="kw">str_split</span>(<span class="st">&quot; &quot;</span>)</a>
<a class="sourceLine" id="cb77-10" data-line-number="10"></a>
<a class="sourceLine" id="cb77-11" data-line-number="11">df3_<span class="dv">2018</span> &lt;-<span class="st"> </span><span class="kw">lapply</span>(df3_<span class="dv">2018</span>,</a>
<a class="sourceLine" id="cb77-12" data-line-number="12">                   <span class="cf">function</span>(x) x[<span class="kw">nchar</span>(x) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb77-13" data-line-number="13"></a>
<a class="sourceLine" id="cb77-14" data-line-number="14">df3a_<span class="dv">2018</span> &lt;-<span class="st"> </span>df3_<span class="dv">2018</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb77-15" data-line-number="15"><span class="st">  </span><span class="kw">map</span>(<span class="op">~</span><span class="kw">paste</span>(.,<span class="dt">collapse =</span> <span class="st">&quot;&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb77-16" data-line-number="16"><span class="st">  </span><span class="kw">map</span>(<span class="op">~</span><span class="kw">gsub</span>(<span class="st">&quot;[[:digit:]]+|[[:punct:]]+&quot;</span>, <span class="st">&quot;&quot;</span>,.)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb77-17" data-line-number="17"><span class="st">  </span><span class="kw">do.call</span>(rbind,.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb77-18" data-line-number="18"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb77-19" data-line-number="19"><span class="st">  </span><span class="kw">tibble</span>()</a>
<a class="sourceLine" id="cb77-20" data-line-number="20"></a>
<a class="sourceLine" id="cb77-21" data-line-number="21">df3b_<span class="dv">2018</span> &lt;-<span class="st"> </span><span class="kw">map</span>(df3_<span class="dv">2018</span>, tail, <span class="dv">2</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb77-22" data-line-number="22"><span class="st">  </span><span class="kw">do.call</span>(rbind,.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb77-23" data-line-number="23"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb77-24" data-line-number="24"><span class="st">  </span><span class="kw">mutate_if</span>(is.character, as.numeric) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb77-25" data-line-number="25"><span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(<span class="op">-</span>X2), <span class="op">~</span><span class="st"> </span>. <span class="op">*</span><span class="st"> </span><span class="fl">0.1</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb77-26" data-line-number="26"><span class="st">  </span><span class="kw">tibble</span>() </a>
<a class="sourceLine" id="cb77-27" data-line-number="27"></a>
<a class="sourceLine" id="cb77-28" data-line-number="28"><span class="kw">rm</span>(df3_<span class="dv">2018</span>)</a>
<a class="sourceLine" id="cb77-29" data-line-number="29">  </a>
<a class="sourceLine" id="cb77-30" data-line-number="30">df3_<span class="dv">2018</span> &lt;-<span class="st"> </span><span class="kw">bind_cols</span>(df3a_<span class="dv">2018</span>,</a>
<a class="sourceLine" id="cb77-31" data-line-number="31">                      df3b_<span class="dv">2018</span>)</a>
<a class="sourceLine" id="cb77-32" data-line-number="32"><span class="kw">names</span>(df3_<span class="dv">2018</span>) &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb77-33" data-line-number="33"></a>
<a class="sourceLine" id="cb77-34" data-line-number="34">column_names &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Group&quot;</span>,</a>
<a class="sourceLine" id="cb77-35" data-line-number="35">                  <span class="st">&quot;Rate&quot;</span>,</a>
<a class="sourceLine" id="cb77-36" data-line-number="36">                  <span class="st">&quot;N_2017&quot;</span>)</a>
<a class="sourceLine" id="cb77-37" data-line-number="37"></a>
<a class="sourceLine" id="cb77-38" data-line-number="38"><span class="kw">colnames</span>(df3_<span class="dv">2018</span>) &lt;-<span class="st"> </span>column_names</a>
<a class="sourceLine" id="cb77-39" data-line-number="39"></a>
<a class="sourceLine" id="cb77-40" data-line-number="40">df3_<span class="dv">2018</span> &lt;-<span class="st"> </span>df3_<span class="dv">2018</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb77-41" data-line-number="41"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>N_<span class="dv">2017</span>)</a>
<a class="sourceLine" id="cb77-42" data-line-number="42"></a>
<a class="sourceLine" id="cb77-43" data-line-number="43">df3_<span class="dv">2018</span> &lt;-<span class="st"> </span>df3_<span class="dv">2018</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb77-44" data-line-number="44"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">Year =</span> <span class="dv">2018</span>)</a>
<a class="sourceLine" id="cb77-45" data-line-number="45"></a>
<a class="sourceLine" id="cb77-46" data-line-number="46">df3_<span class="dv">2018</span> &lt;-<span class="st"> </span>df3_<span class="dv">2018</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb77-47" data-line-number="47"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Gender =</span> <span class="kw">case_when</span>(<span class="kw">str_detect</span>(Group, <span class="st">&quot;Women&quot;</span>) <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb77-48" data-line-number="48">                            <span class="kw">str_detect</span>(Group, <span class="st">&quot;Men&quot;</span>) <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb77-49" data-line-number="49">                            <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">NA</span>))</a>
<a class="sourceLine" id="cb77-50" data-line-number="50"></a>
<a class="sourceLine" id="cb77-51" data-line-number="51">labels &lt;-<span class="st"> </span><span class="kw">unlist</span>(df3_<span class="dv">2018</span>[<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">12</span>, <span class="dt">by =</span><span class="dv">3</span>),<span class="dv">1</span>], <span class="dt">use.names =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb77-52" data-line-number="52"></a>
<a class="sourceLine" id="cb77-53" data-line-number="53"><span class="kw">dim</span>(df3_<span class="dv">2018</span>)[<span class="dv">1</span>]</a></code></pre></div>
<pre><code>[1] 12</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" data-line-number="1">labels_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">rep</span>(labels, <span class="dt">each =</span> <span class="kw">dim</span>(df3_<span class="dv">2018</span>)[<span class="dv">1</span>]<span class="op">/</span><span class="kw">length</span>(labels))</a>
<a class="sourceLine" id="cb79-2" data-line-number="2"></a>
<a class="sourceLine" id="cb79-3" data-line-number="3">df3_<span class="dv">2018</span><span class="op">$</span>Subgroup &lt;-<span class="st"> </span>labels_<span class="dv">3</span></a>
<a class="sourceLine" id="cb79-4" data-line-number="4"></a>
<a class="sourceLine" id="cb79-5" data-line-number="5">df3_<span class="dv">2018</span> &lt;-<span class="st"> </span>df3_<span class="dv">2018</span> <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb79-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Type =</span> <span class="st">&quot;Subgroup Total&quot;</span>)</a>
<a class="sourceLine" id="cb79-7" data-line-number="7"></a>
<a class="sourceLine" id="cb79-8" data-line-number="8"><span class="kw">glimpse</span>(df3_<span class="dv">2018</span>)</a></code></pre></div>
<pre><code>Rows: 12
Columns: 6
$ Group    &lt;chr&gt; &quot;SOUTHAMERICAN&quot;, &quot;Men&quot;, &quot;Women&quot;, &quot;MEXICAN&quot;, &quot;Men&quot;, &quot;Women&quot;, …
$ Rate     &lt;dbl&gt; 8.0, 7.5, 8.6, 12.9, 12.0, 13.8, 13.7, 14.9, 12.4, 13.7, 11.…
$ Year     &lt;dbl&gt; 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, …
$ Gender   &lt;lgl&gt; NA, FALSE, TRUE, NA, FALSE, TRUE, NA, FALSE, TRUE, NA, FALSE…
$ Subgroup &lt;chr&gt; &quot;SOUTHAMERICAN&quot;, &quot;SOUTHAMERICAN&quot;, &quot;SOUTHAMERICAN&quot;, &quot;MEXICAN&quot;…
$ Type     &lt;chr&gt; &quot;Subgroup Total&quot;, &quot;Subgroup Total&quot;, &quot;Subgroup Total&quot;, &quot;Subgr…</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" data-line-number="1">df3_<span class="dv">2018</span> &lt;-<span class="st"> </span>df3_<span class="dv">2018</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb81-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Gender =</span> <span class="kw">case_when</span>(Gender <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Female&quot;</span>,</a>
<a class="sourceLine" id="cb81-3" data-line-number="3">                            Gender <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">~</span><span class="st"> &quot;Male&quot;</span>,</a>
<a class="sourceLine" id="cb81-4" data-line-number="4">                            <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;All&quot;</span>))</a>
<a class="sourceLine" id="cb81-5" data-line-number="5"></a>
<a class="sourceLine" id="cb81-6" data-line-number="6">df3_<span class="dv">2018</span> &lt;-<span class="st"> </span>df3_<span class="dv">2018</span> <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb81-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate_if</span>(is.character, tolower) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb81-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate_if</span>(is.character, toupper)</a>
<a class="sourceLine" id="cb81-9" data-line-number="9"></a>
<a class="sourceLine" id="cb81-10" data-line-number="10">df3_<span class="dv">2018</span> &lt;-<span class="st"> </span>df3_<span class="dv">2018</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb81-11" data-line-number="11"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>Group)</a>
<a class="sourceLine" id="cb81-12" data-line-number="12"></a>
<a class="sourceLine" id="cb81-13" data-line-number="13">df3_<span class="dv">2018</span> &lt;-<span class="st"> </span>df3_<span class="dv">2018</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb81-14" data-line-number="14"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Subgroup =</span> <span class="kw">case_when</span>(Subgroup <span class="op">==</span><span class="st"> &quot;SOUTHAMERICAN&quot;</span> <span class="op">~</span><span class="st"> &quot;SOUTH AMERICAN&quot;</span>,</a>
<a class="sourceLine" id="cb81-15" data-line-number="15">                              Subgroup <span class="op">==</span><span class="st"> &quot;CENTRALAMERICAN&quot;</span> <span class="op">~</span><span class="st"> &quot;CENTRAL AMERICAN&quot;</span>,</a>
<a class="sourceLine" id="cb81-16" data-line-number="16">                              Subgroup <span class="op">==</span><span class="st"> &quot;PRDRCUBAN&quot;</span> <span class="op">~</span><span class="st"> &quot;PR/DR/CUBAN&quot;</span>,</a>
<a class="sourceLine" id="cb81-17" data-line-number="17">                              <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span>Subgroup))</a></code></pre></div>
<p>We load the PDF.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" data-line-number="1"><span class="kw">rm</span>(excerpt)</a>
<a class="sourceLine" id="cb82-2" data-line-number="2">excerpt &lt;-<span class="st"> </span><span class="kw">image_read</span>(<span class="kw">here</span>(<span class="st">&quot;img&quot;</span>, <span class="st">&quot;latino_a_youth_excerpt.png&quot;</span>))</a>
<a class="sourceLine" id="cb82-3" data-line-number="3"></a>
<a class="sourceLine" id="cb82-4" data-line-number="4">excerpt</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-45-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>We add the rows.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" data-line-number="1">df3_<span class="dv">2018</span> &lt;-<span class="st"> </span>df3_<span class="dv">2018</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb83-2" data-line-number="2"><span class="st">  </span><span class="kw">add_row</span>(<span class="dt">Rate =</span> <span class="fl">12.8</span>,</a>
<a class="sourceLine" id="cb83-3" data-line-number="3">          <span class="dt">Year =</span> <span class="dv">2018</span>,</a>
<a class="sourceLine" id="cb83-4" data-line-number="4">          <span class="dt">Gender =</span> <span class="st">&quot;ALL&quot;</span>,</a>
<a class="sourceLine" id="cb83-5" data-line-number="5">          <span class="dt">Subgroup =</span> <span class="st">&quot;ALL&quot;</span>, </a>
<a class="sourceLine" id="cb83-6" data-line-number="6">          <span class="dt">Type =</span> <span class="st">&quot;LATINO/A TOTAL&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb83-7" data-line-number="7"><span class="st">  </span><span class="kw">add_row</span>(<span class="dt">Rate =</span> <span class="fl">13.3</span>,</a>
<a class="sourceLine" id="cb83-8" data-line-number="8">          <span class="dt">Year =</span> <span class="dv">2018</span>,</a>
<a class="sourceLine" id="cb83-9" data-line-number="9">          <span class="dt">Gender =</span> <span class="st">&quot;FEMALE&quot;</span>,</a>
<a class="sourceLine" id="cb83-10" data-line-number="10">          <span class="dt">Subgroup =</span> <span class="st">&quot;ALL&quot;</span>, </a>
<a class="sourceLine" id="cb83-11" data-line-number="11">          <span class="dt">Type =</span> <span class="st">&quot;GENDER TOTAL&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb83-12" data-line-number="12"><span class="st">  </span><span class="kw">add_row</span>(<span class="dt">Rate =</span> <span class="fl">12.3</span>,</a>
<a class="sourceLine" id="cb83-13" data-line-number="13">          <span class="dt">Year =</span> <span class="dv">2018</span>,</a>
<a class="sourceLine" id="cb83-14" data-line-number="14">          <span class="dt">Gender =</span> <span class="st">&quot;MALE&quot;</span>,</a>
<a class="sourceLine" id="cb83-15" data-line-number="15">          <span class="dt">Subgroup =</span> <span class="st">&quot;ALL&quot;</span>, </a>
<a class="sourceLine" id="cb83-16" data-line-number="16">          <span class="dt">Type =</span> <span class="st">&quot;GENDER TOTAL&quot;</span>)</a></code></pre></div>
<p>We add the 2018 data to the dataframe</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" data-line-number="1">df3 &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(df3,</a>
<a class="sourceLine" id="cb84-2" data-line-number="2">                 df3_<span class="dv">2018</span>)</a></code></pre></div>
</div>
<div id="map" class="section level3">
<h3>Map</h3>
<p>We will use multiple images to import the data on page 36 to produce maps.</p>
<style>
div.red { background-color:#ffcccb; border-radius: 5px; padding: 20px;}
</style>
<div class="red">
<p><strong>MICHAEL ONTIVEROS</strong></p>
<p><em>This code is not complete. If there is time, we will return to it! Magick is having trouble with quadrant 1 and 4. I could not figure out why.</em></p>
</div>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" data-line-number="1">quadrant1 &lt;-<span class="st"> </span><span class="kw">image_read</span>(<span class="kw">here</span>(<span class="st">&quot;img&quot;</span>, <span class="st">&quot;state_quadrant1.png&quot;</span>))</a>
<a class="sourceLine" id="cb85-2" data-line-number="2">quadrant2 &lt;-<span class="st"> </span><span class="kw">image_read</span>(<span class="kw">here</span>(<span class="st">&quot;img&quot;</span>, <span class="st">&quot;state_quadrant2.png&quot;</span>))</a>
<a class="sourceLine" id="cb85-3" data-line-number="3">quadrant3 &lt;-<span class="st"> </span><span class="kw">image_read</span>(<span class="kw">here</span>(<span class="st">&quot;img&quot;</span>, <span class="st">&quot;state_quadrant3.png&quot;</span>))</a>
<a class="sourceLine" id="cb85-4" data-line-number="4">quadrant4 &lt;-<span class="st"> </span><span class="kw">image_read</span>(<span class="kw">here</span>(<span class="st">&quot;img&quot;</span>, <span class="st">&quot;state_quadrant4.png&quot;</span>))</a>
<a class="sourceLine" id="cb85-5" data-line-number="5"></a>
<a class="sourceLine" id="cb85-6" data-line-number="6">quadrant1 &lt;-<span class="st"> </span>magick<span class="op">::</span><span class="kw">image_ocr</span>(quadrant1)</a>
<a class="sourceLine" id="cb85-7" data-line-number="7">quadrant2 &lt;-<span class="st"> </span>magick<span class="op">::</span><span class="kw">image_ocr</span>(quadrant2)</a>
<a class="sourceLine" id="cb85-8" data-line-number="8">quadrant3 &lt;-<span class="st"> </span>magick<span class="op">::</span><span class="kw">image_ocr</span>(quadrant3)</a>
<a class="sourceLine" id="cb85-9" data-line-number="9">quadrant4 &lt;-<span class="st"> </span>magick<span class="op">::</span><span class="kw">image_ocr</span>(quadrant4)</a>
<a class="sourceLine" id="cb85-10" data-line-number="10"></a>
<a class="sourceLine" id="cb85-11" data-line-number="11">labels_quad1_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">paste0</span>(quadrant1, quadrant3)</a>
<a class="sourceLine" id="cb85-12" data-line-number="12">labels_quad2_<span class="dv">4</span> &lt;-<span class="st"> </span><span class="kw">paste0</span>(quadrant2, quadrant4)</a>
<a class="sourceLine" id="cb85-13" data-line-number="13"></a>
<a class="sourceLine" id="cb85-14" data-line-number="14">labels_quad1_<span class="dv">3</span> &lt;-<span class="st"> </span>labels_quad1_<span class="dv">3</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb85-15" data-line-number="15"><span class="st">  </span><span class="kw">strsplit</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb85-16" data-line-number="16"><span class="st">  </span><span class="kw">unlist</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb85-17" data-line-number="17"><span class="st">  </span><span class="kw">as_tibble</span>()</a>
<a class="sourceLine" id="cb85-18" data-line-number="18"></a>
<a class="sourceLine" id="cb85-19" data-line-number="19">labels_quad2_<span class="dv">4</span> &lt;-<span class="st"> </span>labels_quad2_<span class="dv">4</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb85-20" data-line-number="20"><span class="st">  </span><span class="kw">strsplit</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb85-21" data-line-number="21"><span class="st">  </span><span class="kw">unlist</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb85-22" data-line-number="22"><span class="st">  </span><span class="kw">as_tibble</span>()</a>
<a class="sourceLine" id="cb85-23" data-line-number="23"></a>
<a class="sourceLine" id="cb85-24" data-line-number="24">df1 &lt;-<span class="st"> </span>df1 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb85-25" data-line-number="25"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(value) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb85-26" data-line-number="26"><span class="st">  </span><span class="kw">pull</span>(value) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb85-27" data-line-number="27"><span class="st">  </span><span class="kw">str_split</span>(<span class="st">&quot; &quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" data-line-number="1">data_map &lt;-<span class="st"> </span><span class="kw">map_data</span>(<span class="st">&quot;state&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb86-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(region<span class="op">==</span><span class="st">&quot;california&quot;</span>)</a>
<a class="sourceLine" id="cb86-3" data-line-number="3"></a>
<a class="sourceLine" id="cb86-4" data-line-number="4">years &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">2008</span>,<span class="dv">2016</span>,<span class="dt">by=</span><span class="dv">2</span>),<span class="dv">2017</span>)</a>
<a class="sourceLine" id="cb86-5" data-line-number="5"></a>
<a class="sourceLine" id="cb86-6" data-line-number="6">index_rep &lt;-<span class="st"> </span><span class="kw">dim</span>(data_map)[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb86-7" data-line-number="7"></a>
<a class="sourceLine" id="cb86-8" data-line-number="8">data_map &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(<span class="kw">replicate</span>(<span class="kw">length</span>(years), data_map, <span class="dt">simplify =</span> <span class="ot">FALSE</span>))</a>
<a class="sourceLine" id="cb86-9" data-line-number="9"></a>
<a class="sourceLine" id="cb86-10" data-line-number="10">data_map<span class="op">$</span>year &lt;-<span class="st"> </span><span class="kw">rep</span>(years, <span class="dt">each =</span> index_rep)</a>
<a class="sourceLine" id="cb86-11" data-line-number="11"></a>
<a class="sourceLine" id="cb86-12" data-line-number="12">data_map &lt;-<span class="st"> </span>data_map <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb86-13" data-line-number="13"><span class="st">  </span><span class="kw">group_by</span>(region, year) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb86-14" data-line-number="14"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">rank_ran =</span> <span class="kw">rank</span>(year, <span class="dt">ties.method =</span> <span class="st">&quot;random&quot;</span>))</a>
<a class="sourceLine" id="cb86-15" data-line-number="15"></a>
<a class="sourceLine" id="cb86-16" data-line-number="16">data_map &lt;-<span class="st"> </span>data_map[<span class="kw">order</span>(data_map<span class="op">$</span>order),]</a>
<a class="sourceLine" id="cb86-17" data-line-number="17"></a>
<a class="sourceLine" id="cb86-18" data-line-number="18"><span class="kw">library</span>(gganimate)</a>
<a class="sourceLine" id="cb86-19" data-line-number="19"></a>
<a class="sourceLine" id="cb86-20" data-line-number="20"><span class="kw">ggplot</span>(data_map, <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group, <span class="dt">fill=</span>rank_ran)) <span class="op">+</span></a>
<a class="sourceLine" id="cb86-21" data-line-number="21"><span class="st">  </span><span class="kw">geom_polygon</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb86-22" data-line-number="22"><span class="st">  </span><span class="kw">transition_time</span>(<span class="dt">time =</span> year)</a></code></pre></div>
</div>
</div>
<div id="data-analysis" class="section level2">
<h2><strong>Data Analysis</strong></h2>
<hr />
<p><strong>Repeated Cross-sectional Data</strong></p>
<p>We have pooled (repeated) <a href="https://en.wikipedia.org/wiki/Cross-sectional_data?oldformat=true">cross-sectional</a> data.</p>
<p>This is data produced from repeated measurement of a <a href="https://en.wikipedia.org/wiki/Population?oldformat=true">population</a> over time.</p>
<p>It is often infeasible to collect data for an entire population at once. However, we can still obtain meaningful measures using a random <a href="https://en.wikipedia.org/wiki/Sampling_(statistics)?oldformat=true">sample</a> of the population.</p>
<p>At specific time-points, data is collected from a sample of the population. The individuals in each sample are not necessarily the same individuals. This separates pooled cross-sectional data from panel data, which is longitudinal data from repeated measurement of the same people.</p>
<p>By sampling from a population at multiple time points, we can generate population level statistics. Although these statistics have some random error, they can provide insight into how the measure variable is changing in a population over time.</p>
<p>We can accomplish this by plotting the measured values over time. Sometimes, however, the trend isn’t exactly clear. Fortunately, there are statistical methods to resolve this issue.</p>
<p>The Mann-Kendall trend test—a variation of the <a href="https://en.wikipedia.org/wiki/Kendall_rank_correlation_coefficient?oldformat=true">Kendall rank correlation coefficient</a>—tests whether there is a monotonic association, an association that does not increase or decrease but remains static across a dimension.</p>
<p>Recall the youth disconnection rates for Native Americans, some of the highest in the first table we examined.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" data-line-number="1">image_example</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-50-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Let’s conduct a Mann-Kendall test for trend.</p>
<p>We can accomplish this with the <code>Kendall::MannKendall()</code> function. The <code>Kendall::MannKendall()</code> accepts a vector of data for which a trend may be observed. <a href="https://rdrr.io/cran/Kendall/man/MannKendall.html">Consulting the documentation for the <code>Kendall::MannKendall()</code> function available on CRAN</a>, we can “test for a a monotonic trend in a time series”.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" data-line-number="1">df1 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb88-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(Gender <span class="op">==</span><span class="st"> &quot;ALL&quot;</span>,</a>
<a class="sourceLine" id="cb88-3" data-line-number="3">         Race <span class="op">==</span><span class="st"> &quot;NATIVE AMERICAN&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb88-4" data-line-number="4"><span class="st">  </span><span class="kw">pull</span>(Rate) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb88-5" data-line-number="5"><span class="st">  </span><span class="kw">MannKendall</span>(.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb88-6" data-line-number="6"><span class="st">  </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>Score =  -7 , Var(Score) = 28.33333
denominator =  15
tau = -0.467, 2-sided pvalue =0.25966</code></pre>
<p>There does not appear to be a change in the trend. However, it’s important to note that we only have 6 observations.</p>
<p>We can also explore the trend using <a href="https://en.wikipedia.org/wiki/Simple_linear_regression?oldformat=true">simple linear regression</a>.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" data-line-number="1">df1 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb90-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(Gender <span class="op">==</span><span class="st"> &quot;ALL&quot;</span>,</a>
<a class="sourceLine" id="cb90-3" data-line-number="3">         Race <span class="op">==</span><span class="st"> &quot;NATIVE AMERICAN&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb90-4" data-line-number="4"><span class="st">  </span><span class="kw">lm</span>(Rate <span class="op">~</span><span class="st"> </span>Year, <span class="dt">data =</span> .) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb90-5" data-line-number="5"><span class="st">  </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>
Call:
lm(formula = Rate ~ Year, data = .)

Residuals:
      1       2       3       4       5       6 
-2.4332  2.2978  0.8288  0.4597  0.2907 -1.4438 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) 359.1159   487.3956   0.737    0.502
Year         -0.1655     0.2421  -0.683    0.532

Residual standard error: 1.889 on 4 degrees of freedom
Multiple R-squared:  0.1045,    Adjusted R-squared:  -0.1193 
F-statistic: 0.467 on 1 and 4 DF,  p-value: 0.5319</code></pre>
<p>For each one year change, the mean increase in disconnection rates is -0.1654795. This relationship is not statistically significant. Again, we are largely limited by the number of observations in this dataset.</p>
<p>We can visualize the relationship above.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" data-line-number="1">df1 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb92-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(Gender <span class="op">==</span><span class="st"> &quot;ALL&quot;</span>,</a>
<a class="sourceLine" id="cb92-3" data-line-number="3">         Race <span class="op">==</span><span class="st"> &quot;NATIVE AMERICAN&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb92-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> Rate)) <span class="op">+</span></a>
<a class="sourceLine" id="cb92-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb92-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb92-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">2008</span>, <span class="dv">2018</span>, <span class="dt">by =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb92-8" data-line-number="8">                     <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="dv">2008</span>, <span class="dv">2018</span>, <span class="dt">by =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb92-9" data-line-number="9">                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">2008</span>, <span class="dv">2018</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb92-10" data-line-number="10"><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb92-11" data-line-number="11"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Youth Disconnection Rates of Native American Youth&quot;</span>,</a>
<a class="sourceLine" id="cb92-12" data-line-number="12">       <span class="dt">subtitle =</span> <span class="st">&quot;2008 - 2017&quot;</span>,</a>
<a class="sourceLine" id="cb92-13" data-line-number="13">       <span class="dt">x =</span> <span class="st">&quot;Year&quot;</span>,</a>
<a class="sourceLine" id="cb92-14" data-line-number="14">       <span class="dt">y =</span> <span class="st">&quot;Disconnection Rate&quot;</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-53-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>As we can see, there is a large amount of uncertainty around the fitted line.</p>
<p>Let’s visualize the data!</p>
</div>
<div id="data-visualization" class="section level2">
<h2><strong>Data Visualization</strong></h2>
<hr />
<p>Let’s reproduce the example below.</p>
<p><img src="img/Making_the_Connection_plot.png" width="100%" style="display: block; margin: auto;" /></p>
<p>We can create a version of the above example with <code>ggplot</code> from <code>tidyverse</code>.</p>
<p>There are color identifying websites only such as <a href="https://imagecolorpicker.com/en/">this</a>.</p>
<p>Using one of these websites, we identify the <a href="https://en.wikipedia.org/wiki/Web_colors?oldformat=true">hex triplet</a> for the color used in the visualization included in the PDF: <code>#008393</code>.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" data-line-number="1">fa_figurine &lt;-<span class="st"> </span><span class="kw">image_read</span>(<span class="st">&quot;https://upload.wikimedia.org/wikipedia/commons/7/7c/User_font_awesome.svg&quot;</span>)</a>
<a class="sourceLine" id="cb93-2" data-line-number="2"></a>
<a class="sourceLine" id="cb93-3" data-line-number="3">fa_figurine &lt;-<span class="st"> </span><span class="kw">image_fill</span>(fa_figurine,</a>
<a class="sourceLine" id="cb93-4" data-line-number="4">                          <span class="dt">color =</span> <span class="st">&quot;#008393&quot;</span>, </a>
<a class="sourceLine" id="cb93-5" data-line-number="5">                          <span class="dt">point =</span> <span class="st">&quot;+800+800&quot;</span>,</a>
<a class="sourceLine" id="cb93-6" data-line-number="6">                          <span class="dt">fuzz =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb93-7" data-line-number="7"></a>
<a class="sourceLine" id="cb93-8" data-line-number="8">fa_figurine &lt;-<span class="st"> </span><span class="kw">image_fill</span>(fa_figurine,</a>
<a class="sourceLine" id="cb93-9" data-line-number="9">                          <span class="dt">color =</span> <span class="st">&quot;#008393&quot;</span>, </a>
<a class="sourceLine" id="cb93-10" data-line-number="10">                          <span class="dt">point =</span> <span class="st">&quot;+800+1000&quot;</span>,</a>
<a class="sourceLine" id="cb93-11" data-line-number="11">                          <span class="dt">fuzz =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb93-12" data-line-number="12"></a>
<a class="sourceLine" id="cb93-13" data-line-number="13">df1 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb93-14" data-line-number="14"><span class="st">  </span><span class="kw">filter</span>(Type <span class="op">==</span><span class="st"> &quot;RACE TOTAL&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb93-15" data-line-number="15"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> Rate, <span class="dt">group=</span>Race)) <span class="op">+</span></a>
<a class="sourceLine" id="cb93-16" data-line-number="16"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">color =</span> <span class="st">&quot;#008393&quot;</span>, <span class="dt">size =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb93-17" data-line-number="17"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">color =</span> <span class="st">&quot;#008393&quot;</span>, <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb93-18" data-line-number="18"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">2008</span>,<span class="dv">2018</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb93-19" data-line-number="19">                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">2008</span>,<span class="dv">2018</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb93-20" data-line-number="20"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">5</span>,<span class="dv">30</span>, <span class="dt">by =</span><span class="dv">5</span>),</a>
<a class="sourceLine" id="cb93-21" data-line-number="21">                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">30</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb93-22" data-line-number="22"><span class="st">  </span><span class="kw">draw_image</span>(fa_figurine, <span class="dt">x =</span> <span class="dv">2017</span>, <span class="dt">y =</span> <span class="fl">23.5</span>, <span class="dt">scale =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb93-23" data-line-number="23"><span class="st">  </span><span class="kw">draw_image</span>(fa_figurine, <span class="dt">x =</span> <span class="dv">2017</span>, <span class="dt">y =</span> <span class="fl">17.5</span>, <span class="dt">scale =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb93-24" data-line-number="24"><span class="st">  </span><span class="kw">draw_image</span>(fa_figurine, <span class="dt">x =</span> <span class="dv">2017</span>, <span class="dt">y =</span> <span class="dv">13</span>, <span class="dt">scale =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb93-25" data-line-number="25"><span class="st">  </span><span class="kw">draw_image</span>(fa_figurine, <span class="dt">x =</span> <span class="dv">2017</span>, <span class="dt">y =</span> <span class="dv">9</span>, <span class="dt">scale =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb93-26" data-line-number="26"><span class="st">  </span><span class="kw">draw_image</span>(fa_figurine, <span class="dt">x =</span> <span class="dv">2017</span>, <span class="dt">y =</span> <span class="fl">6.5</span>, <span class="dt">scale =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb93-27" data-line-number="27"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;FIGURE 1 YOUTH DISCONNECTION BY RACE AND ETHNICITY, 2008 - 2017&quot;</span>,</a>
<a class="sourceLine" id="cb93-28" data-line-number="28">       <span class="dt">y =</span> <span class="st">&quot;YOUTH DISCONNECTION (%)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb93-29" data-line-number="29"><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb93-30" data-line-number="30"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb93-31" data-line-number="31">                             <span class="dt">color =</span> <span class="st">&quot;#008393&quot;</span>,</a>
<a class="sourceLine" id="cb93-32" data-line-number="32">                             <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),</a>
<a class="sourceLine" id="cb93-33" data-line-number="33">        <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-55-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>We can build off of this idea, using a custom color palette to create a gradient based off the color used.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" data-line-number="1">custom_pal &lt;-<span class="st"> </span><span class="kw">colorRampPalette</span>(<span class="kw">c</span>(<span class="st">&quot;white&quot;</span>, <span class="st">&quot;#008393&quot;</span>))</a>
<a class="sourceLine" id="cb94-2" data-line-number="2">gender_n &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb94-3" data-line-number="3"></a>
<a class="sourceLine" id="cb94-4" data-line-number="4">asian_total &lt;-<span class="st"> </span>df2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb94-5" data-line-number="5"><span class="st">  </span><span class="kw">filter</span>(Year <span class="op">==</span><span class="st"> </span><span class="dv">2017</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb94-6" data-line-number="6"><span class="st">  </span><span class="kw">filter</span>(Gender <span class="op">==</span><span class="st"> &quot;ALL&quot;</span>,</a>
<a class="sourceLine" id="cb94-7" data-line-number="7">         Subgroup <span class="op">==</span><span class="st"> &quot;ALL&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb94-8" data-line-number="8"><span class="st">  </span><span class="kw">pull</span>(Rate)</a>
<a class="sourceLine" id="cb94-9" data-line-number="9"></a>
<a class="sourceLine" id="cb94-10" data-line-number="10">df2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb94-11" data-line-number="11"><span class="st">  </span><span class="kw">filter</span>(Year <span class="op">==</span><span class="st"> </span><span class="dv">2017</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb94-12" data-line-number="12"><span class="st">  </span><span class="kw">complete</span>(Gender, Subgroup) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb94-13" data-line-number="13"><span class="st">  </span><span class="kw">group_by</span>(Gender) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb94-14" data-line-number="14"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sub_rank =</span> <span class="kw">rank</span>(Rate, <span class="dt">ties.method =</span> <span class="st">&quot;min&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb94-15" data-line-number="15"><span class="st">  </span><span class="kw">group_by</span>(Subgroup) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb94-16" data-line-number="16"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">rank_all =</span> sub_rank[Gender <span class="op">==</span><span class="st"> &quot;ALL&quot;</span>]) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb94-17" data-line-number="17"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb94-18" data-line-number="18"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Subgroup =</span> <span class="kw">fct_reorder</span>(Subgroup, rank_all)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb94-19" data-line-number="19"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Subgroup, <span class="dt">y =</span> Rate, <span class="dt">fill =</span> Gender)) <span class="op">+</span></a>
<a class="sourceLine" id="cb94-20" data-line-number="20"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> asian_total, </a>
<a class="sourceLine" id="cb94-21" data-line-number="21">             <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>,</a>
<a class="sourceLine" id="cb94-22" data-line-number="22">             <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb94-23" data-line-number="23"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>,</a>
<a class="sourceLine" id="cb94-24" data-line-number="24">           <span class="dt">color =</span> <span class="st">&quot;transparent&quot;</span>,</a>
<a class="sourceLine" id="cb94-25" data-line-number="25">           <span class="dt">size =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb94-26" data-line-number="26">           <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>,</a>
<a class="sourceLine" id="cb94-27" data-line-number="27">           <span class="dt">width =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb94-28" data-line-number="28"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;FIGURE X YOUTH DISCONNECTION BY ASIAN SUBGROUP, 2017&quot;</span>,</a>
<a class="sourceLine" id="cb94-29" data-line-number="29">       <span class="dt">subtitle =</span> <span class="st">&quot;ORDERED BY OVERALL DISCONNECTION&quot;</span>,</a>
<a class="sourceLine" id="cb94-30" data-line-number="30">       <span class="dt">y =</span> <span class="st">&quot;YOUTH DISCONNECTION (%)&quot;</span>,</a>
<a class="sourceLine" id="cb94-31" data-line-number="31">       <span class="dt">fill =</span> <span class="st">&quot;Gender&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb94-32" data-line-number="32"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">rev</span>(<span class="kw">custom_pal</span>(gender_n <span class="op">+</span><span class="st"> </span><span class="dv">1</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb94-33" data-line-number="33"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">20</span>,<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb94-34" data-line-number="34">                     <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">20</span>,<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb94-35" data-line-number="35">                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">20</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb94-36" data-line-number="36"><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb94-37" data-line-number="37"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb94-38" data-line-number="38">                             <span class="dt">color =</span> <span class="st">&quot;#008393&quot;</span>,</a>
<a class="sourceLine" id="cb94-39" data-line-number="39">                             <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),</a>
<a class="sourceLine" id="cb94-40" data-line-number="40">        <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb94-41" data-line-number="41">        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb94-42" data-line-number="42"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">label =</span> <span class="st">&#39;bold(&quot;ASIAN TOTAL&quot;)&#39;</span>,</a>
<a class="sourceLine" id="cb94-43" data-line-number="43">           <span class="dt">color =</span> <span class="st">&quot;#008393&quot;</span>, </a>
<a class="sourceLine" id="cb94-44" data-line-number="44">           <span class="dt">size =</span> <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb94-45" data-line-number="45">           <span class="dt">x =</span> <span class="fl">1.2</span>,</a>
<a class="sourceLine" id="cb94-46" data-line-number="46">           <span class="dt">y =</span> asian_total <span class="op">+</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb94-47" data-line-number="47">           <span class="dt">parse =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-56-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>From the above plot, it becomes apparent that the Hmong subgroup produces a small proportion of the total number of asian disconnected youth. The Asian total youth disconnection rate is more alike the youth disconnection rates for all other subgroups than the Hmong youth disconnection rate.</p>
<p>We can confirm this by revisiting the table.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" data-line-number="1">image2</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-57-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>The Hmong group represents 6% of all Asian disconnected youth.</p>
<p>This shows the importance of adding small details such as the composite line to plots. It helps provide a simple yet nuanced picture of what is going on.</p>
<p>Lastly, we can add annotations to add provide even more depth to the visualization.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" data-line-number="1">latino_a_total &lt;-<span class="st"> </span>df3 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb96-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(Year <span class="op">==</span><span class="st"> </span><span class="dv">2017</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb96-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(Gender <span class="op">==</span><span class="st"> &quot;ALL&quot;</span>,</a>
<a class="sourceLine" id="cb96-4" data-line-number="4">         Subgroup <span class="op">==</span><span class="st"> &quot;ALL&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb96-5" data-line-number="5"><span class="st">  </span><span class="kw">pull</span>(Rate)</a>
<a class="sourceLine" id="cb96-6" data-line-number="6"></a>
<a class="sourceLine" id="cb96-7" data-line-number="7">df3 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb96-8" data-line-number="8"><span class="st">  </span><span class="kw">filter</span>(Year <span class="op">==</span><span class="st"> </span><span class="dv">2017</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb96-9" data-line-number="9"><span class="st">  </span><span class="kw">complete</span>(Gender, Subgroup) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb96-10" data-line-number="10"><span class="st">  </span><span class="kw">group_by</span>(Gender) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb96-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sub_rank =</span> <span class="kw">rank</span>(Rate, <span class="dt">ties.method =</span> <span class="st">&quot;min&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb96-12" data-line-number="12"><span class="st">  </span><span class="kw">group_by</span>(Subgroup) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb96-13" data-line-number="13"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">rank_all =</span> sub_rank[Gender <span class="op">==</span><span class="st"> &quot;ALL&quot;</span>]) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb96-14" data-line-number="14"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb96-15" data-line-number="15"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Subgroup =</span> <span class="kw">fct_reorder</span>(Subgroup, rank_all)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb96-16" data-line-number="16"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Subgroup, <span class="dt">y =</span> Rate, <span class="dt">fill =</span> Gender)) <span class="op">+</span></a>
<a class="sourceLine" id="cb96-17" data-line-number="17"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> latino_a_total, </a>
<a class="sourceLine" id="cb96-18" data-line-number="18">             <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>,</a>
<a class="sourceLine" id="cb96-19" data-line-number="19">             <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb96-20" data-line-number="20"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>,</a>
<a class="sourceLine" id="cb96-21" data-line-number="21">           <span class="dt">color =</span> <span class="st">&quot;transparent&quot;</span>,</a>
<a class="sourceLine" id="cb96-22" data-line-number="22">           <span class="dt">size =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb96-23" data-line-number="23">           <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>,</a>
<a class="sourceLine" id="cb96-24" data-line-number="24">           <span class="dt">width =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb96-25" data-line-number="25"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;FIGURE X YOUTH DISCONNECTION BY LATINO/A SUBGROUP, 2017&quot;</span>,</a>
<a class="sourceLine" id="cb96-26" data-line-number="26">       <span class="dt">subtitle =</span> <span class="st">&quot;ORDERED BY OVERALL DISCONNECTION&quot;</span>,</a>
<a class="sourceLine" id="cb96-27" data-line-number="27">       <span class="dt">y =</span> <span class="st">&quot;YOUTH DISCONNECTION (%)&quot;</span>,</a>
<a class="sourceLine" id="cb96-28" data-line-number="28">       <span class="dt">fill =</span> <span class="st">&quot;Gender&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb96-29" data-line-number="29"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">rev</span>(<span class="kw">custom_pal</span>(gender_n <span class="op">+</span><span class="st"> </span><span class="dv">1</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb96-30" data-line-number="30"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">20</span>,<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb96-31" data-line-number="31">                     <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">20</span>,<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb96-32" data-line-number="32">                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">20</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb96-33" data-line-number="33"><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb96-34" data-line-number="34"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb96-35" data-line-number="35">                             <span class="dt">color =</span> <span class="st">&quot;#008393&quot;</span>,</a>
<a class="sourceLine" id="cb96-36" data-line-number="36">                             <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),</a>
<a class="sourceLine" id="cb96-37" data-line-number="37">        <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb96-38" data-line-number="38">        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb96-39" data-line-number="39"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">label =</span> <span class="st">&#39;bold(&quot;LATINO TOTAL&quot;)&#39;</span>,</a>
<a class="sourceLine" id="cb96-40" data-line-number="40">           <span class="dt">color =</span> <span class="st">&quot;#008393&quot;</span>, </a>
<a class="sourceLine" id="cb96-41" data-line-number="41">           <span class="dt">size =</span> <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb96-42" data-line-number="42">           <span class="dt">x =</span> <span class="fl">1.2</span>,</a>
<a class="sourceLine" id="cb96-43" data-line-number="43">           <span class="dt">y =</span> latino_a_total <span class="op">+</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb96-44" data-line-number="44">           <span class="dt">parse =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-58-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" data-line-number="1">df2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb97-2" data-line-number="2"><span class="st">  </span><span class="kw">complete</span>(Gender, Subgroup, Year) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb97-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(Subgroup) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb97-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">missing =</span> <span class="kw">sum</span>(<span class="kw">is.na</span>(Rate))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb97-5" data-line-number="5"><span class="st">  </span><span class="kw">filter</span>(missing <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb97-6" data-line-number="6"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>missing) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb97-7" data-line-number="7"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb97-8" data-line-number="8"><span class="st">  </span><span class="kw">group_by</span>(Gender) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb97-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sub_rank =</span> <span class="kw">rank</span>(Rate, <span class="dt">ties.method =</span> <span class="st">&quot;min&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb97-10" data-line-number="10"><span class="st">  </span><span class="kw">group_by</span>(Subgroup, Year) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb97-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">rank_all =</span> sub_rank[Gender <span class="op">==</span><span class="st"> &quot;ALL&quot;</span>]) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb97-12" data-line-number="12"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb97-13" data-line-number="13"><span class="st">  </span><span class="kw">group_by</span>(Year) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb97-14" data-line-number="14"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">threshold =</span> Rate[Gender <span class="op">==</span><span class="st"> &quot;ALL&quot;</span> <span class="op">&amp;</span><span class="st"> </span>Subgroup <span class="op">==</span><span class="st"> &quot;ALL&quot;</span>]) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb97-15" data-line-number="15"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb97-16" data-line-number="16"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Subgroup =</span> <span class="kw">fct_reorder</span>(Subgroup, rank_all)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb97-17" data-line-number="17"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Subgroup, <span class="dt">y =</span> Rate, <span class="dt">fill =</span> Gender)) <span class="op">+</span></a>
<a class="sourceLine" id="cb97-18" data-line-number="18"><span class="st">  </span><span class="kw">facet_wrap</span>(Year <span class="op">~</span>., <span class="dt">ncol =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb97-19" data-line-number="19"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept =</span> threshold), <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb97-20" data-line-number="20"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>,</a>
<a class="sourceLine" id="cb97-21" data-line-number="21">           <span class="dt">color =</span> <span class="st">&quot;transparent&quot;</span>,</a>
<a class="sourceLine" id="cb97-22" data-line-number="22">           <span class="dt">size =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb97-23" data-line-number="23">           <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>,</a>
<a class="sourceLine" id="cb97-24" data-line-number="24">           <span class="dt">width =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb97-25" data-line-number="25"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;FIGURE X YOUTH DISCONNECTION BY ASIAN SUBGROUP, 2017-2018&quot;</span>,</a>
<a class="sourceLine" id="cb97-26" data-line-number="26">       <span class="dt">subtitle =</span> <span class="st">&quot;ORDERED BY OVERALL DISCONNECTION&quot;</span>,</a>
<a class="sourceLine" id="cb97-27" data-line-number="27">       <span class="dt">y =</span> <span class="st">&quot;YOUTH DISCONNECTION (%)&quot;</span>,</a>
<a class="sourceLine" id="cb97-28" data-line-number="28">       <span class="dt">fill =</span> <span class="st">&quot;Gender&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb97-29" data-line-number="29"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">rev</span>(<span class="kw">custom_pal</span>(gender_n <span class="op">+</span><span class="st"> </span><span class="dv">1</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb97-30" data-line-number="30"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb97-31" data-line-number="31">                     <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb97-32" data-line-number="32">                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb97-33" data-line-number="33"><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb97-34" data-line-number="34"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb97-35" data-line-number="35">                             <span class="dt">color =</span> <span class="st">&quot;#008393&quot;</span>,</a>
<a class="sourceLine" id="cb97-36" data-line-number="36">                             <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),</a>
<a class="sourceLine" id="cb97-37" data-line-number="37">        <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb97-38" data-line-number="38">        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-59-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" data-line-number="1">df3 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb98-2" data-line-number="2"><span class="st">  </span><span class="kw">complete</span>(Gender, Subgroup, Year) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb98-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(Subgroup) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb98-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">missing =</span> <span class="kw">sum</span>(<span class="kw">is.na</span>(Rate))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb98-5" data-line-number="5"><span class="st">  </span><span class="kw">filter</span>(missing <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb98-6" data-line-number="6"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>missing) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb98-7" data-line-number="7"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb98-8" data-line-number="8"><span class="st">  </span><span class="kw">group_by</span>(Gender) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb98-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sub_rank =</span> <span class="kw">rank</span>(Rate, <span class="dt">ties.method =</span> <span class="st">&quot;min&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb98-10" data-line-number="10"><span class="st">  </span><span class="kw">group_by</span>(Subgroup, Year) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb98-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">rank_all =</span> sub_rank[Gender <span class="op">==</span><span class="st"> &quot;ALL&quot;</span>]) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb98-12" data-line-number="12"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb98-13" data-line-number="13"><span class="st">  </span><span class="kw">group_by</span>(Year) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb98-14" data-line-number="14"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">threshold =</span> Rate[Gender <span class="op">==</span><span class="st"> &quot;ALL&quot;</span> <span class="op">&amp;</span><span class="st"> </span>Subgroup <span class="op">==</span><span class="st"> &quot;ALL&quot;</span>]) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb98-15" data-line-number="15"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb98-16" data-line-number="16"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Subgroup =</span> <span class="kw">fct_reorder</span>(Subgroup, rank_all)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb98-17" data-line-number="17"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Subgroup, <span class="dt">y =</span> Rate, <span class="dt">fill =</span> Gender)) <span class="op">+</span></a>
<a class="sourceLine" id="cb98-18" data-line-number="18"><span class="st">  </span><span class="kw">facet_wrap</span>(Year <span class="op">~</span>., <span class="dt">ncol =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb98-19" data-line-number="19"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept =</span> threshold), <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb98-20" data-line-number="20"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>,</a>
<a class="sourceLine" id="cb98-21" data-line-number="21">           <span class="dt">color =</span> <span class="st">&quot;transparent&quot;</span>,</a>
<a class="sourceLine" id="cb98-22" data-line-number="22">           <span class="dt">size =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb98-23" data-line-number="23">           <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>,</a>
<a class="sourceLine" id="cb98-24" data-line-number="24">           <span class="dt">width =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb98-25" data-line-number="25"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;FIGURE X YOUTH DISCONNECTION BY LATINO/A SUBGROUP, 2017&quot;</span>,</a>
<a class="sourceLine" id="cb98-26" data-line-number="26">       <span class="dt">subtitle =</span> <span class="st">&quot;ORDERED BY OVERALL DISCONNECTION&quot;</span>,</a>
<a class="sourceLine" id="cb98-27" data-line-number="27">       <span class="dt">y =</span> <span class="st">&quot;YOUTH DISCONNECTION (%)&quot;</span>,</a>
<a class="sourceLine" id="cb98-28" data-line-number="28">       <span class="dt">fill =</span> <span class="st">&quot;Gender&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb98-29" data-line-number="29"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">rev</span>(<span class="kw">custom_pal</span>(gender_n <span class="op">+</span><span class="st"> </span><span class="dv">1</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb98-30" data-line-number="30"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">20</span>,<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb98-31" data-line-number="31">                     <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">20</span>,<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb98-32" data-line-number="32">                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">20</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb98-33" data-line-number="33"><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb98-34" data-line-number="34"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb98-35" data-line-number="35">                             <span class="dt">color =</span> <span class="st">&quot;#008393&quot;</span>,</a>
<a class="sourceLine" id="cb98-36" data-line-number="36">                             <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),</a>
<a class="sourceLine" id="cb98-37" data-line-number="37">        <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb98-38" data-line-number="38">        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-60-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="summary" class="section level2">
<h2><strong>Summary</strong></h2>
<hr />
</div>
<div id="suggested-homework" class="section level2">
<h2><strong>Suggested Homework</strong></h2>
<hr />
<ol style="list-style-type: decimal">
<li>Find another table in the document. Find differences between groups with the process described above.</li>
</ol>
</div>
<div id="helpful-links" class="section level2">
<h2><strong>Helpful Links</strong></h2>
<hr />
<p>avocado<em>This concepts listed here must be revisited.</em></p>
<p><u>Terms and concepts covered:</u></p>
<p><a href="https://www.tidyverse.org/" target="_blank">Tidyverse</a><br />
<a href="https://rstudio.com/resources/cheatsheets/" target="_blank">RStudio cheatsheets</a><br />
<a href="https://www.britannica.com/science/inference-statistics" target="_blank">Inference</a><br />
<a href="https://lindeloev.github.io/tests-as-linear/" target="_blank">Regression</a><br />
<a href="https://www.analyticsvidhya.com/blog/2015/08/comprehensive-guide-regression/" target="_blank">Different types of regression</a><br />
<a href="http://setosa.io/ev/ordinary-least-squares-regression/" target="_blank">Ordinary least squares method</a><br />
<a href="https://www.statisticshowto.datasciencecentral.com/residual/" target="_blank">Residual</a></p>
<p><u>Packages used in this case study: </u></p>
<table>
<thead>
<tr class="header">
<th>Package</th>
<th>Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="https://github.com/jennybc/here_here" target="_blank"><strong>here</strong></a></td>
<td>to easily load and save data</td>
</tr>
<tr class="even">
<td><a href="https://readr.tidyverse.org/" target="_blank"><strong>tidyverse</strong></a></td>
<td>for data science operations</td>
</tr>
<tr class="odd">
<td><a href="https://readr.tidyverse.org/" target="_blank"><strong>pdftools</strong></a></td>
<td>to manage PDF documents</td>
</tr>
<tr class="even">
<td><a href="https://cran.r-project.org/web/packages/magick/vignettes/intro.html#Kernel_convolution" target="_blank"><strong>magick</strong></a></td>
<td>for image processing</td>
</tr>
</tbody>
</table>
</div>
<div id="acknowledgements" class="section level2">
<h2>Acknowledgements</h2>
<p>We would like to acknowledge <a href="https://www.jhsph.edu/faculty/directory/profile/1770/tamar-mendelson">Tamar Mendelson</a> for assisting in framing the major direction of the case study.</p>
<p>We would also like to acknowledge the <a href="https://americanhealth.jhu.edu/">Bloomberg American Health Initiative</a> for funding this work.</p>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiT3BlbiBDYXNlIFN0dWRpZXMgOiBEaXNwYXJpdGllcyBpbiBZb3V0aCBEaXNjb25uZWN0aW9uIgpjc3M6IHN0eWxlLmNzcwpvdXRwdXQ6CiAgaHRtbF9kb2N1bWVudDoKICAgIHNlbGZfY29udGFpbmVkOiB5ZXMKICAgIGNvZGVfZG93bmxvYWQ6IHllcwogICAgaGlnaGxpZ2h0OiB0YW5nbwogICAgbnVtYmVyX3NlY3Rpb25zOiBubwogICAgdGhlbWU6IGNvc21vCiAgICB0b2M6IHllcwogICAgdG9jX2Zsb2F0OiB5ZXMKICBwZGZfZG9jdW1lbnQ6CiAgICB0b2M6IHllcwogIHdvcmRfZG9jdW1lbnQ6CiAgICB0b2M6IHllcwoKLS0tCgo8c3R5bGU+CiNUT0MgewogIGJhY2tncm91bmQ6IHVybCgiaHR0cHM6Ly9vcGVuY2FzZXN0dWRpZXMuZ2l0aHViLmlvL2ltZy9sb2dvLmpwZyIpOwogIGJhY2tncm91bmQtc2l6ZTogY29udGFpbjsKICBwYWRkaW5nLXRvcDogMjQwcHggIWltcG9ydGFudDsKICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0Owp9Cjwvc3R5bGU+CgoKCgoKCgo8c3R5bGU+CmRpdi5yZWQgeyBiYWNrZ3JvdW5kLWNvbG9yOiNmZmNjY2I7IGJvcmRlci1yYWRpdXM6IDVweDsgcGFkZGluZzogMjBweDt9Cjwvc3R5bGU+CjxkaXYgY2xhc3MgPSAicmVkIj4KCioqTUlDSEFFTCBPTlRJVkVST1MqKgoKKlRoZXJlIGFyZSBzb21lIGV4aXN0aW5nIHR5cG9zIGluIHRoZSB0YWJsZXMgaW4gYWRkaXRpb24gdG8gdGhvc2UgcHJvZHVjZWQgZHVyaW5nIHRoZSB1c2Ugb2YgTWFnaWNrLiBJIG1hZGUgc29tZSBhc3N1bXB0aW9ucyBhbG9uZyB0aGUgd2F5LCBkb2N1bWVudGluZyB0aGVtLiBUaGVzZSBuZWVkIHRvIGJlIGNoZWNrZWQgZm9yIGFjY3VyYWN5LioKPC9kaXY+CgpgYGB7ciBzZXR1cCwgaW5jbHVkZT1GQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGluY2x1ZGUgPSBUUlVFLCBjb21tZW50ID0gTkEsIGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZSA9IEZBTFNFLCB3YXJuaW5nID0gRkFMU0UsIGNhY2hlID0gRkFMU0UsCiAgICAgICAgICAgICAgICAgICAgICBmaWcuYWxpZ24gPSAiY2VudGVyIiwgb3V0LndpZHRoID0gJzkwJScpCmxpYnJhcnkoaGVyZSkKbGlicmFyeShrbml0cikKYGBgCgoKIyMjIyB7Lm91dGxpbmUgfQpgYGB7ciwgZWNobyA9IEZBTFNFLCBvdXQud2lkdGggPSAiODAwIHB4IiwgZXZhbD1GQUxTRX0Ka25pdHI6OmluY2x1ZGVfZ3JhcGhpY3MoaGVyZTo6aGVyZSgiaW1nIiwgIm1haW5wbG90LnBuZyIpKQpgYGAKCiMjIyMKCiMjIHsuZGlzY2xhaW1lcl9ibG9ja30KCioqRGlzY2xhaW1lcioqOiBUaGUgcHVycG9zZSBvZiB0aGUgW09wZW4gQ2FzZSBTdHVkaWVzXShodHRwczovL29wZW5jYXNlc3R1ZGllcy5naXRodWIuaW8pe3RhcmdldD0iX2JsYW5rIn0gcHJvamVjdCBpcyAqKnRvIGRlbW9uc3RyYXRlIHRoZSB1c2Ugb2YgdmFyaW91cyBkYXRhIHNjaWVuY2UgbWV0aG9kcywgdG9vbHMsIGFuZCBzb2Z0d2FyZSBpbiB0aGUgY29udGV4dCBvZiBtZXNzeSwgcmVhbC13b3JsZCBkYXRhKiouIEEgZ2l2ZW4gY2FzZSBzdHVkeSBkb2VzIG5vdCBjb3ZlciBhbGwgYXNwZWN0cyBvZiB0aGUgcmVzZWFyY2ggcHJvY2VzcywgaXMgbm90IGNsYWltaW5nIHRvIGJlIHRoZSBtb3N0IGFwcHJvcHJpYXRlIHdheSB0byBhbmFseXplIGEgZ2l2ZW4gZGF0YSBzZXQsIGFuZCBzaG91bGQgbm90IGJlIHVzZWQgaW4gdGhlIGNvbnRleHQgb2YgbWFraW5nIHBvbGljeSBkZWNpc2lvbnMgd2l0aG91dCBleHRlcm5hbCBjb25zdWx0YXRpb24gZnJvbSBzY2llbnRpZmljIGV4cGVydHMuIAoKCiMjIHsubGljZW5zZV9ibG9ja30KClRoaXMgd29yayBpcyBsaWNlbnNlZCB1bmRlciB0aGUgQ3JlYXRpdmUgQ29tbW9ucyBBdHRyaWJ1dGlvbi1Ob25Db21tZXJjaWFsIDMuMCBbKENDIEJZLU5DIDMuMCldKGh0dHBzOi8vY3JlYXRpdmVjb21tb25zLm9yZy9saWNlbnNlcy9ieS1uYy8zLjAvdXMvKXt0YXJnZXQ9Il9ibGFuayJ9ICBVbml0ZWQgU3RhdGVzIExpY2Vuc2UuCgoKIyMgey5yZWZlcmVuY2VfYmxvY2t9CgpUbyBjaXRlIHRoaXMgY2FzZSBzdHVkeSBwbGVhc2UgdXNlOgoKV3JpZ2h0LCBDYXJyaWUsIGFuZCBPbnRpdmVyb3MsIE1pY2hhZWwgYW5kIEphZ2VyLCBMZWFoIGFuZCBUYXViLCBNYXJnYXJldCBhbmQgSGlja3MsIFN0ZXBoYW5pZS4gKDIwMjApLiBodHRwczovL2dpdGh1Yi5jb20vb3BlbmNhc2VzdHVkaWVzL29jcy15b3V0aC1kaXNjb25uZWN0aW9uLWNhc2Utc3R1ZHkuIERpc3Bhcml0aWVzIGluIFlvdXRoIERpc2Nvbm5lY3Rpb24gKFZlcnNpb24gdjEuMC4wKS4KCiMjICoqTW90aXZhdGlvbioqCioqKiAKCkFjY29yZGluZyB0byB0aGlzIFtyZXBvcnRdKGh0dHBzOi8vc3NyYy1zdGF0aWMuczMuYW1hem9uYXdzLmNvbS9tb2EvTWFraW5nJTIwdGhlJTIwQ29ubmVjdGlvbi5wZGYpIHlvdXRoIGRpc2Nvbm5lY3Rpb24gYWx0aG91Z2ggZ2VuZXJhbGx5IHNob3dpbmcgZGVjcmVhc2luZyB0cmVuZHMgZm9yIHRoZSBwYXN0IDcgeWVhcnMsIHNob3dzIHJhY2lhbCBhbmQgZXRobmljIGRpc3Bhcml0aWVzLCB3aGVyZSBzb21lIGdyb3VwcyBhcmUgc2hvd2luZyBpbmNyZWFzZWQgcmF0ZXMgb2YgZGlzY29ubmVjdGlvbi4KClNvIHdoYXQgZGVvcyB0aGUgdGVybSAqKiJ5b3V0aCBkaXNjb25uZWN0aW9uIioqIG1lYW4/CgpBY2NvcmRpbmcgdG8gW01lYXN1cmUgb2YgQW1lcmljYV0oaHR0cHM6Ly93d3cuc3NyYy5vcmcvcHJvZ3JhbXMvdmlldy9tb2EvKXt0YXJnZXQ9Il9ibGFuayJ9IChhIG5vbnBhcnRpc2FuIHByb2plY3Qgb2YgdGhlIG5vbnByb2ZpdCBbU29jaWFsIFNjaWVuY2UgUmVzZWFyY2ggQ291bmNpbF0oaHR0cHM6Ly93d3cuc3NyYy5vcmcvKXt0YXJnZXQ9Il9ibGFuayJ9IHRoYXQgaXMgZm9jdXNlZCBvbiBvcHBvcnR1bml0eSBpbiB0aGUgVW5pdGVkIFN0YXRlcykgZGlzY29ubmVjdGVkIHlvdXRoIGFyZToKCj4gInlvdW5nIHBlb3BsZSBiZXR3ZWVuIHRoZSBhZ2VzIG9mICoqMTYgYW5kIDI0Kiogd2hvIGFyZSAqKm5laXRoZXIgd29ya2luZyBub3IgaW4gc2Nob29sKioiCgpUaGV5IHN0YXRlIHRoYXQgc3VjaCBkaXNjb25uZWN0aW9uIGhpbmRlcnMgdGhlc2UgaW5kaXZpZHVhbHMgdG8gYXF1aXJlIHNraWxscyBhbmQgY3JlYXRlIHJlbGF0aW9uc2hpcHMgbmVjZXNzYXJ5IHRvIGhhdmUgYSBzdWNlc3NmdWwgYWR1bHRob29kLiAKClRoZXkgc3RhdGUgdGhhdDoKCj4gInBlb3BsZSB3aG8gZXhwZXJpZW5jZSBhIHBlcmlvZCBvZiBkaXNjb25uZWN0aW9uIGFzIHlvdW5nIGFkdWx0cyBnbyBvbiB0byAqKmVhcm4gbGVzcyoqIGFuZCBhcmUgKipsZXNzIGxpa2VseSoqIHRvIGJlICoqZW1wbG95ZWQsIG93biBhIGhvbWUsIG9yIHJlcG9ydCBnb29kIGhlYWx0aCoqIGJ5IHRoZSB0aW1lIHRoZXkgcmVhY2ggdGhlaXIgdGhpcnRpZXMiCgpXZSB3aWxsIGV4cGFuZCBiZXlvbmQgdGhlIFtNZWFzdXJlIG9mIEFtZXJpY2EgYW5udWFsIHJlcG9ydF0oaHR0cHM6Ly9zc3JjLXN0YXRpYy5zMy5hbWF6b25hd3MuY29tL21vYS9NYWtpbmclMjB0aGUlMjBDb25uZWN0aW9uLnBkZil7dGFyZ2V0PSJfYmxhbmsifSB0byBjcmVhdGUgdmlzdWFsaXphdGlvbnMgb2YgcGVyY2VudCBkaXNjb25uZWN0aW9uIG9mIG1vcmUgc3BlY2lmaWMgZ3JvdXBzIG9mIHlvdXRocyAoZ2VuZGVyLCBldGhuaWMgZ3JvdXBzIGV0Yy4pIGdyYXBoZWQgdG9nZXRoZXIgb3ZlciB0aW1lIHRvIGFsbG93IGZvciBlYXNpZXIgY29tcGFyaXNvbi4KCmh0dHBzOi8vb25saW5lbGlicmFyeS53aWxleS5jb20vZG9pL2Z1bGwvMTAuMTExMS8xNDY4LTAwMDkuMTI0MjUKCgoKIyMgKipNYWluIFF1ZXN0aW9ucyoqCioqKiAKCiMjIyMgey5tYWluX3F1ZXN0aW9uX2Jsb2NrfQo8Yj48dT4gT3VyIG1haW4gcXVlc3Rpb246IDwvdT48L2I+CgoxKSBXaGF0IGRpZmZlcmVuY2VzIGluIHlvdXRoIGRpc2Nvbm5lY3Rpb24gcmF0ZXMgZXhpc3QgaW4gMjAxNz8gIAoKCkhvdyBoYXZlIHlvdXRoIGRpc2Nvbm5lY3Rpb24gcmF0ZXMgaW4gQW1lcmljYW4geW91dGggY2hhbmdlZCBzaW5jZSAyMDA4PyBJbiBwYXJ0aWN1bGFyLCBob3cgaGFzIHRoaXMgY2hhbmdlZCBmb3IgZGlmZmVyZW50IHN0YXRlcywgZ2VuZGVyLCBhbmQgZXRobmljIGdyb3Vwcz8gQXJlIGFueSBncm91cHMgcGFydGljdWxhcmx5IGRpc2Nvbm5lY3RlZD8KCiMjIyMKCiMjICoqTGVhcm5pbmcgT2JqZWN0aXZlcyoqIAoqKiogCgpJbiB0aGlzIGNhc2Ugc3R1ZHksIHdlIHdpbGwgZGVtb25zdHJhdGUgaG93IHRvIGltcG9ydCBhbmQgd3JhbmdsZSBkYXRhIGF2YWlsYWJsZSBpbiB0aGUgPHU+KipQKio8L3U+b3J0YWJsZSA8dT4qKkQqKjwvdT5vY3VtZW50IDx1PioqRioqPC91Pm9ybWF0ICgqKlBERioqKS4gV2Ugd2lsbCBlc3BlY2lhbGx5IGZvY3VzIG9uIHVzaW5nIHBhY2thZ2VzIGFuZCBmdW5jdGlvbnMgZnJvbSB0aGUgW2BUaWR5dmVyc2VgXShodHRwczovL3d3dy50aWR5dmVyc2Uub3JnLyl7dGFyZ2V0PSJfYmxhbmsifSwgc3VjaCBhcyBgZHBseXJgLCBgZ2dwbG90MmAuIFRoZSB0aWR5dmVyc2UgaXMgYSBsaWJyYXJ5IG9mIHBhY2thZ2VzIGNyZWF0ZWQgYnkgUlN0dWRpby4gV2hpbGUgc29tZSBzdHVkZW50cyBtYXkgYmUgZmFtaWxpYXIgd2l0aCBwcmV2aW91cyBSIHByb2dyYW1taW5nIHBhY2thZ2VzLCB0aGVzZSBwYWNrYWdlcyBtYWtlIGRhdGEgc2NpZW5jZSBpbiBSIGVzcGVjaWFsbHkgZWZmaWNpZW50LgoKVGhlIHNraWxscywgbWV0aG9kcywgYW5kIGNvbmNlcHRzIHRoYXQgc3R1ZGVudHMgd2lsbCBiZSBmYW1pbGlhciB3aXRoIGJ5IHRoZSBlbmQgb2YgdGhpcyBjYXNlIHN0dWR5IGFyZToKCkRhdGEgc2NpZW5jZSBza2lsbHM6CgoxLiBJbXBvcnRpbmcgZGF0YSBmcm9tIFBERiBmaWxlcyB1c2luZyB0aGUgYG1hZ2lja2AgcGFja2FnZQoyLiBBcHBseSBhY3Rpb24gdmVyYnMgaW4gYGRwbHlyYCBmb3IgZGF0YSB3cmFuZ2xpbmcKMy4gSG93IHRvIHBpdm90IGJldHdlZW4gImxvbmciIGFuZCAid2lkZSIgZGF0YXNldHMKNC4gSm9pbmluZyB0b2dldGhlciBtdWx0aXBsZSBkYXRhc2V0cyB1c2luZyBgZHBseXJgCjUuIEhvdyB0byBjcmVhdGUgZGF0YSB2aXN1YWxpemF0aW9ucyB3aXRoIGBnZ3Bsb3QyYCB0aGF0IGFyZSBpbiBhIHNpbWlsYXIgc3R5bGUgdG8gYW4gZXhpc3RpbmcgaW1hZ2UKClN0YXRpc3RpY2FsIGNvbmNlcHRzIGFuZCBtZXRob2RzOgoKCgpgYGB7ciwgb3V0LndpZHRoID0gIjIwJSIsIGVjaG8gPSBGQUxTRSwgZmlnLmFsaWduID0iY2VudGVyIn0KaW5jbHVkZV9ncmFwaGljcygiaHR0cHM6Ly90aWR5dmVyc2UudGlkeXZlcnNlLm9yZy9sb2dvLnBuZyIpCmBgYAoKKioqIAoKV2Ugd2lsbCBiZWdpbiBieSBsb2FkaW5nIHRoZSBwYWNrYWdlcyB0aGF0IHdlIHdpbGwgbmVlZDoKCmBgYHtyfQpsaWJyYXJ5KGhlcmUpCmxpYnJhcnkodGlkeXZlcnNlKQpsaWJyYXJ5KHBkZnRvb2xzKQpsaWJyYXJ5KG1hZ2ljaykKbGlicmFyeShjb3dwbG90KQpsaWJyYXJ5KEtlbmRhbGwpCmBgYAoKPHN0eWxlPgpkaXYuZ3JlZW4geyBiYWNrZ3JvdW5kLWNvbG9yOiM5MEVFOTA7IGJvcmRlci1yYWRpdXM6IDVweDsgcGFkZGluZzogMjBweDt9Cjwvc3R5bGU+CjxkaXYgY2xhc3MgPSAiZ3JlZW4iPgoqKk1JQ0hBRUwgT05USVZFUk9TKiogKkkgY2hhbmdlZCB0aGUgd2F5IHRoZSB0YWJsZSBsb29rcyBiZWxvdyB0byBwcmVzZW50IHRoZSBwYWNrYWdlIG5hbWVzIGluIGJvbGQuIE1hbnkgb2YgdGhlc2UgY2FzZSBzdHVkaWVzIGhhdmUgbG90cyBvZiB0ZXh0LiBIYXZpbmcgaW1wb3J0YW50IGZlYXR1cmVzIG9mIGEgY2FzZSBzdHVkeSBwcmVzZW50ZWQgaW4gYm9sZCwgaXRhbGljcywgb3IgYm90aCBtYXkgbWFrZSB0aGUgZG9jdW1lbnQgbW9yZSBlYXNpbHkgaW50ZXJwcmV0YWJsZS4gVGhpcyBpcyBqdXN0IG15IHR3byAmY2VudDsuIEZlZWwgZnJlZSB0byBkaXNyZWdhcmQgdGhpcyBzdWdnZXN0aW9uIGZvciBhbnkgcmVhc29uLioKPC9kaXY+CgogUGFja2FnZSAgIHwgVXNlICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAotLS0tLS0tLS0tIHwtLS0tLS0tLS0tLS0tClsqKmhlcmUqKl0oaHR0cHM6Ly9naXRodWIuY29tL2plbm55YmMvaGVyZV9oZXJlKXt0YXJnZXQ9Il9ibGFuayJ9ICAgICAgIHwgdG8gZWFzaWx5IGxvYWQgYW5kIHNhdmUgZGF0YQpbKip0aWR5dmVyc2UqKl0oaHR0cHM6Ly9yZWFkci50aWR5dmVyc2Uub3JnLyl7dGFyZ2V0PSJfYmxhbmsifSAgICAgIHwgZm9yIGRhdGEgc2NpZW5jZSBvcGVyYXRpb25zClsqKnBkZnRvb2xzKipdKGh0dHBzOi8vcmVhZHIudGlkeXZlcnNlLm9yZy8pe3RhcmdldD0iX2JsYW5rIn0gICAgICB8IHRvIG1hbmFnZSBQREYgZG9jdW1lbnRzClsqKm1hZ2ljayoqXShodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvbWFnaWNrL3ZpZ25ldHRlcy9pbnRyby5odG1sI0tlcm5lbF9jb252b2x1dGlvbil7dGFyZ2V0PSJfYmxhbmsifSAgICAgIHwgZm9yIGltYWdlIHByb2Nlc3NpbmcgCgpUaGUgZmlyc3QgdGltZSB3ZSB1c2UgYSBmdW5jdGlvbiwgd2Ugd2lsbCB1c2UgdGhlIGA6OmAgdG8gaW5kaWNhdGUgd2hpY2ggcGFja2FnZSB3ZSBhcmUgdXNpbmcuIFVubGVzcyB3ZSBoYXZlIG92ZXJsYXBwaW5nIGZ1bmN0aW9uIG5hbWVzLCB0aGlzIGlzIG5vdCBuZWNlc3NhcnksIGJ1dCB3ZSB3aWxsIGluY2x1ZGUgaXQgaGVyZSB0byBiZSBpbmZvcm1hdGl2ZSBhYm91dCB3aGVyZSB0aGUgZnVuY3Rpb25zIHdlIHdpbGwgdXNlIGNvbWUgZnJvbS4KCiMjICoqQ29udGV4dCoqCioqKiAKCmBgYHtyLCBlY2hvID0gRkFMU0UsIG91dC53aWR0aCA9ICI4MDAgcHgifQprbml0cjo6aW5jbHVkZV9ncmFwaGljcyhoZXJlOjpoZXJlKCJpbWciLCAicmlza19mYWN0b3JzLnBuZyIpKQpgYGAKIyMjIyMgW1tzb3VyY2VdXShodHRwczovL3d3dy5uY2JpLm5sbS5uaWguZ292L3BtYy9hcnRpY2xlcy9QTUM2MjQzNDQ2L3BkZi8xMC4xMTc3XzAwMzMzNTQ5MTg3OTkzNDQucGRmKXt0YXJnZXQ9Il9ibGFuayJ9IAoKCiMjICoqTGltaXRhdGlvbnMqKgoqKiogCgo8c3R5bGU+CmRpdi5ncmVlbiB7IGJhY2tncm91bmQtY29sb3I6IzkwRUU5MDsgYm9yZGVyLXJhZGl1czogNXB4OyBwYWRkaW5nOiAyMHB4O30KPC9zdHlsZT4KPGRpdiBjbGFzcyA9ICJncmVlbiI+CgoqKk1JQ0hBRUwgT05USVZFUk9TKioKCipJIGNvbXBhcmVkIHRoZSBtZWNoYW5pY3Mgb2YgaW1hZ2UgcHJvY2Vzc2luZyB0b29scyB0byBhIGJsYWNrIGJveCBwcm9jZXNzLiBJIGZlZWwgaXQgYnJpbmdzIGluIHNvbWUgdm9jYWIgd2hpbGUgaGlnaGxpZ2h0aW5nIHRoYXQgdGhpcyB0eXBlIG9mIHRvb2wgcmVxdWlyZXMgY2F1dGlvbi4gRmVlbCBmcmVlIHRvIHVwZGF0ZSBhcyB5b3UgdGhpbmsgYXBwcm9wcmlhdGUuKgo8L2Rpdj4KClRoZXJlIGFyZSBzb21lIGltcG9ydGFudCBjb25zaWRlcmF0aW9ucyByZWdhcmRpbmcgdGhpcyBkYXRhIGFuYWx5c2lzIHRvIGtlZXAgaW4gbWluZDogCgoxKSBUaGUgc3RhdGlzdGljYWwgcHJvY2VkdXJlcyB3ZSBhcmUgdXNpbmcgbWF5IGJlIG92ZXJseSBzaW1wbGlzdGljLiAqV2UgbmVlZCB0byBiZSB3YXJ5IGFib3V0IGRlcml2aW5nIG1lYW5pbmcgZnJvbSB0aGUgc3RhdGlzdGljYWwgcHJvY2VkdXJlcyB3ZSB1c2UqLiAKCjIpIFVzaW5nIGltYWdlIHByb2Nlc3NpbmcgdG9vbHMgY2FuIGJlIHZlcnkgaGVscGZ1bC4gVGhlIG1hbm5lciBpbiB3aGljaCBkYXRhIGlzIG9idGFpbmVkIHdpdGggaW1hZ2UgcHJvY2Vzc2luZyB0b29scyBpcyB3aGF0IHdlIHdvdWxkIGRlc2NyaWJlIGFzIGEgKipibGFjayBib3ggcHJvY2VzcyoqLCA8dT4qYSBwcm9jZXNzIHdpdGgga25vd24gaW5wdXRzIGFuZCBvdXRwdXRzIGJ1dCB1bmtub3duIG1lY2hhbmljcyo8L3U+LiBCZWNhdXNlIHdlIGFyZSB1bmF3YXJlIG9mIGhvdyBvdXIgb3V0cHV0cyBhcmUgZ2VuZXJhdGUgZnJvbSBvdXIgaW5wdXRzLCB3ZSBuZWVkIHRvIGJlIHdhcnkgb2YgdGhlIG91dHB1dC4gV2l0aCB0aGUgc21hbGwgb3V0cHV0IHdlIGFyZSBjcmVhdGluZyBpbiB0aGlzIGNhc2Ugc3R1ZHksIGEgdmlzdWFsIGluc3BlY3Rpb24gc2hvdWxkIHN1ZmZpY2UuIAoKIyMgKipXaGF0IGFyZSB0aGUgZGF0YT8qKgoqKiogCgpJbiB0aGlzIGNhc2Ugc3R1ZHkgd2Ugd2lsbCBiZSB1c2luZyBkYXRhIHJlbGF0ZWQgdG8geW91dGggZGlzY29ubmVjdGlvbiBmcm9tIHRoZSB0d28gZm9sbG93aW5nIHJlcG9ydHMgZnJvbSB0aGUgW01lYXN1cmUgb2YgQW1lcmljYV0oaHR0cHM6Ly93d3cuc3NyYy5vcmcvcHJvZ3JhbXMvdmlldy9tb2EvKXt0YXJnZXQ9Il9ibGFuayJ9ICBwcm9qZWN0OgoKPiBNZWFzdXJlIG9mIEFtZXJpY2EgaXMgYSBub25wYXJ0aXNhbiBwcm9qZWN0IG9mIHRoZSBub25wcm9maXQgW1NvY2lhbCBTY2llbmNlIFJlc2VhcmNoIENvdW5jaWxdKGh0dHBzOi8vd3d3LnNzcmMub3JnLyl7dGFyZ2V0PSJfYmxhbmsifSAgZm91bmRlZCBpbiAyMDA3IHRvIGNyZWF0ZSBlYXN5LXRvLXVzZSB5ZXQgbWV0aG9kb2xvZ2ljYWxseSBzb3VuZCB0b29scyBmb3IgdW5kZXJzdGFuZGluZyB3ZWxsLWJlaW5nIGFuZCBvcHBvcnR1bml0eSBpbiBBbWVyaWNhLiBUaHJvdWdoIHJlcG9ydHMsIGludGVyYWN0aXZlIGFwcHMsIGFuZCBjdXN0b20tYnVpbHQgZGFzaGJvYXJkcywgTWVhc3VyZSBvZiBBbWVyaWNhIHdvcmtzIHdpdGggcGFydG5lcnMgdG8gYnJlYXRoZSBsaWZlIGludG8gbnVtYmVycywgdXNpbmcgZGF0YSB0byBpZGVudGlmeSBhcmVhcyBvZiBoaWdoZXN0IG5lZWQsIHBpbnBvaW50IGxldmVycyBmb3IgY2hhbmdlLCBhbmQgdHJhY2sgcHJvZ3Jlc3Mgb3ZlciB0aW1lLgoKMS4gTGV3aXMsIEtyaXN0ZW4uIFtNYWtpbmcgdGhlIENvbm5lY3Rpb246IFRyYW5zcG9ydGF0aW9uIGFuZCBZb3V0aCBEaXNjb25uZWN0aW9uXShodHRwczovL3NzcmMtc3RhdGljLnMzLmFtYXpvbmF3cy5jb20vbW9hL01ha2luZyUyMHRoZSUyMENvbm5lY3Rpb24ucGRmKXt0YXJnZXQ9Il9ibGFuayJ9IC4gTmV3IFlvcms6IE1lYXN1cmUgb2YgQW1lcmljYSwgU29jaWFsIFNjaWVuY2UgUmVzZWFyY2ggQ291bmNpbCwgMjAxOS4gIChEYXRhIHVwIHRvIDIwMTcpCjIuIDogTGV3aXMsIEtyaXN0ZW4uIFtBIERlY2FkZSBVbmRvbmU6IFlvdXRoIERpc2Nvbm5lY3Rpb24gaW4gdGhlIEFnZSBvZiBDb3JvbmF2aXJ1c10oaHR0cHM6Ly9zc3JjLXN0YXRpYy5zMy5hbWF6b25hd3MuY29tL21vYS9BRGVjYWRlVW5kb25lLnBkZil7dGFyZ2V0PSJfYmxhbmsifSAuCk5ldyBZb3JrOiBNZWFzdXJlIG9mIEFtZXJpY2EsIFNvY2lhbCBTY2llbmNlIFJlc2VhcmNoIENvdW5jaWwsIDIwMjAuIChEYXRhIHVwIHRvIDIwMTgpCgoKIyMgKipEYXRhIEltcG9ydCoqCioqKiAKCk9uZSB3YXkgdG8gaW1wb3J0IGRhdGEgZnJvbSBhIHBkZiBpcyB0byB1c2UgdGhlICBgcGRmdG9vbHNgIHBhY2thZ2VzLiAKCkZyb20gdGhlIG91dHB1dCwgaXQncyBjbGVhciB0aGF0IGEgbGFyZ2UgYW1vdW50IG9mIG1hbmlwdWxhdGlvbiB3aWxsIGJlIHJlcXVpcmVkIHRvIHdyYW5nbGUgdGhpcyBkYXRhIHdpdGggdGhlIGBwZGZ0b29sc2AgcGFja2FnZS4KCiMjIyMgey5zY3JvbGxhYmxlIH0KYGBge3J9CnBkZl9kYXRhX2V4YW1wbGUgPC0gcGRmdG9vbHM6OnBkZl9kYXRhKGhlcmUoImRvY3MiLCAiTWFraW5nX3RoZV9Db25uZWN0aW9uLnBkZiIpKQoKdXRpbHM6OmhlYWQocGRmX2RhdGFfZXhhbXBsZSwgMSkKCnBkZl90b29sc19leGFtcGxlIDwtIHBkZnRvb2xzOjpwZGZfdGV4dChoZXJlKCJkb2NzIiwiTWFraW5nX3RoZV9Db25uZWN0aW9uLnBkZiIpKQoKaGVhZChwZGZfdG9vbHNfZXhhbXBsZSwgMSkKYGBgCiMjIyMKCldoaWxlIG5vdCBpbXBvc3NpYmxlLCBpdCdzIGhhcmQgbm90IHRvIGFyZ3VlIHRoYXQgdXNpbmcgdGhlIGBwZGZ0b29sc2AgcGFja2FnZSBpbiB0aGlzIHNjZW5hcmlvIHdpbGwgcmVxdWlyZSBhIGxvdCBvZiBhZHZhbmNlZCBkYXRhIHdyYW5nbGluZy4gV2hpbGUgb3VyIG91dHB1dCBtYXkgYmUgcmVwcm9kdWNpYmxlLCB0aGUgYW1vdW50IG9mIHRpbWUgdG8gYWNoaWV2ZSB0aGlzIHJlcHJvZHVjaWJpbGl0eSBtYXkgbm90IGJlIGFueSBtb3JlIGVmZmljaWVudCB0aGFuIHR5cGluZyB0aGUgdGFibGUgYnkgaGFuZCBpbnRvIGEgdGV4dCBvciBzcHJlYWRzaGVldCBwcm9ncmFtLgoKRm9ydHVuYXRlbHksIHRoZXJlIGlzIGFub3RoZXIgd2F5IHdlIGNhbiBwcm9jZWVkIHRvIHdyYW5nbGUgdGhlIGRhdGEuIAoKV2Ugd2lsbCBkZW1vbnN0cmF0ZSBob3cgdG8gcHJvZHVjZSByZXByb2R1Y2libGUgdGFibGVzIHdpdGggaW1hZ2UgcHJvY2Vzc2luZyBzb2Z0d2FyZSBpbiBgUmAuIAoKRm9yIGRlbW9uc3RyYXRpdmUgcHVycG9zZXMsIHdlIHdpbGwgaW1wb3J0IHR3byBzZXRzIG9mIGRhdGEuIFRoZSBmaXJzdCBzZXQgb2YgZGF0YSB3aWxsIGJlIHVzZWQgdG8gaGlnaGxpZ2h0IGNvbW1vbiBlcnJvcnMgdGhhdCB0aGUgaW1hZ2UgcHJvY2Vzc2luZyBzb2Z0d2FyZSBtYXkgcHJvZHVjZS4gVGhlIHNlY29uZCBzZXQgb2YgZGF0YSB3aWxsIGJlIHVzZWQgdG8gZGVtb25zdHJhdGUgaG93IHRvIGNpcmN1bXZlbnQgdGhlc2UgZXJyb3JzIGFuZCBwcm9kdWNlIHJlcHJvZHVjaWJsZSBkYXRhc2V0cyBlZmZpY2llbnRseS4KCldlIHdpbGwgbm93IGltcG9ydCB0aGUgZGF0YSB1c2luZyB0aGUgYG1hZ2lja2AgYW5kIGBoZXJlYCBwYWNrYWdlcy4gCgpgYGB7ciwgZHBpID0gMTAwMH0KI2JvbGQgaXMgY2F1c2luZyBpc3N1ZXMKaW1hZ2VfZXhhbXBsZSA8LSBtYWdpY2s6OmltYWdlX3JlYWQoaGVyZTo6aGVyZSgiaW1nIiwgImdlbmRlcl9yYWNlX2V0aG5pY2l0eS5wbmciKSkKCm1hZ2ljazo6aW1hZ2VfaW5mbyhpbWFnZV9leGFtcGxlKQpgYGAKCldlIGltcG9ydCB0aGUgc2FtZSBkYXRh4oCUdGhpcyB0aW1lIHdpdGhvdXQgcmVnaW9ucyBvZiB0aGUgdGFibGUgd2l0aG91dCBzcGVjaWFsIGZvcm1hdHRpbmfigJR1c2luZyB0aGUgYG1hZ2lja2AgYW5kIGBoZXJlYCBwYWNrYWdlcy4gCgpgYGB7ciwgZHBpID0gMTAwMH0KI2JvbGQgaXMgY2F1c2luZyBpc3N1ZXMKaW1hZ2UxIDwtIGltYWdlX3JlYWQoaGVyZSgiaW1nIiwgImdlbmRlcl9yYWNlX2V0aG5pY2l0eTIucG5nIikpCgptYWdpY2s6OmltYWdlX2luZm8oaW1hZ2UxKQpgYGAKCiMjICoqRGF0YSBFeHBsb3JhdGlvbiBhbmQgV3JhbmdsaW5nKioKKioqIAoKVGhlIGZpcnN0IGltYWdlIHdlIGltcG9ydGVkIGxvb2tzIGxpa2UgdGhpcy4gCgpgYGB7cn0KaW1hZ2VfZXhhbXBsZQpgYGAKClBhcnRzIG9mIHRoZSB0YWJsZSBkZXBpY3RlZCBpbiB0aGUgaW1hZ2UgYWJvdmUgY29udGFpbiBbKipuZXdsaW5lKipdKGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL05ld2xpbmU/b2xkZm9ybWF0PXRydWUpIGNoYXJhY3RlcnMuIEEgbmV3bGluZSBjaGFyYWN0ZXIgZGVub3RlcyB0aGUgZW5kIG9mIGEgbGluZSBvZiB0ZXh0IGFuZCB0aGUgc3RhcnQgb2YgYSBuZXcgbGluZSBvZiB0ZXh0LiAKClRoaXMgbWFrZXMgaXQgbW9yZSBkaWZmaWN1bHQgdG8gd3JhbmdsZSB0aGlzIHRhYmxlLiBXcmFuZ2xpbmcgdGhlIGRhdGEgdmlhIHJlZ3VsYXIgZXhwcmVzc2lvbnMgbWF5IGJlIHZlcnkgdGVkaW91cy4gSXQncyB1bmxpa2VseSB0aGF0IGltYWdlIHByb2Nlc3Npbmcgc29mdHdhcmUgY2FuIGhhbmRsZSB0aGUgbmV3bGluZSBjaGFyYWN0ZXJz4oCUb3IgYW55IG90aGVyIHNwZWNpYWwgY2hhcmFjdGVyc+KAlGNvcnJlY3RseS4KClVzaW5nIGBpbWFnZV9vY3IoKWAgYnkgYG1hZ2lja2Agb24gdGhlIGltYWdlIGFib3ZlIHdpbGwgcmVuZGVyIHNvbWUgZXJyb3JzIGluIHRoZSBmaXJzdCBmZXcgbGluZXMuIAoKYGBge3J9CmRmMSA8LSBtYWdpY2s6OmltYWdlX29jcihpbWFnZV9leGFtcGxlKQoKZGYxICU+JQogIGJhc2U6OnN0cnNwbGl0KCJcbiIpICU+JQogIGJhc2U6OnVubGlzdCgpICU+JQogIHRpYmJsZTo6YXNfdGliYmxlKCkKYGBgCgpJZiB3ZSByZW1vdmUgdGhlc2UgbGluZXMsIHNvbWUgbmV3IGVycm9ycyBlbWVyZ2UuIAoKYGBge3J9CmRmMSAlPiUKICAgIGJhc2U6OnN0cnNwbGl0KCJcbiIpICU+JQogIGJhc2U6OnVubGlzdCgpICU+JQogIHRpYmJsZTo6YXNfdGliYmxlKCkgJT4lCiAgZHBseXI6OnNsaWNlKC0oMTozKSkKYGBgCgpEYXRhIHdyYW5nbGluZyBpcyBub3QgYW4gZXhhY3Qgc2NpZW5jZS4gVGhlIGFwcHJvYWNoZXMgd2UgY2FuIHRha2UgYXJlIGV4dHJlbWVseSBkZXBlbmRlbnQgb24gdGhlIGRhdGEuIFdlIGNhbiBleHBsb2l0IHBhdHRlcm5zIGluIHRoZSBkYXRhIHRvIHJlbmRlciB0aGUgb3V0cHV0IHdlIGRlc2lyZS4gCgpXZSB3aWxsIG5vdyB1c2UgYSBjcm9wcGVkIHZlcnNpb24gb2YgdGhlIGltYWdlIGFib3ZlIHdpdGhvdXQgdGhlIHNwZWNpYWwgZm9ybWF0dGluZy4KCiMjIyMgey5zY3JvbGxhYmxlIH0KYGBge3IsIGRwaSA9IDEwMDB9CnJtKGRmMSkKCmltYWdlX2luZm8oaW1hZ2UxKQoKYmFzZTo6cHJpbnQoaW1hZ2UxKQoKZGYxIDwtIGltYWdlX29jcihpbWFnZTEpCgpkZjEgPC0gZGYxICU+JQogIHN0cnNwbGl0KCJcbiIpICU+JQogIHVubGlzdCgpICU+JQogIGFzX3RpYmJsZSgpCmBgYAojIyMjCgpXZSBoYXZlIHNldmVyYWwgc3RyaW5ncy4gRWFjaCBjZWxsIG9mIGRhdGEgaXMgb24gYSBzdHJpbmcgc2VwYXJhdGVkIGJ5IHNwYWNlLiAKCldlIHNlcGFyYXRlIGVhY2ggc3RyaW5nIGJ5IHNwYWNlLiAKCmBgYHtyfQpkZjEgPC0gZGYxICU+JQogIGRwbHlyOjpzZWxlY3QodmFsdWUpICU+JQogIHB1bGwodmFsdWUpICU+JQogIHN0cl9zcGxpdCgiICIpCmBgYAoKV2Ugc3BsaXQgdGhlIGRhdGFmcmFtZSBpbiB0d286IGEgbGFiZWxzIHNlY3Rpb24gYW5kIGEgImRhdGEiIHNlY3Rpb24gY29udGFpbmluZyB0aGUgaW5mb3JtYXRpb24gd2UgYXJlIGludGVyZXN0ZWQgaW4uIAoKSW4gdGhlIGZpcnN0IGhhbGYsIHdlIHJlbW92ZSBhbGwgZGlnaXRzIGFuZCBwdW5jdHVhdGlvbiB0byBlbnN1cmUgdGhhdCB3ZSBhcmUgbGVmdCB3aXRoIGNoYXJhY3RlciBsYWJlbHMuCgpJbiB0aGUgc2Vjb25kLWhhbGYsIHJlbW92ZSBjb21tYXMgYW5kIHBlcmlvZHMsIGNvbnZlcnRpbmcgdGhlIHJlc3VsdGluZyBzdHJpbmcgY2hhcmFjdGVyIGNsYXNzIHRvIG51bWVyaWMgYW5kIHNlbGVjdGl2ZWx5IG11bHRpcGx5aW5nIGNvbHVtbnMgdG8gcmVpbnRyb2R1Y2UgdGhlIGRlY2ltYWwgcG9pbnQgY29ycmVjdGx5IAoKYGBge3J9CmRmMWEgPC0gZGYxICU+JQogIHB1cnJyOjptYXAofmJhc2U6OnBhc3RlKC4sY29sbGFwc2UgPSAiIikpICU+JQogIHB1cnJyOjptYXAofmJhc2U6OmdzdWIoIltbOmRpZ2l0Ol1dK3xbWzpwdW5jdDpdXSsiLCAiIiwuKSkgJT4lCiAgYmFzZTo6ZG8uY2FsbChiYXNlOjpyYmluZCwuKSAlPiUKICBiYXNlOjpkYXRhLmZyYW1lKCkgJT4lCiAgZHBseXI6OnRpYmJsZSgpCgpkZjFiIDwtIG1hcChkZjEsIHRhaWwsIDgpICU+JQogIG1hcCh+Z3N1YigiWyxdK3xbLl0rIiwgIiIsLikpICU+JQogIGRvLmNhbGwocmJpbmQsLikgJT4lCiAgZGF0YS5mcmFtZSgpICU+JQogIGRwbHlyOjptdXRhdGVfaWYoYmFzZTo6aXMuY2hhcmFjdGVyLCBiYXNlOjphcy5udW1lcmljKSAlPiUKICBkcGx5cjo6bXV0YXRlX2F0KHZhcnMoLVg3KSwgfiAuICogMC4xKSAlPiUKICB0aWJibGUoKSAKCmJhc2U6OnJtKGRmMSkKYGBgCgpXZSBjb21iaW5lIHRoZSB0d28gc2VjdGlvbnMgb2YgZGF0YSB0byBjcmVhdGUgb3VyIGRhdGFmcmFtZSwgcmVtb3ZpbmcgYW5kIHRoZW4gYWRkaW5nIGNvbHVtbiBuYW1lcy4KCmBgYHtyfQpkZjEgPC0gZHBseXI6OmJpbmRfY29scyhkZjFhLAogICAgICAgICAgICAgICAgICAgICAgICBkZjFiKQoKYmFzZTo6bmFtZXMoZGYxKSA8LSBjKCkKCmNvbHVtbl9uYW1lcyA8LSBjKCJHcm91cCIsCiAgICAgICAgICAgICAgICAgICJQZXJjXzIwMDgiLAogICAgICAgICAgICAgICAgICAiUGVyY18yMDEwIiwKICAgICAgICAgICAgICAgICAgIlBlcmNfMjAxMiIsCiAgICAgICAgICAgICAgICAgICJQZXJjXzIwMTQiLAogICAgICAgICAgICAgICAgICAiUGVyY18yMDE2IiwKICAgICAgICAgICAgICAgICAgIlBlcmNfMjAxNyIsCiAgICAgICAgICAgICAgICAgICJOXzIwMTciLAogICAgICAgICAgICAgICAgICAiRGVsdGFfcGVyYyIpCgpiYXNlOjpjb2xuYW1lcyhkZjEpIDwtIGNvbHVtbl9uYW1lcwpgYGAKCldlIHJlbW92ZSBjb2x1bW5zIHdpdGggaW5mb3JtYXRpb24gd2UgZG9uJ3QgbmVlZCBhbmQgdXNlIHRoZSBjb21tbW9uIHBhdHRlcm4gaW4gdGhlIGNvbHVtbiBuYW1lcyB0byBjb252ZXJ0IHRoZSBkYXRhIGludG8gW2xvbmcvbmFycm93IGZvcm1hdF0oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvV2lkZV9hbmRfbmFycm93X2RhdGE/b2xkZm9ybWF0PXRydWUpLgoKYGBge3J9CmRmMSA8LSBkZjEgJT4lCiAgZHBseXI6OnNlbGVjdCgtTl8yMDE3LAogICAgICAgICAgICAgICAgLURlbHRhX3BlcmMpCgpkZjEgPC0gZGYxICU+JQogIHRpZHlyOjpwaXZvdF9sb25nZXIoY29scz1jb250YWlucygiUGVyY18iKSwKICAgICAgICAgICAgICAgICAgICAgIG5hbWVzX3RvID0gIlllYXIiLAogICAgICAgICAgICAgICAgICAgICAgdmFsdWVzX3RvID0gIlJhdGUiLAogICAgICAgICAgICAgICAgICAgICAgbmFtZXNfcHJlZml4ID0gIlBlcmNfIikgJT4lCiAgZHBseXI6Om11dGF0ZShZZWFyID0gYXMubnVtZXJpYyhZZWFyKSkKYGBgCgpXZSB1c2UgdGhlIGBkcGx5cjo6Y2FzZV93aGVuKClgIGFuZCBgc3RyaW5ncjo6c3RyX2RldGVjdCgpYCBmdW5jdGlvbiB0byBkZXRlY3QgcGF0dGVybnMgYW5kIGNyZWF0ZSBhbiBzZXBhcmF0ZSBjb2x1bW4gd2l0aCBnZW5kZXIgYW5kIHJhY2UgaW5mb3JtYXRpb24uCgpUaGUgdHdvIGNvbHVtbnMgY3JlYXRlZCBjb250YWluIGBUUlVFL0ZBTFNFYCBzdGF0ZW1lbnRzLiBUaGVzZSBhcmUgdGhlbiB1c2VkIHRvIGNyZWF0ZSBhIHRoaXJkIGNvbHVtbiB0aGF0IHdpbGwgYWxsb3cgdXMgdG8gc2VwYXJhdGUgdGhlIGRhdGEgYnkgaXRzIHN1bW1hcnkgbGV2ZWwuIAoKYGBge3J9CmRmMSA8LSBkZjEgJT4lCiAgbXV0YXRlKEdlbmRlciA9IGRwbHlyOjpjYXNlX3doZW4oc3RyaW5ncjo6c3RyX2RldGVjdChHcm91cCwgIkZlbWFsZSIpIH4gVFJVRSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cmluZ3I6OnN0cl9kZXRlY3QoR3JvdXAsICJNYWxlIikgfiBGQUxTRSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRSVUUgfiBOQSksCiAgICAgICAgIFJhY2UgPSBzdHJpbmdyOjpzdHJfcmVtb3ZlX2FsbChHcm91cCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdHRlcm4gPSBwYXN0ZShjKCJGZW1hbGUiLCJNYWxlIiwiVW5pdGVkU3RhdGVzIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sbGFwc2UgPSAifCIpKSkgJT4lCiAgbXV0YXRlKFJhY2UgPSBkcGx5cjo6bmFfaWYoUmFjZSwgIiIpKQoKZGYxIDwtIGRmMSAlPiUgCiAgbXV0YXRlKFR5cGUgPSBjYXNlX3doZW4oYmFzZTo6aXMubmEoR2VuZGVyKSAmIGJhc2U6OmlzLm5hKFJhY2UpIH4gIlVTIFRvdGFsIiwKICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlOjppcy5uYShHZW5kZXIpICYgIWJhc2U6OmlzLm5hKFJhY2UpIH4gIlJhY2UgVG90YWwiLAogICAgICAgICAgICAgICAgICAgICAgICAgICFiYXNlOjppcy5uYShHZW5kZXIpICYgYmFzZTo6aXMubmEoUmFjZSkgfiAiR2VuZGVyIFRvdGFsIiwKICAgICAgICAgICAgICAgICAgICAgICAgICBUUlVFIH4gIlN1Ymdyb3VwIFRvdGFsIikpCgpkZjEgPC0gZGYxICU+JQogIG11dGF0ZShHZW5kZXIgPSBjYXNlX3doZW4oc3RyX2RldGVjdChHcm91cCwgIkZlbWFsZSIpIH4gIkZlbWFsZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJfZGV0ZWN0KEdyb3VwLCAiTWFsZSIpIH4gIk1hbGUiKSkKYGBgCgpUaGUgY29sdW1ucyBvZiBgY2hhcmFjdGVyYCBjbGFzcyBjdXJyZW50bHkgY29udGFpbiB1cHBlciBhbmQgbG93ZXIgY2FzZSBjaGFyYWN0ZXJzLiBXZSB3YW50IHRvIGVuc3VyZSB0aGF0IHdlIHVzZSBhIGNhc2VzIGNvbnNpc3RlbnRseSB0byBlbnN1cmUgdGhhdCB0aGVyZSBhcmUgbm8gZXJyb3JzIGRyaXZlbiBieSBjYXNlLXNlbnNpdGl2ZSBmdW5jdGlvbiBkb3duc3RyZWFtLgoKVG8gZG8gdGhpcywgd2UgdXNlIHRoZSBgYmFzZTo6dG9fdXBwZXIoKWAgZnVuY3Rpb24uIFRoaXMgZnVuY3Rpb24gbWFrZXMgYWxsIGNoYXJhY3RlcnMgdXBwZXJjYXNlLgoKYGBge3J9CmRmMSA8LSBkZjEgJT4lIAogIG11dGF0ZV9pZihpcy5jaGFyYWN0ZXIsIHRvdXBwZXIpCmBgYAoKRmluYWxseSwgd2UgaG9tb2dlbml6ZSB0aGUgbGFiZWxzIGFzc2lnbmVkIGZvciBjZXJ0YWluIGdyb3VwcywgZmlsbCBpbiBtaXNzaW5nIChgTkFgKSB2YWx1ZXMgd2l0aCBhIHN0cmluZywgYW5kIHJlbW92ZSBjb2x1bW5zIHdlIG5vIGxvbmdlciBuZWVkIGZyb20gdGhlIGRhdGFmcmFtZS4gCgpgYGB7cn0KZGYxIDwtIGRmMSAlPiUKICBtdXRhdGUoUmFjZSA9IGNhc2Vfd2hlbihSYWNlID09ICJMQVRJTkEiIH4gIkxBVElOTy9BIiwKICAgICAgICAgICAgICAgICAgICAgICAgICBSYWNlID09ICJMQVRJTk8iIH4gIkxBVElOTy9BIiwKICAgICAgICAgICAgICAgICAgICAgICAgICBSYWNlID09ICJOQVRJVkVBTUVSSUNBTiIgfiAiTkFUSVZFIEFNRVJJQ0FOIiwKICAgICAgICAgICAgICAgICAgICAgICAgICBUUlVFIH4gUmFjZSkpICU+JQogIG11dGF0ZShHZW5kZXIgPSB0aWR5cjo6cmVwbGFjZV9uYShHZW5kZXIsICJBTEwiKSwKICAgICAgICAgUmFjZSA9IHRpZHlyOjpyZXBsYWNlX25hKFJhY2UsICJBTEwiKSkgJT4lCiAgZHBseXI6OnNlbGVjdCgtR3JvdXApCmBgYAoKV2UgY2FuIHJlcGVhdCB0aGlzIHByb2Nlc3MgZm9yIHRoZSBvdGhlciB0d28gdGFibGVzIGxpc3RlZCBvbiBwYWdlIDM5LgoKTGV0J3MgbG9vayBhdCB0aGUgdGFibGUgd2l0aG91dCB0aGUgc3BlY2lhbCBmb3JtYXR0aW5nLgoKYGBge3J9CmltYWdlMiA8LSBpbWFnZV9yZWFkKGhlcmUoImltZyIsICJhc2lhbl9zdWJncm91cHMucG5nIikpCmltYWdlMgpgYGAKCkFzIHlvdSBjYW4gc2VlLCB0aGVyZSBhcmUgZW1wdHkgc3BhY2VzLiBBY2NvcmRpbmcgdG8gdGhlIFBERiwgdGhlc2Ugc3BhY2VzIGFyZSBlbXB0eSB0byBkZW5vdGUgdGhhdCB0aGUgZXN0aW1hdGVzIGFyZSB1bnJlbGlhYmxlLgoKVGhpcyBtYXkgY2F1c2UgcHJvYmxlbXMuIFdoaXRlc3BhY2UgbXVzdCBiZSBoYW5kbGVkIGRpZmZlcmVudGx5LiBXZSBtYXkgbm90IHdhbnQgdG8gcHJvY2VzcyB0aGUgZW50aXJlIGltYWdlIGZvciB0aGlzIHJlYXNvbi4gCgpJbnN0ZWFkLCB3ZSBjYW4gdXNlIHNlcGFyYXRlIGltYWdlcyB0byBlbnN1cmUgYSBzaW1wbGVyIHByb2Nlc3MgbGlrZSB0aGF0IGFib3ZlLiAKCldlIHJlYWQgdGhlIHRocmVlIGltYWdlcy4gCmBgYHtyfQppbWFnZTJhIDwtIGltYWdlX3JlYWQoaGVyZSgiaW1nIiwgImFzaWFuX3N1Ymdyb3Vwc0EucG5nIikpCmltYWdlMmIgPC0gaW1hZ2VfcmVhZChoZXJlKCJpbWciLCAiYXNpYW5fc3ViZ3JvdXBzQi5wbmciKSkKaW1hZ2UyYyA8LSBpbWFnZV9yZWFkKGhlcmUoImltZyIsICJhc2lhbl9zdWJncm91cHNDLnBuZyIpKQoKbWFnaWNrOjppbWFnZV9pbmZvKGltYWdlMmEpCm1hZ2ljazo6aW1hZ2VfaW5mbyhpbWFnZTJiKQptYWdpY2s6OmltYWdlX2luZm8oaW1hZ2UyYykKYGBgCgpUaGUgaW1hZ2VzIGxvb2sgbGlrZSB0aGlzLgoKYGBge3J9CmltYWdlMmEKaW1hZ2UyYgppbWFnZTJjCmBgYAoKV2Ugc2F2ZSB0aGUgdGV4dCBmcm9tIHRoZSBpbWFnZXMgaW50byBvYmplY3RzLgoKYGBge3J9CmRmMmEgPC0gbWFnaWNrOjppbWFnZV9vY3IoaW1hZ2UyYSkKZGYyYiA8LSBtYWdpY2s6OmltYWdlX29jcihpbWFnZTJiKQpkZjJjIDwtIG1hZ2ljazo6aW1hZ2Vfb2NyKGltYWdlMmMpCmBgYAoKV2UgcHJvY2VzcyB0aGVzZSBvYmplY3RzIHNlcGFyYXRlbHkuIE5vdGUgdGhhdCB3ZSB1c2UgYSB2ZXJ5IHNpbWlsYXIgcHJvY2VzcyB0byB0aGF0IGVtcGxveWVkIGluIHRoZSB3cmFuZ2xpbmcgb2YgdGhlIHByZXZpb3VzIHRhYmxlLiAKCmBgYHtyfQpkZjJhIDwtIGRmMmEgJT4lCiAgc3Ryc3BsaXQoIlxuIikgJT4lCiAgdW5saXN0KCkgJT4lCiAgYXNfdGliYmxlKCkKCmRmMmIgPC0gZGYyYiAlPiUKICBzdHJzcGxpdCgiXG4iKSAlPiUKICB1bmxpc3QoKSAlPiUKICBhc190aWJibGUoKQoKZGYyYyA8LSBkZjJjICU+JQogIHN0cnNwbGl0KCJcbiIpICU+JQogIHVubGlzdCgpICU+JQogIGFzX3RpYmJsZSgpCmBgYAoKV2UgdGhlbiBjb21iaW5lIHRoZSBvYmplY3RzIHdpdGggdGhlIGBkcGx5cjo6YmluZF9yb3dzKClgIGZ1bmN0aW9uLgoKVGhlIHByb2Nlc3MgaXMgbm93IHZlcnkgc2ltaWxhciB0byB0aGUgcHJldmlvdXMgdGFibGUuCgo8c3R5bGU+CmRpdi5yZWQgeyBiYWNrZ3JvdW5kLWNvbG9yOiNmZmNjY2I7IGJvcmRlci1yYWRpdXM6IDVweDsgcGFkZGluZzogMjBweDt9Cjwvc3R5bGU+CjxkaXYgY2xhc3MgPSAicmVkIj4KCioqTUlDSEFFTCBPTlRJVkVST1MqKgoKKkkgdXNlZCBiYXNlIFIgdG8gcmVtb3ZlIHRoZSBmaXJzdCB0aHJlZSByb3dzIG9mIGEgZGF0YWZyYW1lIGluIHRoZSBmb2xsb3dpbmcgY2h1bmsuIEkgYW0gbm90IGF3YXJlIG9mIGEgdGlkeXZlcnNlIHNvbHV0aW9uIGZvciB0aGlzOyBJIGFtIHN1cmUgb25lIGV4aXN0cy4qCjwvZGl2PgoKYGBge3J9CmRmMiA8LSBiaW5kX3Jvd3MoZGYyYSwKICAgICAgICAgIGRmMmIsCiAgICAgICAgICBkZjJjKQoKZGYyIDwtIGRmMiAlPiUKICBkcGx5cjo6c2VsZWN0KHZhbHVlKSAlPiUKICBwdWxsKHZhbHVlKSAlPiUKICBzdHJfc3BsaXQoIiAiKQoKZGYyYiA8LSBtYXAoZGYyLCB0YWlsLCAyKSAlPiUKICBtYXAofmdzdWIoIlssXSt8Wy5dKyIsICIiLC4pKSAlPiUKICBkby5jYWxsKHJiaW5kLC4pICU+JQogIGRhdGEuZnJhbWUoKSAlPiUKICBtdXRhdGVfaWYoaXMuY2hhcmFjdGVyLCBhcy5udW1lcmljKSAlPiUKICBtdXRhdGVfYXQodmFycygtWDIpLCB+IC4gKiAwLjEpICU+JQogIHRpYmJsZSgpIAoKZGYyYSA8LSBkZjIgJT4lCiAgbWFwKH5wYXN0ZSguLGNvbGxhcHNlID0gIiIpKSAlPiUKICBtYXAofmdzdWIoIltbOmRpZ2l0Ol1dK3xbWzpwdW5jdDpdXSsiLCAiIiwuKSkgJT4lCiAgZG8uY2FsbChyYmluZCwuKSAlPiUKICBkYXRhLmZyYW1lKCkgJT4lCiAgdGliYmxlKCkKCmRmMiA8LSBiaW5kX2NvbHMoZGYyYSwgZGYyYikKCm5hbWVzKGRmMikgPC0gYygpCgpjb2x1bW5fbmFtZXMgPC0gYygiR3JvdXAiLAogICAgICAgICAgICAgICAgICAiUmF0ZSIsCiAgICAgICAgICAgICAgICAgICJOXzIwMTciKQoKY29sbmFtZXMoZGYyKSA8LSBjb2x1bW5fbmFtZXMKCmRmMiA8LSBkZjIgJT4lCiAgZHBseXI6OnNlbGVjdCgtTl8yMDE3KQoKZGYyIDwtIGRmMiAlPiUKICBkcGx5cjo6bXV0YXRlKFllYXIgPSAyMDE3KQoKZGYyIDwtIGRmMiAlPiUKICBtdXRhdGUoR2VuZGVyID0gY2FzZV93aGVuKHN0cl9kZXRlY3QoR3JvdXAsICJGZW1hbGUiKSB+IFRSVUUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJfZGV0ZWN0KEdyb3VwLCAiTWFsZSIpIH4gRkFMU0UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUUlVFIH4gTkEpLAogICAgICAgICBTdWJncm91cCA9IHN0cl9yZW1vdmVfYWxsKEdyb3VwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdHRlcm4gPSBwYXN0ZShjKCJGZW1hbGUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJNYWxlIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiQVNJQU4iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJBc2lhbiIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbGxhcHNlID0gInwiKSkpICU+JQogIG11dGF0ZShTdWJncm91cCA9IG5hX2lmKFN1Ymdyb3VwLCAiIikpCgpnbGltcHNlKGRmMikKCmRmMiA8LSBkZjJbLSgxOjMpLF0KCmRmMiA8LSBkZjIgJT4lIAogIG11dGF0ZShUeXBlID0gY2FzZV93aGVuKGlzLm5hKEdlbmRlcikgJiBpcy5uYShTdWJncm91cCkgfiAiQXNpYW4gVG90YWwiLAogICAgICAgICAgICAgICAgICAgICAgICAgIGlzLm5hKEdlbmRlcikgJiAhaXMubmEoU3ViZ3JvdXApIH4gIlN1Ymdyb3VwIFRvdGFsIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAhaXMubmEoR2VuZGVyKSAmIGlzLm5hKFN1Ymdyb3VwKSB+ICJHZW5kZXIgVG90YWwiLAogICAgICAgICAgICAgICAgICAgICAgICAgIFRSVUUgfiAiU3ViZ3JvdXAgVG90YWwiKSkKCmdsaW1wc2UoZGYyKQoKZGYyIDwtIGRmMiAlPiUKICBtdXRhdGUoR2VuZGVyID0gY2FzZV93aGVuKHN0cl9kZXRlY3QoR3JvdXAsICJGZW1hbGUiKSB+ICJGZW1hbGUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyX2RldGVjdChHcm91cCwgIk1hbGUiKSB+ICJNYWxlIikpCgpkZjIgPC0gZGYyICU+JSAKICBtdXRhdGVfaWYoaXMuY2hhcmFjdGVyLCB0b2xvd2VyKSAlPiUKICBtdXRhdGVfaWYoaXMuY2hhcmFjdGVyLCB0b3VwcGVyKQoKZGYyIDwtIGRmMiAlPiUKICBtdXRhdGUoR2VuZGVyID0gcmVwbGFjZV9uYShHZW5kZXIsICJBTEwiKSwKICAgICAgICAgU3ViZ3JvdXAgPSByZXBsYWNlX25hKFN1Ymdyb3VwLCAiQUxMIikpICU+JQogIGRwbHlyOjpzZWxlY3QoLUdyb3VwKSAlPiUKICBtdXRhdGUoU3ViZ3JvdXApCgpkZjIgPC0gZGYyICU+JQogIG11dGF0ZShTdWJncm91cCA9IGNhc2Vfd2hlbihTdWJncm91cCA9PSAiVFdPT1JNT1JFIiB+ICJUV08gT1IgTU9SRSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRSVUUgfiBTdWJncm91cCkpCmBgYAoKTm90ZSB0aGF0IHdlIHRvb2sgYSBwcm9jZXNzIHRoYXQgaGFkIHN1Y2Nlc3NmdWxseSB3b3JrZWQgZm9yIHVzIGFuZCBtb2RpZmllZCBpdCBzbGlnaHRseSBmb3Igc2VwYXJhdGUsIHNpbWlsYXJseS1zb3VyY2VkIGRhdGEuIAoKVGhpcyBpcyBhIGNvbW1vbiBhcHByb2FjaCBpbiBkYXRhIHNjaWVuY2UuIE9mdGVuLCB0aGUgZHVyYXRpb24gb2YgdGhlIHdyYW5nbGluZyBwcm9jZXNzIGNhbiBsaW1pdCB0aGUgZGVwdGggb2YgYW4gYW5hbHlzaXMgZm9yIHByYWN0aWNhbCByZWFzb25zLiBVc2luZyB0cmllZCBtZXRob2RzIGNhbiBoZWxwIHJlZHVjZSB0aGUgdGltZSBuZWVkZWQgdG8gd3JhbmdsZSBkYXRhIGFuZCBhbGxvdyB0aW1lIGZvciBvdGhlciBwYXJ0cyBvZiBhbiBhbmFseXNpcy4gCgpMZXQncyBhZGQgdGhlIDIwMTggZGF0YSBmb3IgdGhpcyBncm91cC4KCldlIGltcG9ydCB0aGUgaW1hZ2UuIAoKYGBge3J9CmltYWdlNSA8LSBpbWFnZV9yZWFkKGhlcmUoImltZyIsICJhc2lhbl9zdWJncm91cHNfMjAxOC5wbmciKSkKCmRmMl8yMDE4IDwtIG1hZ2ljazo6aW1hZ2Vfb2NyKGltYWdlNSkKYGBgCgpBcyB5b3UgY2FuIHNlZSwgd2UgaGF2ZSByZXBlYXRlZCBuZXdsaW5lcyAoYFxuYCkuIFdlIGNhbiByZW1vdmUgdGhlc2Ugd2l0aCBzb21lIHNpbXBsZXggcmVnZXguCgpgYGB7cn0KZGYyXzIwMTggPC0gZ3N1YignKFtcbl0pXFwxKycsCiAgICAgICAgICAgICAgICAgJ1xcMScsCiAgICAgICAgICAgICAgICAgZGYyXzIwMTgpCgpkZjJfMjAxOCA8LSBnc3ViKCJbWzpwdW5jdDpdXSsiLAogICAgICAgICAgICAgICAgICIiLAogICAgICAgICAgICAgICAgIGRmMl8yMDE4KQoKZGYyXzIwMTggPC0gZ3N1YigiIGkgIiwKICAgICAgICAgICAgICAgICAiIiwKICAgICAgICAgICAgICAgICBkZjJfMjAxOCkKYGBgCgpXZSBwcm9jZWVkLCBtYWtpbmcgc2xpZ2h0IG1vZGlmaWNhdGlvbnMgdG8gdGhlIHByb2Nlc3MgYXMgbmVlZGVkLgoKVGhlIGJvbGQgZm9udCBhcHBlYXJzIHRvIGhhdmUgY2F1c2VkIGEgdHlwb3MuIAoKYGBge3J9CmRmMl8yMDE4ICU+JQogIHN0cnNwbGl0KCJcbiIpICU+JQogIHVubGlzdCgpICU+JQogIGFzX3RpYmJsZSgpCmBgYAoKV2UgZml4IHRoZSB0eXBvcy4KCmBgYHtyfQpkZjJfMjAxOCA8LSBkZjJfMjAxOCAlPiUKICBzdHJzcGxpdCgiXG4iKSAlPiUKICB1bmxpc3QoKSAlPiUKICBnc3ViKCIgQjQ0ICIsIjU0IiwuKSAlPiUKICBnc3ViKCJXb21lbjc0IiwiV29tZW4gNzQiLC4pICU+JQogIGdzdWIoIkhNT05HMTAyIiwiSE1PTkcgMTAyIiwuKSAlPiUKICBhc190aWJibGUoKQoKZGYyXzIwMTggJT4lCiAgcHJpbnQoLixuID0gZGltKC4pWzFdKQpgYGAKCldlIHRoZW4gY29udGludWUgYXMgd2Ugd291bGQgbm9ybWFsbHkuIAoKYGBge3J9CmRmMl8yMDE4IDwtIGRmMl8yMDE4ICU+JQogIGRwbHlyOjpzZWxlY3QodmFsdWUpICU+JQogIHB1bGwodmFsdWUpICU+JQogIHN0cl9zcGxpdCgiICIpCgpkZjJfMjAxOCA8LSBsYXBwbHkoZGYyXzIwMTgsCiAgICAgICAgICAgICAgICAgICBmdW5jdGlvbih4KSB4W25jaGFyKHgpID49IDFdKQoKZGYyYV8yMDE4IDwtIGRmMl8yMDE4ICU+JQogIG1hcCh+cGFzdGUoLixjb2xsYXBzZSA9ICIiKSkgJT4lCiAgbWFwKH5nc3ViKCJbWzpkaWdpdDpdXSt8W1s6cHVuY3Q6XV0rIiwgIiIsLikpICU+JQogIGRvLmNhbGwocmJpbmQsLikgJT4lCiAgZGF0YS5mcmFtZSgpICU+JQogIHRpYmJsZSgpCgpkZjJiXzIwMTggPC0gbWFwKGRmMl8yMDE4LCB0YWlsLCAyKSAlPiUKICBkby5jYWxsKHJiaW5kLC4pICU+JQogIGRhdGEuZnJhbWUoKSAlPiUKICBtdXRhdGVfaWYoaXMuY2hhcmFjdGVyLCBhcy5udW1lcmljKSAlPiUKICBtdXRhdGVfYXQodmFycygtWDIpLCB+IC4gKiAwLjEpICU+JQogIHRpYmJsZSgpIAoKcm0oZGYyXzIwMTgpCiAgCmRmMl8yMDE4IDwtIGJpbmRfY29scyhkZjJhXzIwMTgsCiAgICAgICAgICAgICAgICAgICAgICBkZjJiXzIwMTgpCm5hbWVzKGRmMl8yMDE4KSA8LSBjKCkKCmNvbHVtbl9uYW1lcyA8LSBjKCJHcm91cCIsCiAgICAgICAgICAgICAgICAgICJSYXRlIiwKICAgICAgICAgICAgICAgICAgIk5fMjAxNyIpCgpjb2xuYW1lcyhkZjJfMjAxOCkgPC0gY29sdW1uX25hbWVzCgpkZjJfMjAxOCA8LSBkZjJfMjAxOCAlPiUKICBkcGx5cjo6c2VsZWN0KC1OXzIwMTcpCgpkZjJfMjAxOCA8LSBkZjJfMjAxOCAlPiUKICBkcGx5cjo6bXV0YXRlKFllYXIgPSAyMDE4KQoKZGYyXzIwMTggPC0gZGYyXzIwMTggJT4lCiAgbXV0YXRlKEdlbmRlciA9IGNhc2Vfd2hlbihzdHJfZGV0ZWN0KEdyb3VwLCAiV29tZW4iKSB+IFRSVUUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJfZGV0ZWN0KEdyb3VwLCAiTWVuIikgfiBGQUxTRSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRSVUUgfiBOQSkpCgpsYWJlbHMgPC0gdW5saXN0KGRmMl8yMDE4W2Moc2VxKDEsMTUsIGJ5PTMpLDE2LDE3KSwxXSwgdXNlLm5hbWVzID0gRkFMU0UpCgpkaW0oZGYyXzIwMTgpWzFdCgpsYWJlbHNfMyA8LSBjKHJlcChsYWJlbHNbMTo1XSwgZWFjaCA9IGRpbShkZjJfMjAxOClbMV0vKGxlbmd0aChsYWJlbHMpLTIpKSwKICAgICAgICAgICAgICAiSE1PTkciLAogICAgICAgICAgICAgICJDQU1CT0RJQU4iKQoKZGYyXzIwMTgkU3ViZ3JvdXAgPC0gbGFiZWxzXzMKCmRmMl8yMDE4IDwtIGRmMl8yMDE4ICU+JSAKICBtdXRhdGUoVHlwZSA9ICJTdWJncm91cCBUb3RhbCIpCgpnbGltcHNlKGRmMl8yMDE4KQoKZGYyXzIwMTggPC0gZGYyXzIwMTggJT4lCiAgbXV0YXRlKEdlbmRlciA9IGNhc2Vfd2hlbihHZW5kZXIgPT0gVFJVRSB+ICJGZW1hbGUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgR2VuZGVyID09IEZBTFNFIH4gIk1hbGUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgVFJVRSB+ICJBbGwiKSkKCmRmMl8yMDE4IDwtIGRmMl8yMDE4ICU+JSAKICBtdXRhdGVfaWYoaXMuY2hhcmFjdGVyLCB0b2xvd2VyKSAlPiUKICBtdXRhdGVfaWYoaXMuY2hhcmFjdGVyLCB0b3VwcGVyKQoKZGYyXzIwMTggPC0gZGYyXzIwMTggJT4lCiAgZHBseXI6OnNlbGVjdCgtR3JvdXApCmBgYAoKVGhlIGRhdGFmcmFtZSB3ZSBwcm9kdWNlZCBkb2VzIG5vdCBjb250YWluIHRvdGFscy4gCgpgYGB7cn0KZGYyXzIwMTggJT4lCiAgcHJpbnQoLiwgbiA9IGRpbSguKVsxXSkKYGBgCgpXZSBjYW4gZmluZCB0aGVzZSB0b3RhbHMgaW4gdGhlIFBERiBkaXJlY3RseSBhbmQgY3JlYXRlIHJvd3MgYXMgbmVlZGVkCgpXZSBsb2FkIHRoZSBQREYuCgpgYGB7cn0KZXhjZXJwdCA8LSBpbWFnZV9yZWFkKGhlcmUoImltZyIsICJhc2lhbl95b3V0aF9leGNlcnB0LnBuZyIpKQoKZXhjZXJwdApgYGAKCldlIGFkZCB0aGUgcm93cy4KCmBgYHtyfQpkZjJfMjAxOCA8LSBkZjJfMjAxOCAlPiUKICBhZGRfcm93KFJhdGUgPSA2LjIsCiAgICAgICAgICBZZWFyID0gMjAxOCwKICAgICAgICAgIEdlbmRlciA9ICJBTEwiLAogICAgICAgICAgU3ViZ3JvdXAgPSAiQUxMIiwgCiAgICAgICAgICBUeXBlID0gIkFTSUFOIFRPVEFMIikgJT4lCiAgYWRkX3JvdyhSYXRlID0gNi4xLAogICAgICAgICAgWWVhciA9IDIwMTgsCiAgICAgICAgICBHZW5kZXIgPSAiRkVNQUxFIiwKICAgICAgICAgIFN1Ymdyb3VwID0gIkFMTCIsIAogICAgICAgICAgVHlwZSA9ICJHRU5ERVIgVE9UQUwiKSAlPiUKICBhZGRfcm93KFJhdGUgPSA2LjQsCiAgICAgICAgICBZZWFyID0gMjAxOCwKICAgICAgICAgIEdlbmRlciA9ICJNQUxFIiwKICAgICAgICAgIFN1Ymdyb3VwID0gIkFMTCIsIAogICAgICAgICAgVHlwZSA9ICJHRU5ERVIgVE9UQUwiKQpgYGAKCmBgYHtyfQpkZjIgPC0gYmluZF9yb3dzKGRmMiwKICAgICAgICAgICAgICAgICBkZjJfMjAxOCkKYGBgCgpXZSByZXBlYXQgdGhpcyBwcm9jZXNzIGFnYWluIGZvciBMYXRpbm8vYSBzdWJncm91cHMuIAoKVGhlIHRhYmxlLCB3aXRob3V0IHRoZSBzcGVjaWFsIGZvcm1hdHRpbmcsIGxvb2tzIGxpa2UgdGhpcy4KCmBgYHtyfQppbWFnZTMgPC0gaW1hZ2VfcmVhZChoZXJlKCJpbWciLCAibGF0aW5vX2Ffc3ViZ3JvdXBzLnBuZyIpKQpgYGAKClRoZXJlIGFyZSBubyB3aGl0ZXNwYWNlcyBpbiB0aGlzIHRhYmxlLgoKV2UgcHJvY2VlZCB1c2luZyB3aGF0IHdlJ3ZlIGxlYXJuZWQgd2hpbGUgd3JhbmdsaW5nIHRoZSBmaXJzdCB0d28gdGFibGVzLgoKYGBge3J9CmRmMyA8LSBtYWdpY2s6OmltYWdlX29jcihpbWFnZTMpCgpkZjMgJT4lCiAgYmFzZTo6c3Ryc3BsaXQoIlxuIikgJT4lCiAgYmFzZTo6dW5saXN0KCkgJT4lCiAgdGliYmxlOjphc190aWJibGUoKQpgYGAKCldlIGFyZSBvZnRlbiBwcmVzZW50ZWQgd2l0aCBzY2VuYXJpb3Mgd2hlcmUgc3RhbmQtYWxvbmUgYXBwcm9hY2hlcyBhcmUgZGlmZmljdWx0IG9yIHRpbWUtY29uc3VtaW5nLgoKSXQgaXMgYWx3YXlzIGJlc3QgdG8gZG9jdW1lbnQgdGhlIHN0ZXBzIHRha2UgdG8gcmVzcG9uZCB0byB0aGVzZSBzY2VuYXJpb3MuIFdyYW5nbGluZyB0aGlzIHRoaXJkIHRhYmxlIGlzIGEgcHJpbWUgZXhhbXBsZSBvZiB0aGlzLiAKCldlIGFyZSBtaXNzaW5nIGEgcm93LiBMZXQncyBtYW51YWxseSBhZGQgdGhlIHJvdy4KCmBgYHtyfQpkZjMgPC0gZGYzICU+JQogIHN0cnNwbGl0KCJcbiIpICU+JQogIHVubGlzdCgpICU+JQogIGFzX3RpYmJsZSgpCgpkZjMgPC0gZGYzICU+JQogIHJiaW5kKCJQUiwgRFIsIEN1YmFuIDE1LjEgMjExLDIwMCIpCmBgYAoKV2UgY2FuIG5vdyBwcm9jZWVkIGFzIHdlIGRpZCB3aXRoIHRoZSBwcmV2aW91cyB0YWJsZXMuIAoKYGBge3J9CmRmMyA8LSBkZjMgJT4lCiAgZHBseXI6OnNlbGVjdCh2YWx1ZSkgJT4lCiAgcHVsbCh2YWx1ZSkgJT4lCiAgc3RyX3NwbGl0KCIgIikKCmRmM2IgPC0gbWFwKGRmMywgdGFpbCwgMikgJT4lCiAgbWFwKH5nc3ViKCJbLF0rfFsuXSsiLCAiIiwuKSkgJT4lCiAgZG8uY2FsbChyYmluZCwuKSAlPiUKICBkYXRhLmZyYW1lKCkgJT4lCiAgbXV0YXRlX2lmKGlzLmNoYXJhY3RlciwgYXMubnVtZXJpYykgJT4lCiAgbXV0YXRlX2F0KHZhcnMoLVgyKSwgfiAuICogMC4xKSAlPiUKICB0aWJibGUoKSAKCmRmM2EgPC0gZGYzICU+JQogIG1hcCh+cGFzdGUoLixjb2xsYXBzZSA9ICIiKSkgJT4lCiAgbWFwKH5nc3ViKCJbWzpkaWdpdDpdXSt8W1s6cHVuY3Q6XV0rIiwgIiIsLikpICU+JQogIGRvLmNhbGwocmJpbmQsLikgJT4lCiAgZGF0YS5mcmFtZSgpICU+JQogIHRpYmJsZSgpCgpybShkZjMpCiAgCmRmMyA8LSBiaW5kX2NvbHMoZGYzYSwgZGYzYikKbmFtZXMoZGYzKSA8LSBjKCkKCmNvbHVtbl9uYW1lcyA8LSBjKCJHcm91cCIsCiAgICAgICAgICAgICAgICAgICJSYXRlIiwKICAgICAgICAgICAgICAgICAgIk5fMjAxNyIpCgpjb2xuYW1lcyhkZjMpIDwtIGNvbHVtbl9uYW1lcwoKYGBgCgpJZiB3ZSBsb29rIGF0IHRoZSBsYXN0IGZldyByb3dzLCB3ZSBzZWUgdGhhdCB0aGVyZSBpcyBhIHR5cG8uIFRoZXJlIGFyZSB0d28gZmVtYWxlIGdyb3Vwcy4KCmBgYHtyfQp0YWlsKGRmMykKYGBgCgpTb21ldGltZXMgd2hlbiB3cmFuZ2xpbmcgdGV4dCBkYXRhLCB3ZSB3aWxsIGNvbWUgYWNyb3NzIGEgdHlwby4gV2UgbmVlZCB0byBkZXRlcm1pbmUgaG93IHRvIHJlc3BvbmQgdG8gdGhlIHR5cG8gYW5kIG1ha2Ugbm90ZSBvZiBpdC4gSXQncyBvZnRlbiBiZXN0IHRvIGNvbnN1bHQgYSBzZWNvbmRhcnkgc291cmNlIHRvIGNvbmZpcm0gdGhhdCBjaGFuZ2VzIG1hZGUgYXJlIGFjY3VyYXRlLiAKCkZvciB0aGUgcHVycG9zZXMgb2YgdGhpcyBjYXNlIHN0dWR5LCB3ZSB3aWxsIGFzc3VtZSB0aGF0IHRoZSBmaXJzdCBvZiB0aGUgdHdvIHJvd3MgcmVwcmVzZW50cyBtYWxlIGRpc2Nvbm5lY3Rpb24gcmF0ZXMgaW4gdGhlIExhdGluby9hIHN1Ymdyb3VwOyB0aGlzIHdvdWxkIGJlIGNvbnNpc3RlbnQgd2l0aCB0aGUgb3JkZXJpbmcgb2YgZ2VuZGVycyBpbiB0aGUgcHJldmlvdXMgc3ViZ3JvdXBzLiAKCkxldCdzIG1ha2UgdGhlIGNvcnJlY3Rpb24gdG8gdGhlIHR5cG8uCgpgYGB7cn0KZGYzIDwtIGRmMyAlPiUKICBtdXRhdGUoR3JvdXAgPSBjYXNlX3doZW4oR3JvdXAgPT0gIlBSRFJDdWJhbkZlbWFsZSIgJiBOXzIwMTcgPT0gMTE0NTAwIH4gIlBSRFJDdWJhbk1hbGUiLAogICAgICAgICAgICAgICAgICAgICAgICAgVFJVRSB+IEdyb3VwKSkKYGBgCgpJdCBsb29rcyBsaWtlIHdlJ3ZlIHN1Y2Nlc2Z1bGx5IGNvcnJlY3RlZCB0aGUgdHlwby4KCmBgYHtyfQp0YWlsKGRmMykKYGBgCgpXZSBjYW4gY29udGludWUgd2l0aCB0aGUgcHJvY2VzcyB3ZSd2ZSBkZXZlbG9wZWQgbm93IHRoYXQgd2UgaGF2ZSBtYWRlIHRoZSBjb3JyZWN0aW9uLgoKYGBge3J9CmRmMyA8LSBkZjMgJT4lCiAgZHBseXI6OnNlbGVjdCgtTl8yMDE3KQoKZGYzIDwtIGRmMyAlPiUKICBkcGx5cjo6bXV0YXRlKFllYXIgPSAyMDE3KQoKZGYzIDwtIGRmMyAlPiUKICBtdXRhdGUoR2VuZGVyID0gY2FzZV93aGVuKHN0cl9kZXRlY3QoR3JvdXAsICJGZW1hbGUiKSB+IFRSVUUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJfZGV0ZWN0KEdyb3VwLCAiTWFsZSIpIH4gRkFMU0UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUUlVFIH4gTkEpLAogICAgICAgICBTdWJncm91cCA9IHN0cl9yZW1vdmVfYWxsKEdyb3VwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdHRlcm4gPSBwYXN0ZShjKCJGZW1hbGUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJNYWxlIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTEFUSU5PIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTGF0aW5vIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTGF0aW5hIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sbGFwc2UgPSAifCIpKSkgJT4lCiAgbXV0YXRlKFN1Ymdyb3VwID0gbmFfaWYoU3ViZ3JvdXAsICIiKSkKCmdsaW1wc2UoZGYzKQoKZGYzIDwtIGRmMyAlPiUgCiAgbXV0YXRlKFR5cGUgPSBjYXNlX3doZW4oaXMubmEoR2VuZGVyKSAmIGlzLm5hKFN1Ymdyb3VwKSB+ICJMYXRpbm8vYSBUb3RhbCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgaXMubmEoR2VuZGVyKSAmICFpcy5uYShTdWJncm91cCkgfiAiU3ViZ3JvdXAgVG90YWwiLAogICAgICAgICAgICAgICAgICAgICAgICAgICFpcy5uYShHZW5kZXIpICYgaXMubmEoU3ViZ3JvdXApIH4gIkdlbmRlciBUb3RhbCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgVFJVRSB+ICJTdWJncm91cCBUb3RhbCIpKQoKZ2xpbXBzZShkZjMpCgpkZjMgPC0gZGYzICU+JQogIG11dGF0ZShHZW5kZXIgPSBjYXNlX3doZW4oc3RyX2RldGVjdChHcm91cCwgIkZlbWFsZSIpIH4gIkZlbWFsZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJfZGV0ZWN0KEdyb3VwLCAiTWFsZSIpIH4gIk1hbGUiKSkKCmRmMyA8LSBkZjMgJT4lIAogIG11dGF0ZV9pZihpcy5jaGFyYWN0ZXIsIHRvbG93ZXIpICU+JQogIG11dGF0ZV9pZihpcy5jaGFyYWN0ZXIsIHRvdXBwZXIpCgpkZjMgPC0gZGYzICU+JQogIG11dGF0ZShHZW5kZXIgPSByZXBsYWNlX25hKEdlbmRlciwgIkFMTCIpLAogICAgICAgICBTdWJncm91cCA9IHJlcGxhY2VfbmEoU3ViZ3JvdXAsICJBTEwiKSkgJT4lCiAgZHBseXI6OnNlbGVjdCgtR3JvdXApICU+JQogIG11dGF0ZShTdWJncm91cCkKCmRmMyA8LSBkZjMgJT4lCiAgbXV0YXRlKFN1Ymdyb3VwID0gY2FzZV93aGVuKFN1Ymdyb3VwID09ICJTT1VUSEFNRVJJQ0FOIiB+ICJTT1VUSCBBTUVSSUNBTiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFN1Ymdyb3VwID09ICJDRU5UUkFMQU1FUklDQU4iIH4gIkNFTlRSQUwgQU1FUklDQU4iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTdWJncm91cCA9PSAiUFJEUkNVQkFOIiB+ICJQUi9EUi9DVUJBTiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRSVUUgfiBTdWJncm91cCkpCmBgYAoKTGV0J3MgYWRkIHRoZSAyMDE4IGRhdGEgdG8gdGhpcyBkYXRhZnJhbWUuCgpXZSBpbXBvcnQgdGhlIGltYWdlLiAKCmBgYHtyfQppbWFnZTUgPC0gaW1hZ2VfcmVhZChoZXJlKCJpbWciLCAibGF0aW5vX2Ffc3ViZ3JvdXBzXzIwMTgucG5nIikpCgpkZjNfMjAxOCA8LSBtYWdpY2s6OmltYWdlX29jcihpbWFnZTUpCmBgYAoKQXMgeW91IGNhbiBzZWUsIHdlIGhhdmUgcmVwZWF0ZWQgbmV3bGluZXMgKGBcbmApLiBXZSBjYW4gcmVtb3ZlIHRoZXNlIHdpdGggc29tZSBzaW1wbGV4IHJlZ2V4LgoKYGBge3J9CmRmM18yMDE4IDwtIGdzdWIoJyhbXG5dKVxcMSsnLAogICAgICAgICAgICAgICAgICdcXDInLAogICAgICAgICAgICAgICAgIGRmM18yMDE4KQoKZGYzXzIwMTggPC0gZ3N1YigiW1s6cHVuY3Q6XV0rIiwKICAgICAgICAgICAgICAgICAiIiwKICAgICAgICAgICAgICAgICBkZjNfMjAxOCkKYGBgCgpXZSBwcm9jZWVkLCBtYWtpbmcgc2xpZ2h0IG1vZGlmaWNhdGlvbnMgdG8gdGhlIHByb2Nlc3MgYXMgbmVlZGVkLgoKYGBge3J9CmRmM18yMDE4IDwtIGRmM18yMDE4ICU+JQogIHN0cnNwbGl0KCJcbiIpICU+JQogIHVubGlzdCgpICU+JQogIGFzX3RpYmJsZSgpCgpkZjNfMjAxOCA8LSBkZjNfMjAxOCAlPiUKICBkcGx5cjo6c2VsZWN0KHZhbHVlKSAlPiUKICBwdWxsKHZhbHVlKSAlPiUKICBzdHJfc3BsaXQoIiAiKQoKZGYzXzIwMTggPC0gbGFwcGx5KGRmM18yMDE4LAogICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oeCkgeFtuY2hhcih4KSA+PSAxXSkKCmRmM2FfMjAxOCA8LSBkZjNfMjAxOCAlPiUKICBtYXAofnBhc3RlKC4sY29sbGFwc2UgPSAiIikpICU+JQogIG1hcCh+Z3N1YigiW1s6ZGlnaXQ6XV0rfFtbOnB1bmN0Ol1dKyIsICIiLC4pKSAlPiUKICBkby5jYWxsKHJiaW5kLC4pICU+JQogIGRhdGEuZnJhbWUoKSAlPiUKICB0aWJibGUoKQoKZGYzYl8yMDE4IDwtIG1hcChkZjNfMjAxOCwgdGFpbCwgMikgJT4lCiAgZG8uY2FsbChyYmluZCwuKSAlPiUKICBkYXRhLmZyYW1lKCkgJT4lCiAgbXV0YXRlX2lmKGlzLmNoYXJhY3RlciwgYXMubnVtZXJpYykgJT4lCiAgbXV0YXRlX2F0KHZhcnMoLVgyKSwgfiAuICogMC4xKSAlPiUKICB0aWJibGUoKSAKCnJtKGRmM18yMDE4KQogIApkZjNfMjAxOCA8LSBiaW5kX2NvbHMoZGYzYV8yMDE4LAogICAgICAgICAgICAgICAgICAgICAgZGYzYl8yMDE4KQpuYW1lcyhkZjNfMjAxOCkgPC0gYygpCgpjb2x1bW5fbmFtZXMgPC0gYygiR3JvdXAiLAogICAgICAgICAgICAgICAgICAiUmF0ZSIsCiAgICAgICAgICAgICAgICAgICJOXzIwMTciKQoKY29sbmFtZXMoZGYzXzIwMTgpIDwtIGNvbHVtbl9uYW1lcwoKZGYzXzIwMTggPC0gZGYzXzIwMTggJT4lCiAgZHBseXI6OnNlbGVjdCgtTl8yMDE3KQoKZGYzXzIwMTggPC0gZGYzXzIwMTggJT4lCiAgZHBseXI6Om11dGF0ZShZZWFyID0gMjAxOCkKCmRmM18yMDE4IDwtIGRmM18yMDE4ICU+JQogIG11dGF0ZShHZW5kZXIgPSBjYXNlX3doZW4oc3RyX2RldGVjdChHcm91cCwgIldvbWVuIikgfiBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyX2RldGVjdChHcm91cCwgIk1lbiIpIH4gRkFMU0UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUUlVFIH4gTkEpKQoKbGFiZWxzIDwtIHVubGlzdChkZjNfMjAxOFtzZXEoMSwxMiwgYnkgPTMpLDFdLCB1c2UubmFtZXMgPSBGQUxTRSkKCmRpbShkZjNfMjAxOClbMV0KCmxhYmVsc18zIDwtIHJlcChsYWJlbHMsIGVhY2ggPSBkaW0oZGYzXzIwMTgpWzFdL2xlbmd0aChsYWJlbHMpKQoKZGYzXzIwMTgkU3ViZ3JvdXAgPC0gbGFiZWxzXzMKCmRmM18yMDE4IDwtIGRmM18yMDE4ICU+JSAKICBtdXRhdGUoVHlwZSA9ICJTdWJncm91cCBUb3RhbCIpCgpnbGltcHNlKGRmM18yMDE4KQoKZGYzXzIwMTggPC0gZGYzXzIwMTggJT4lCiAgbXV0YXRlKEdlbmRlciA9IGNhc2Vfd2hlbihHZW5kZXIgPT0gVFJVRSB+ICJGZW1hbGUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgR2VuZGVyID09IEZBTFNFIH4gIk1hbGUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgVFJVRSB+ICJBbGwiKSkKCmRmM18yMDE4IDwtIGRmM18yMDE4ICU+JSAKICBtdXRhdGVfaWYoaXMuY2hhcmFjdGVyLCB0b2xvd2VyKSAlPiUKICBtdXRhdGVfaWYoaXMuY2hhcmFjdGVyLCB0b3VwcGVyKQoKZGYzXzIwMTggPC0gZGYzXzIwMTggJT4lCiAgZHBseXI6OnNlbGVjdCgtR3JvdXApCgpkZjNfMjAxOCA8LSBkZjNfMjAxOCAlPiUKICBtdXRhdGUoU3ViZ3JvdXAgPSBjYXNlX3doZW4oU3ViZ3JvdXAgPT0gIlNPVVRIQU1FUklDQU4iIH4gIlNPVVRIIEFNRVJJQ0FOIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3ViZ3JvdXAgPT0gIkNFTlRSQUxBTUVSSUNBTiIgfiAiQ0VOVFJBTCBBTUVSSUNBTiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFN1Ymdyb3VwID09ICJQUkRSQ1VCQU4iIH4gIlBSL0RSL0NVQkFOIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVFJVRSB+IFN1Ymdyb3VwKSkKYGBgCgpXZSBsb2FkIHRoZSBQREYuCgpgYGB7cn0Kcm0oZXhjZXJwdCkKZXhjZXJwdCA8LSBpbWFnZV9yZWFkKGhlcmUoImltZyIsICJsYXRpbm9fYV95b3V0aF9leGNlcnB0LnBuZyIpKQoKZXhjZXJwdApgYGAKCldlIGFkZCB0aGUgcm93cy4KCmBgYHtyfQpkZjNfMjAxOCA8LSBkZjNfMjAxOCAlPiUKICBhZGRfcm93KFJhdGUgPSAxMi44LAogICAgICAgICAgWWVhciA9IDIwMTgsCiAgICAgICAgICBHZW5kZXIgPSAiQUxMIiwKICAgICAgICAgIFN1Ymdyb3VwID0gIkFMTCIsIAogICAgICAgICAgVHlwZSA9ICJMQVRJTk8vQSBUT1RBTCIpICU+JQogIGFkZF9yb3coUmF0ZSA9IDEzLjMsCiAgICAgICAgICBZZWFyID0gMjAxOCwKICAgICAgICAgIEdlbmRlciA9ICJGRU1BTEUiLAogICAgICAgICAgU3ViZ3JvdXAgPSAiQUxMIiwgCiAgICAgICAgICBUeXBlID0gIkdFTkRFUiBUT1RBTCIpICU+JQogIGFkZF9yb3coUmF0ZSA9IDEyLjMsCiAgICAgICAgICBZZWFyID0gMjAxOCwKICAgICAgICAgIEdlbmRlciA9ICJNQUxFIiwKICAgICAgICAgIFN1Ymdyb3VwID0gIkFMTCIsIAogICAgICAgICAgVHlwZSA9ICJHRU5ERVIgVE9UQUwiKQpgYGAKCldlIGFkZCB0aGUgMjAxOCBkYXRhIHRvIHRoZSBkYXRhZnJhbWUKCmBgYHtyfQpkZjMgPC0gYmluZF9yb3dzKGRmMywKICAgICAgICAgICAgICAgICBkZjNfMjAxOCkKYGBgCgojIyMgTWFwCgpXZSB3aWxsIHVzZSBtdWx0aXBsZSBpbWFnZXMgdG8gaW1wb3J0IHRoZSBkYXRhIG9uIHBhZ2UgMzYgdG8gcHJvZHVjZSBtYXBzLiAKCjxzdHlsZT4KZGl2LnJlZCB7IGJhY2tncm91bmQtY29sb3I6I2ZmY2NjYjsgYm9yZGVyLXJhZGl1czogNXB4OyBwYWRkaW5nOiAyMHB4O30KPC9zdHlsZT4KPGRpdiBjbGFzcyA9ICJyZWQiPgoKKipNSUNIQUVMIE9OVElWRVJPUyoqCgoqVGhpcyBjb2RlIGlzIG5vdCBjb21wbGV0ZS4gSWYgdGhlcmUgaXMgdGltZSwgd2Ugd2lsbCByZXR1cm4gdG8gaXQhIE1hZ2ljayBpcyBoYXZpbmcgdHJvdWJsZSB3aXRoIHF1YWRyYW50IDEgYW5kIDQuIEkgY291bGQgbm90IGZpZ3VyZSBvdXQgd2h5LioKPC9kaXY+CgpgYGB7ciwgZXZhbD1GQUxTRX0KcXVhZHJhbnQxIDwtIGltYWdlX3JlYWQoaGVyZSgiaW1nIiwgInN0YXRlX3F1YWRyYW50MS5wbmciKSkKcXVhZHJhbnQyIDwtIGltYWdlX3JlYWQoaGVyZSgiaW1nIiwgInN0YXRlX3F1YWRyYW50Mi5wbmciKSkKcXVhZHJhbnQzIDwtIGltYWdlX3JlYWQoaGVyZSgiaW1nIiwgInN0YXRlX3F1YWRyYW50My5wbmciKSkKcXVhZHJhbnQ0IDwtIGltYWdlX3JlYWQoaGVyZSgiaW1nIiwgInN0YXRlX3F1YWRyYW50NC5wbmciKSkKCnF1YWRyYW50MSA8LSBtYWdpY2s6OmltYWdlX29jcihxdWFkcmFudDEpCnF1YWRyYW50MiA8LSBtYWdpY2s6OmltYWdlX29jcihxdWFkcmFudDIpCnF1YWRyYW50MyA8LSBtYWdpY2s6OmltYWdlX29jcihxdWFkcmFudDMpCnF1YWRyYW50NCA8LSBtYWdpY2s6OmltYWdlX29jcihxdWFkcmFudDQpCgpsYWJlbHNfcXVhZDFfMyA8LSBwYXN0ZTAocXVhZHJhbnQxLCBxdWFkcmFudDMpCmxhYmVsc19xdWFkMl80IDwtIHBhc3RlMChxdWFkcmFudDIsIHF1YWRyYW50NCkKCmxhYmVsc19xdWFkMV8zIDwtIGxhYmVsc19xdWFkMV8zICU+JQogIHN0cnNwbGl0KCJcbiIpICU+JQogIHVubGlzdCgpICU+JQogIGFzX3RpYmJsZSgpCgpsYWJlbHNfcXVhZDJfNCA8LSBsYWJlbHNfcXVhZDJfNCAlPiUKICBzdHJzcGxpdCgiXG4iKSAlPiUKICB1bmxpc3QoKSAlPiUKICBhc190aWJibGUoKQoKZGYxIDwtIGRmMSAlPiUKICBkcGx5cjo6c2VsZWN0KHZhbHVlKSAlPiUKICBwdWxsKHZhbHVlKSAlPiUKICBzdHJfc3BsaXQoIiAiKQpgYGAKCmBgYHtyLCBldmFsPSBGQUxTRX0KZGF0YV9tYXAgPC0gbWFwX2RhdGEoInN0YXRlIikgJT4lCiAgZmlsdGVyKHJlZ2lvbj09ImNhbGlmb3JuaWEiKQoKeWVhcnMgPC0gYyhzZXEoMjAwOCwyMDE2LGJ5PTIpLDIwMTcpCgppbmRleF9yZXAgPC0gZGltKGRhdGFfbWFwKVsxXQoKZGF0YV9tYXAgPC0gYmluZF9yb3dzKHJlcGxpY2F0ZShsZW5ndGgoeWVhcnMpLCBkYXRhX21hcCwgc2ltcGxpZnkgPSBGQUxTRSkpCgpkYXRhX21hcCR5ZWFyIDwtIHJlcCh5ZWFycywgZWFjaCA9IGluZGV4X3JlcCkKCmRhdGFfbWFwIDwtIGRhdGFfbWFwICU+JQogIGdyb3VwX2J5KHJlZ2lvbiwgeWVhcikgJT4lCiAgbXV0YXRlKHJhbmtfcmFuID0gcmFuayh5ZWFyLCB0aWVzLm1ldGhvZCA9ICJyYW5kb20iKSkKCmRhdGFfbWFwIDwtIGRhdGFfbWFwW29yZGVyKGRhdGFfbWFwJG9yZGVyKSxdCgpsaWJyYXJ5KGdnYW5pbWF0ZSkKCmdncGxvdChkYXRhX21hcCwgYWVzKHggPSBsb25nLCB5ID0gbGF0LCBncm91cCA9IGdyb3VwLCBmaWxsPXJhbmtfcmFuKSkgKwogIGdlb21fcG9seWdvbigpICsKICB0cmFuc2l0aW9uX3RpbWUodGltZSA9IHllYXIpCgpgYGAKCiMjICoqRGF0YSBBbmFseXNpcyoqCioqKiAKCioqUmVwZWF0ZWQgQ3Jvc3Mtc2VjdGlvbmFsIERhdGEqKgoKV2UgaGF2ZSBwb29sZWQgKHJlcGVhdGVkKSBbY3Jvc3Mtc2VjdGlvbmFsXShodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9Dcm9zcy1zZWN0aW9uYWxfZGF0YT9vbGRmb3JtYXQ9dHJ1ZSkgZGF0YS4KClRoaXMgaXMgZGF0YSBwcm9kdWNlZCBmcm9tIHJlcGVhdGVkIG1lYXN1cmVtZW50IG9mIGEgW3BvcHVsYXRpb25dKGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL1BvcHVsYXRpb24/b2xkZm9ybWF0PXRydWUpIG92ZXIgdGltZS4KCkl0IGlzIG9mdGVuIGluZmVhc2libGUgdG8gY29sbGVjdCBkYXRhIGZvciBhbiBlbnRpcmUgcG9wdWxhdGlvbiBhdCBvbmNlLiBIb3dldmVyLCB3ZSBjYW4gc3RpbGwgb2J0YWluIG1lYW5pbmdmdWwgbWVhc3VyZXMgdXNpbmcgYSByYW5kb20gW3NhbXBsZV0oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvU2FtcGxpbmdfKHN0YXRpc3RpY3MpP29sZGZvcm1hdD10cnVlKSBvZiB0aGUgcG9wdWxhdGlvbi4gCgpBdCBzcGVjaWZpYyB0aW1lLXBvaW50cywgZGF0YSBpcyBjb2xsZWN0ZWQgZnJvbSBhIHNhbXBsZSBvZiB0aGUgcG9wdWxhdGlvbi4gVGhlIGluZGl2aWR1YWxzIGluIGVhY2ggc2FtcGxlIGFyZSBub3QgbmVjZXNzYXJpbHkgdGhlIHNhbWUgaW5kaXZpZHVhbHMuIFRoaXMgc2VwYXJhdGVzIHBvb2xlZCBjcm9zcy1zZWN0aW9uYWwgZGF0YSBmcm9tIHBhbmVsIGRhdGEsIHdoaWNoIGlzIGxvbmdpdHVkaW5hbCBkYXRhIGZyb20gcmVwZWF0ZWQgbWVhc3VyZW1lbnQgb2YgdGhlIHNhbWUgcGVvcGxlLiAgIAoKQnkgc2FtcGxpbmcgZnJvbSBhIHBvcHVsYXRpb24gYXQgbXVsdGlwbGUgdGltZSBwb2ludHMsIHdlIGNhbiBnZW5lcmF0ZSBwb3B1bGF0aW9uIGxldmVsIHN0YXRpc3RpY3MuIEFsdGhvdWdoIHRoZXNlIHN0YXRpc3RpY3MgaGF2ZSBzb21lIHJhbmRvbSBlcnJvciwgdGhleSBjYW4gcHJvdmlkZSBpbnNpZ2h0IGludG8gaG93IHRoZSBtZWFzdXJlIHZhcmlhYmxlIGlzIGNoYW5naW5nIGluIGEgcG9wdWxhdGlvbiBvdmVyIHRpbWUuCgpXZSBjYW4gYWNjb21wbGlzaCB0aGlzIGJ5IHBsb3R0aW5nIHRoZSBtZWFzdXJlZCB2YWx1ZXMgb3ZlciB0aW1lLiBTb21ldGltZXMsIGhvd2V2ZXIsIHRoZSB0cmVuZCBpc24ndCBleGFjdGx5IGNsZWFyLiBGb3J0dW5hdGVseSwgdGhlcmUgYXJlIHN0YXRpc3RpY2FsIG1ldGhvZHMgdG8gcmVzb2x2ZSB0aGlzIGlzc3VlLgoKVGhlIE1hbm4tS2VuZGFsbCB0cmVuZCB0ZXN04oCUYSB2YXJpYXRpb24gb2YgdGhlIFtLZW5kYWxsIHJhbmsgY29ycmVsYXRpb24gY29lZmZpY2llbnRdKGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0tlbmRhbGxfcmFua19jb3JyZWxhdGlvbl9jb2VmZmljaWVudD9vbGRmb3JtYXQ9dHJ1ZSnigJR0ZXN0cyB3aGV0aGVyIHRoZXJlIGlzIGEgbW9ub3RvbmljIGFzc29jaWF0aW9uLCBhbiBhc3NvY2lhdGlvbiB0aGF0IGRvZXMgbm90IGluY3JlYXNlIG9yIGRlY3JlYXNlIGJ1dCByZW1haW5zIHN0YXRpYyBhY3Jvc3MgYSBkaW1lbnNpb24uCgpSZWNhbGwgdGhlIHlvdXRoIGRpc2Nvbm5lY3Rpb24gcmF0ZXMgZm9yIE5hdGl2ZSBBbWVyaWNhbnMsIHNvbWUgb2YgdGhlIGhpZ2hlc3QgaW4gdGhlIGZpcnN0IHRhYmxlIHdlIGV4YW1pbmVkLiAKCmBgYHtyfQppbWFnZV9leGFtcGxlCmBgYAoKTGV0J3MgY29uZHVjdCBhIE1hbm4tS2VuZGFsbCB0ZXN0IGZvciB0cmVuZC4KCldlIGNhbiBhY2NvbXBsaXNoIHRoaXMgd2l0aCB0aGUgYEtlbmRhbGw6Ok1hbm5LZW5kYWxsKClgIGZ1bmN0aW9uLiBUaGUgYEtlbmRhbGw6Ok1hbm5LZW5kYWxsKClgIGFjY2VwdHMgYSB2ZWN0b3Igb2YgZGF0YSBmb3Igd2hpY2ggYSB0cmVuZCBtYXkgYmUgb2JzZXJ2ZWQuIFtDb25zdWx0aW5nIHRoZSBkb2N1bWVudGF0aW9uIGZvciB0aGUgYEtlbmRhbGw6Ok1hbm5LZW5kYWxsKClgIGZ1bmN0aW9uIGF2YWlsYWJsZSBvbiBDUkFOXShodHRwczovL3JkcnIuaW8vY3Jhbi9LZW5kYWxsL21hbi9NYW5uS2VuZGFsbC5odG1sKSwgd2UgY2FuICJ0ZXN0IGZvciBhIGEgbW9ub3RvbmljIHRyZW5kIGluIGEgdGltZSBzZXJpZXMiLgoKYGBge3J9CmRmMSAlPiUKICBmaWx0ZXIoR2VuZGVyID09ICJBTEwiLAogICAgICAgICBSYWNlID09ICJOQVRJVkUgQU1FUklDQU4iKSAlPiUKICBwdWxsKFJhdGUpICU+JQogIE1hbm5LZW5kYWxsKC4pICU+JQogIHN1bW1hcnkoKQpgYGAKClRoZXJlIGRvZXMgbm90IGFwcGVhciB0byBiZSBhIGNoYW5nZSBpbiB0aGUgdHJlbmQuIEhvd2V2ZXIsIGl0J3MgaW1wb3J0YW50IHRvIG5vdGUgdGhhdCB3ZSBvbmx5IGhhdmUgYHIgbGVuZ3RoKGRmMSAlPiUgZmlsdGVyKEdlbmRlciA9PSAiQUxMIiwgUmFjZSA9PSAiTkFUSVZFIEFNRVJJQ0FOIikgJT4lIHB1bGwoUmF0ZSkpYCBvYnNlcnZhdGlvbnMuCgpXZSBjYW4gYWxzbyBleHBsb3JlIHRoZSB0cmVuZCB1c2luZyBbc2ltcGxlIGxpbmVhciByZWdyZXNzaW9uXShodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9TaW1wbGVfbGluZWFyX3JlZ3Jlc3Npb24/b2xkZm9ybWF0PXRydWUpLiAKCmBgYHtyfQpkZjEgJT4lCiAgZmlsdGVyKEdlbmRlciA9PSAiQUxMIiwKICAgICAgICAgUmFjZSA9PSAiTkFUSVZFIEFNRVJJQ0FOIikgJT4lCiAgbG0oUmF0ZSB+IFllYXIsIGRhdGEgPSAuKSAlPiUKICBzdW1tYXJ5KCkKYGBgCgpGb3IgZWFjaCBvbmUgeWVhciBjaGFuZ2UsIHRoZSBtZWFuIGluY3JlYXNlIGluIGRpc2Nvbm5lY3Rpb24gcmF0ZXMgaXMgYHIgKGRmMSAlPiUgZmlsdGVyKEdlbmRlciA9PSAiQUxMIiwgUmFjZSA9PSAiTkFUSVZFIEFNRVJJQ0FOIikgJT4lIGxtKFJhdGUgfiBZZWFyLCBkYXRhID0gLikpW1siY29lZmZpY2llbnRzIl1dWyJZZWFyIl1gLiBUaGlzIHJlbGF0aW9uc2hpcCBpcyBub3Qgc3RhdGlzdGljYWxseSBzaWduaWZpY2FudC4gQWdhaW4sIHdlIGFyZSBsYXJnZWx5IGxpbWl0ZWQgYnkgdGhlIG51bWJlciBvZiBvYnNlcnZhdGlvbnMgaW4gdGhpcyBkYXRhc2V0LiAKCldlIGNhbiB2aXN1YWxpemUgdGhlIHJlbGF0aW9uc2hpcCBhYm92ZS4KCmBgYHtyfQpkZjEgJT4lCiAgZmlsdGVyKEdlbmRlciA9PSAiQUxMIiwKICAgICAgICAgUmFjZSA9PSAiTkFUSVZFIEFNRVJJQ0FOIikgJT4lCiAgZ2dwbG90KGFlcyh4ID0gWWVhciwgeSA9IFJhdGUpKSArCiAgZ2VvbV9zbW9vdGgobWV0aG9kID0gImxtIiwgY29sb3IgPSAicmVkIikgKyAKICBnZW9tX3BvaW50KCkgKyAKICBzY2FsZV94X2NvbnRpbnVvdXMoYnJlYWtzID0gc2VxKDIwMDgsIDIwMTgsIGJ5ID0gMSksCiAgICAgICAgICAgICAgICAgICAgIGxhYmVscyA9IHNlcSgyMDA4LCAyMDE4LCBieSA9IDEpLAogICAgICAgICAgICAgICAgICAgICBsaW1pdHMgPSBjKDIwMDgsIDIwMTgpKSArCiAgdGhlbWVfbWluaW1hbCgpICsKICBsYWJzKHRpdGxlID0gIllvdXRoIERpc2Nvbm5lY3Rpb24gUmF0ZXMgb2YgTmF0aXZlIEFtZXJpY2FuIFlvdXRoIiwKICAgICAgIHN1YnRpdGxlID0gIjIwMDggLSAyMDE3IiwKICAgICAgIHggPSAiWWVhciIsCiAgICAgICB5ID0gIkRpc2Nvbm5lY3Rpb24gUmF0ZSIpCmBgYAoKQXMgd2UgY2FuIHNlZSwgdGhlcmUgaXMgYSBsYXJnZSBhbW91bnQgb2YgdW5jZXJ0YWludHkgYXJvdW5kIHRoZSBmaXR0ZWQgbGluZS4gCgpMZXQncyB2aXN1YWxpemUgdGhlIGRhdGEhIAoKIyMgKipEYXRhIFZpc3VhbGl6YXRpb24qKgoqKiogCgpMZXQncyByZXByb2R1Y2UgdGhlIGV4YW1wbGUgYmVsb3cuCgpgYGB7ciwgb3V0LndpZHRoID0gIjEwMCUiLCBlY2hvID0gRkFMU0UsIGZpZy5hbGlnbiA9ImNlbnRlciJ9CmluY2x1ZGVfZ3JhcGhpY3MoaGVyZTo6aGVyZSgiaW1nIiwgIk1ha2luZ190aGVfQ29ubmVjdGlvbl9wbG90LnBuZyIpKQpgYGAKCldlIGNhbiBjcmVhdGUgYSB2ZXJzaW9uIG9mIHRoZSBhYm92ZSBleGFtcGxlIHdpdGggYGdncGxvdGAgZnJvbSBgdGlkeXZlcnNlYC4KClRoZXJlIGFyZSBjb2xvciBpZGVudGlmeWluZyB3ZWJzaXRlcyBvbmx5IHN1Y2ggYXMgW3RoaXNdKGh0dHBzOi8vaW1hZ2Vjb2xvcnBpY2tlci5jb20vZW4vKS4KClVzaW5nIG9uZSBvZiB0aGVzZSB3ZWJzaXRlcywgd2UgaWRlbnRpZnkgdGhlIFtoZXggdHJpcGxldF0oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvV2ViX2NvbG9ycz9vbGRmb3JtYXQ9dHJ1ZSkgZm9yIHRoZSBjb2xvciB1c2VkIGluIHRoZSB2aXN1YWxpemF0aW9uIGluY2x1ZGVkIGluIHRoZSBQREY6IGAjMDA4MzkzYC4gCgpgYGB7cn0KZmFfZmlndXJpbmUgPC0gaW1hZ2VfcmVhZCgiaHR0cHM6Ly91cGxvYWQud2lraW1lZGlhLm9yZy93aWtpcGVkaWEvY29tbW9ucy83LzdjL1VzZXJfZm9udF9hd2Vzb21lLnN2ZyIpCgpmYV9maWd1cmluZSA8LSBpbWFnZV9maWxsKGZhX2ZpZ3VyaW5lLAogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yID0gIiMwMDgzOTMiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICBwb2ludCA9ICIrODAwKzgwMCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgZnV6eiA9IDApCgpmYV9maWd1cmluZSA8LSBpbWFnZV9maWxsKGZhX2ZpZ3VyaW5lLAogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yID0gIiMwMDgzOTMiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICBwb2ludCA9ICIrODAwKzEwMDAiLAogICAgICAgICAgICAgICAgICAgICAgICAgIGZ1enogPSAwKQoKZGYxICU+JQogIGZpbHRlcihUeXBlID09ICJSQUNFIFRPVEFMIikgJT4lCiAgZ2dwbG90KGFlcyh4ID0gWWVhciwgeSA9IFJhdGUsIGdyb3VwPVJhY2UpKSArCiAgZ2VvbV9saW5lKGNvbG9yID0gIiMwMDgzOTMiLCBzaXplID0gMC41KSArCiAgZ2VvbV9wb2ludChjb2xvciA9ICIjMDA4MzkzIiwgc2l6ZSA9IDMpICsKICBzY2FsZV94X2NvbnRpbnVvdXMoYnJlYWtzID0gc2VxKDIwMDgsMjAxOCwgYnk9MSksCiAgICAgICAgICAgICAgICAgICAgIGxpbWl0cyA9IGMoMjAwOCwyMDE4KSkgKwogIHNjYWxlX3lfY29udGludW91cyhicmVha3MgPSBzZXEoNSwzMCwgYnkgPTUpLAogICAgICAgICAgICAgICAgICAgICBsaW1pdHMgPSBjKDUsMzApKSArCiAgZHJhd19pbWFnZShmYV9maWd1cmluZSwgeCA9IDIwMTcsIHkgPSAyMy41LCBzY2FsZSA9IDIpICsKICBkcmF3X2ltYWdlKGZhX2ZpZ3VyaW5lLCB4ID0gMjAxNywgeSA9IDE3LjUsIHNjYWxlID0gMikgKwogIGRyYXdfaW1hZ2UoZmFfZmlndXJpbmUsIHggPSAyMDE3LCB5ID0gMTMsIHNjYWxlID0gMikgKwogIGRyYXdfaW1hZ2UoZmFfZmlndXJpbmUsIHggPSAyMDE3LCB5ID0gOSwgc2NhbGUgPSAyKSArCiAgZHJhd19pbWFnZShmYV9maWd1cmluZSwgeCA9IDIwMTcsIHkgPSA2LjUsIHNjYWxlID0gMikgKwogIGxhYnModGl0bGUgPSAiRklHVVJFIDEgWU9VVEggRElTQ09OTkVDVElPTiBCWSBSQUNFIEFORCBFVEhOSUNJVFksIDIwMDggLSAyMDE3IiwKICAgICAgIHkgPSAiWU9VVEggRElTQ09OTkVDVElPTiAoJSkiKSArCiAgdGhlbWVfY2xhc3NpYygpICsKICB0aGVtZSh0aXRsZSA9IGVsZW1lbnRfdGV4dChzaXplID0gMTAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3IgPSAiIzAwODM5MyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFjZSA9ICJib2xkIiksCiAgICAgICAgYXhpcy50aXRsZS54ID0gZWxlbWVudF9ibGFuaygpKQpgYGAKCldlIGNhbiBidWlsZCBvZmYgb2YgdGhpcyBpZGVhLCB1c2luZyBhIGN1c3RvbSBjb2xvciBwYWxldHRlIHRvIGNyZWF0ZSBhIGdyYWRpZW50IGJhc2VkIG9mZiB0aGUgY29sb3IgdXNlZC4gCgpgYGB7cn0KY3VzdG9tX3BhbCA8LSBjb2xvclJhbXBQYWxldHRlKGMoIndoaXRlIiwgIiMwMDgzOTMiKSkKZ2VuZGVyX24gPC0gMwoKYXNpYW5fdG90YWwgPC0gZGYyICU+JQogIGZpbHRlcihZZWFyID09IDIwMTcpICU+JQogIGZpbHRlcihHZW5kZXIgPT0gIkFMTCIsCiAgICAgICAgIFN1Ymdyb3VwID09ICJBTEwiKSAlPiUKICBwdWxsKFJhdGUpCgpkZjIgJT4lCiAgZmlsdGVyKFllYXIgPT0gMjAxNykgJT4lCiAgY29tcGxldGUoR2VuZGVyLCBTdWJncm91cCkgJT4lCiAgZ3JvdXBfYnkoR2VuZGVyKSAlPiUKICBtdXRhdGUoc3ViX3JhbmsgPSByYW5rKFJhdGUsIHRpZXMubWV0aG9kID0gIm1pbiIpKSAlPiUKICBncm91cF9ieShTdWJncm91cCkgJT4lCiAgbXV0YXRlKHJhbmtfYWxsID0gc3ViX3JhbmtbR2VuZGVyID09ICJBTEwiXSkgJT4lCiAgdW5ncm91cCgpICU+JQogIG11dGF0ZShTdWJncm91cCA9IGZjdF9yZW9yZGVyKFN1Ymdyb3VwLCByYW5rX2FsbCkpICU+JQogIGdncGxvdChhZXMoeCA9IFN1Ymdyb3VwLCB5ID0gUmF0ZSwgZmlsbCA9IEdlbmRlcikpICsKICBnZW9tX2hsaW5lKHlpbnRlcmNlcHQgPSBhc2lhbl90b3RhbCwgCiAgICAgICAgICAgICBjb2xvciA9ICJibGFjayIsCiAgICAgICAgICAgICBsaW5ldHlwZSA9IDIpICsgCiAgZ2VvbV9iYXIoc3RhdCA9ICJpZGVudGl0eSIsCiAgICAgICAgICAgY29sb3IgPSAidHJhbnNwYXJlbnQiLAogICAgICAgICAgIHNpemUgPSAwLjUsCiAgICAgICAgICAgcG9zaXRpb24gPSAiZG9kZ2UiLAogICAgICAgICAgIHdpZHRoID0gMC41KSArCiAgbGFicyh0aXRsZSA9ICJGSUdVUkUgWCBZT1VUSCBESVNDT05ORUNUSU9OIEJZIEFTSUFOIFNVQkdST1VQLCAyMDE3IiwKICAgICAgIHN1YnRpdGxlID0gIk9SREVSRUQgQlkgT1ZFUkFMTCBESVNDT05ORUNUSU9OIiwKICAgICAgIHkgPSAiWU9VVEggRElTQ09OTkVDVElPTiAoJSkiLAogICAgICAgZmlsbCA9ICJHZW5kZXIiKSArCiAgc2NhbGVfZmlsbF9tYW51YWwodmFsdWVzID0gcmV2KGN1c3RvbV9wYWwoZ2VuZGVyX24gKyAxKSkpICsKICBzY2FsZV95X2NvbnRpbnVvdXMoYnJlYWtzID0gc2VxKDAsMjAsMiksCiAgICAgICAgICAgICAgICAgICAgIGxhYmVscyA9IHNlcSgwLDIwLDIpLAogICAgICAgICAgICAgICAgICAgICBsaW1pdHMgPSBjKDAsMjApKSArCiAgdGhlbWVfY2xhc3NpYygpICsKICB0aGVtZSh0aXRsZSA9IGVsZW1lbnRfdGV4dChzaXplID0gMTAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3IgPSAiIzAwODM5MyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFjZSA9ICJib2xkIiksCiAgICAgICAgYXhpcy50aXRsZS54ID0gZWxlbWVudF9ibGFuaygpLAogICAgICAgIGF4aXMudGV4dC54ID0gZWxlbWVudF90ZXh0KGFuZ2xlID0gOTAsIGhqdXN0ID0gMSkpICsKICBhbm5vdGF0ZSgidGV4dCIsIGxhYmVsID0gJ2JvbGQoIkFTSUFOIFRPVEFMIiknLAogICAgICAgICAgIGNvbG9yID0gIiMwMDgzOTMiLCAKICAgICAgICAgICBzaXplID0gMywKICAgICAgICAgICB4ID0gMS4yLAogICAgICAgICAgIHkgPSBhc2lhbl90b3RhbCArIDEsCiAgICAgICAgICAgcGFyc2UgPSBUUlVFKQpgYGAKCkZyb20gdGhlIGFib3ZlIHBsb3QsIGl0IGJlY29tZXMgYXBwYXJlbnQgdGhhdCB0aGUgSG1vbmcgc3ViZ3JvdXAgcHJvZHVjZXMgYSBzbWFsbCBwcm9wb3J0aW9uIG9mIHRoZSB0b3RhbCBudW1iZXIgb2YgYXNpYW4gZGlzY29ubmVjdGVkIHlvdXRoLiBUaGUgQXNpYW4gdG90YWwgeW91dGggZGlzY29ubmVjdGlvbiByYXRlIGlzIG1vcmUgYWxpa2UgdGhlIHlvdXRoIGRpc2Nvbm5lY3Rpb24gcmF0ZXMgZm9yIGFsbCBvdGhlciBzdWJncm91cHMgdGhhbiB0aGUgSG1vbmcgeW91dGggZGlzY29ubmVjdGlvbiByYXRlLgoKV2UgY2FuIGNvbmZpcm0gdGhpcyBieSByZXZpc2l0aW5nIHRoZSB0YWJsZS4KCmBgYHtyfQppbWFnZTIKYGBgCgpUaGUgSG1vbmcgZ3JvdXAgcmVwcmVzZW50cyBgciByb3VuZCgoODMwMCoxMDApLzE0NTYwMClgJSBvZiBhbGwgQXNpYW4gZGlzY29ubmVjdGVkIHlvdXRoLiAKClRoaXMgc2hvd3MgdGhlIGltcG9ydGFuY2Ugb2YgYWRkaW5nIHNtYWxsIGRldGFpbHMgc3VjaCBhcyB0aGUgY29tcG9zaXRlIGxpbmUgdG8gcGxvdHMuIEl0IGhlbHBzIHByb3ZpZGUgYSBzaW1wbGUgeWV0IG51YW5jZWQgcGljdHVyZSBvZiB3aGF0IGlzIGdvaW5nIG9uLiAKCkxhc3RseSwgd2UgY2FuIGFkZCBhbm5vdGF0aW9ucyB0byBhZGQgcHJvdmlkZSBldmVuIG1vcmUgZGVwdGggdG8gdGhlIHZpc3VhbGl6YXRpb24uIAoKYGBge3J9CmxhdGlub19hX3RvdGFsIDwtIGRmMyAlPiUKICBmaWx0ZXIoWWVhciA9PSAyMDE3KSAlPiUKICBmaWx0ZXIoR2VuZGVyID09ICJBTEwiLAogICAgICAgICBTdWJncm91cCA9PSAiQUxMIikgJT4lCiAgcHVsbChSYXRlKQoKZGYzICU+JQogIGZpbHRlcihZZWFyID09IDIwMTcpICU+JQogIGNvbXBsZXRlKEdlbmRlciwgU3ViZ3JvdXApICU+JQogIGdyb3VwX2J5KEdlbmRlcikgJT4lCiAgbXV0YXRlKHN1Yl9yYW5rID0gcmFuayhSYXRlLCB0aWVzLm1ldGhvZCA9ICJtaW4iKSkgJT4lCiAgZ3JvdXBfYnkoU3ViZ3JvdXApICU+JQogIG11dGF0ZShyYW5rX2FsbCA9IHN1Yl9yYW5rW0dlbmRlciA9PSAiQUxMIl0pICU+JQogIHVuZ3JvdXAoKSAlPiUKICBtdXRhdGUoU3ViZ3JvdXAgPSBmY3RfcmVvcmRlcihTdWJncm91cCwgcmFua19hbGwpKSAlPiUKICBnZ3Bsb3QoYWVzKHggPSBTdWJncm91cCwgeSA9IFJhdGUsIGZpbGwgPSBHZW5kZXIpKSArCiAgZ2VvbV9obGluZSh5aW50ZXJjZXB0ID0gbGF0aW5vX2FfdG90YWwsIAogICAgICAgICAgICAgY29sb3IgPSAiYmxhY2siLAogICAgICAgICAgICAgbGluZXR5cGUgPSAyKSArIAogIGdlb21fYmFyKHN0YXQgPSAiaWRlbnRpdHkiLAogICAgICAgICAgIGNvbG9yID0gInRyYW5zcGFyZW50IiwKICAgICAgICAgICBzaXplID0gMC41LAogICAgICAgICAgIHBvc2l0aW9uID0gImRvZGdlIiwKICAgICAgICAgICB3aWR0aCA9IDAuNSkgKwogIGxhYnModGl0bGUgPSAiRklHVVJFIFggWU9VVEggRElTQ09OTkVDVElPTiBCWSBMQVRJTk8vQSBTVUJHUk9VUCwgMjAxNyIsCiAgICAgICBzdWJ0aXRsZSA9ICJPUkRFUkVEIEJZIE9WRVJBTEwgRElTQ09OTkVDVElPTiIsCiAgICAgICB5ID0gIllPVVRIIERJU0NPTk5FQ1RJT04gKCUpIiwKICAgICAgIGZpbGwgPSAiR2VuZGVyIikgKwogIHNjYWxlX2ZpbGxfbWFudWFsKHZhbHVlcyA9IHJldihjdXN0b21fcGFsKGdlbmRlcl9uICsgMSkpKSArCiAgc2NhbGVfeV9jb250aW51b3VzKGJyZWFrcyA9IHNlcSgwLDIwLDIpLAogICAgICAgICAgICAgICAgICAgICBsYWJlbHMgPSBzZXEoMCwyMCwyKSwKICAgICAgICAgICAgICAgICAgICAgbGltaXRzID0gYygwLDIwKSkgKwogIHRoZW1lX2NsYXNzaWMoKSArCiAgdGhlbWUodGl0bGUgPSBlbGVtZW50X3RleHQoc2l6ZSA9IDEwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yID0gIiMwMDgzOTMiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhY2UgPSAiYm9sZCIpLAogICAgICAgIGF4aXMudGl0bGUueCA9IGVsZW1lbnRfYmxhbmsoKSwKICAgICAgICBheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDkwLCBoanVzdCA9IDEpKSArCiAgYW5ub3RhdGUoInRleHQiLCBsYWJlbCA9ICdib2xkKCJMQVRJTk8gVE9UQUwiKScsCiAgICAgICAgICAgY29sb3IgPSAiIzAwODM5MyIsIAogICAgICAgICAgIHNpemUgPSAzLAogICAgICAgICAgIHggPSAxLjIsCiAgICAgICAgICAgeSA9IGxhdGlub19hX3RvdGFsICsgMSwKICAgICAgICAgICBwYXJzZSA9IFRSVUUpCmBgYAoKYGBge3J9CmRmMiAlPiUKICBjb21wbGV0ZShHZW5kZXIsIFN1Ymdyb3VwLCBZZWFyKSAlPiUKICBncm91cF9ieShTdWJncm91cCkgJT4lCiAgbXV0YXRlKG1pc3NpbmcgPSBzdW0oaXMubmEoUmF0ZSkpKSAlPiUKICBmaWx0ZXIobWlzc2luZyA9PSAwKSAlPiUKICBkcGx5cjo6c2VsZWN0KC1taXNzaW5nKSAlPiUKICB1bmdyb3VwKCkgJT4lCiAgZ3JvdXBfYnkoR2VuZGVyKSAlPiUKICBtdXRhdGUoc3ViX3JhbmsgPSByYW5rKFJhdGUsIHRpZXMubWV0aG9kID0gIm1pbiIpKSAlPiUKICBncm91cF9ieShTdWJncm91cCwgWWVhcikgJT4lCiAgbXV0YXRlKHJhbmtfYWxsID0gc3ViX3JhbmtbR2VuZGVyID09ICJBTEwiXSkgJT4lCiAgdW5ncm91cCgpICU+JQogIGdyb3VwX2J5KFllYXIpICU+JQogIG11dGF0ZSh0aHJlc2hvbGQgPSBSYXRlW0dlbmRlciA9PSAiQUxMIiAmIFN1Ymdyb3VwID09ICJBTEwiXSkgJT4lCiAgdW5ncm91cCgpICU+JQogIG11dGF0ZShTdWJncm91cCA9IGZjdF9yZW9yZGVyKFN1Ymdyb3VwLCByYW5rX2FsbCkpICU+JQogIGdncGxvdChhZXMoeCA9IFN1Ymdyb3VwLCB5ID0gUmF0ZSwgZmlsbCA9IEdlbmRlcikpICsKICBmYWNldF93cmFwKFllYXIgfi4sIG5jb2wgPSAxKSArCiAgZ2VvbV9obGluZShhZXMoeWludGVyY2VwdCA9IHRocmVzaG9sZCksIGxpbmV0eXBlID0gMikgKwogIGdlb21fYmFyKHN0YXQgPSAiaWRlbnRpdHkiLAogICAgICAgICAgIGNvbG9yID0gInRyYW5zcGFyZW50IiwKICAgICAgICAgICBzaXplID0gMC41LAogICAgICAgICAgIHBvc2l0aW9uID0gImRvZGdlIiwKICAgICAgICAgICB3aWR0aCA9IDAuNSkgKwogIGxhYnModGl0bGUgPSAiRklHVVJFIFggWU9VVEggRElTQ09OTkVDVElPTiBCWSBBU0lBTiBTVUJHUk9VUCwgMjAxNy0yMDE4IiwKICAgICAgIHN1YnRpdGxlID0gIk9SREVSRUQgQlkgT1ZFUkFMTCBESVNDT05ORUNUSU9OIiwKICAgICAgIHkgPSAiWU9VVEggRElTQ09OTkVDVElPTiAoJSkiLAogICAgICAgZmlsbCA9ICJHZW5kZXIiKSArCiAgc2NhbGVfZmlsbF9tYW51YWwodmFsdWVzID0gcmV2KGN1c3RvbV9wYWwoZ2VuZGVyX24gKyAxKSkpICsKICBzY2FsZV95X2NvbnRpbnVvdXMoYnJlYWtzID0gc2VxKDAsMTAsMiksCiAgICAgICAgICAgICAgICAgICAgIGxhYmVscyA9IHNlcSgwLDEwLDIpLAogICAgICAgICAgICAgICAgICAgICBsaW1pdHMgPSBjKDAsMTApKSArCiAgdGhlbWVfY2xhc3NpYygpICsKICB0aGVtZSh0aXRsZSA9IGVsZW1lbnRfdGV4dChzaXplID0gMTAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3IgPSAiIzAwODM5MyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFjZSA9ICJib2xkIiksCiAgICAgICAgYXhpcy50aXRsZS54ID0gZWxlbWVudF9ibGFuaygpLAogICAgICAgIGF4aXMudGV4dC54ID0gZWxlbWVudF90ZXh0KGFuZ2xlID0gOTAsIGhqdXN0ID0gMSkpCmBgYAoKYGBge3J9CmRmMyAlPiUKICBjb21wbGV0ZShHZW5kZXIsIFN1Ymdyb3VwLCBZZWFyKSAlPiUKICBncm91cF9ieShTdWJncm91cCkgJT4lCiAgbXV0YXRlKG1pc3NpbmcgPSBzdW0oaXMubmEoUmF0ZSkpKSAlPiUKICBmaWx0ZXIobWlzc2luZyA9PSAwKSAlPiUKICBkcGx5cjo6c2VsZWN0KC1taXNzaW5nKSAlPiUKICB1bmdyb3VwKCkgJT4lCiAgZ3JvdXBfYnkoR2VuZGVyKSAlPiUKICBtdXRhdGUoc3ViX3JhbmsgPSByYW5rKFJhdGUsIHRpZXMubWV0aG9kID0gIm1pbiIpKSAlPiUKICBncm91cF9ieShTdWJncm91cCwgWWVhcikgJT4lCiAgbXV0YXRlKHJhbmtfYWxsID0gc3ViX3JhbmtbR2VuZGVyID09ICJBTEwiXSkgJT4lCiAgdW5ncm91cCgpICU+JQogIGdyb3VwX2J5KFllYXIpICU+JQogIG11dGF0ZSh0aHJlc2hvbGQgPSBSYXRlW0dlbmRlciA9PSAiQUxMIiAmIFN1Ymdyb3VwID09ICJBTEwiXSkgJT4lCiAgdW5ncm91cCgpICU+JQogIG11dGF0ZShTdWJncm91cCA9IGZjdF9yZW9yZGVyKFN1Ymdyb3VwLCByYW5rX2FsbCkpICU+JQogIGdncGxvdChhZXMoeCA9IFN1Ymdyb3VwLCB5ID0gUmF0ZSwgZmlsbCA9IEdlbmRlcikpICsKICBmYWNldF93cmFwKFllYXIgfi4sIG5jb2wgPSAxKSArCiAgZ2VvbV9obGluZShhZXMoeWludGVyY2VwdCA9IHRocmVzaG9sZCksIGxpbmV0eXBlID0gMikgKwogIGdlb21fYmFyKHN0YXQgPSAiaWRlbnRpdHkiLAogICAgICAgICAgIGNvbG9yID0gInRyYW5zcGFyZW50IiwKICAgICAgICAgICBzaXplID0gMC41LAogICAgICAgICAgIHBvc2l0aW9uID0gImRvZGdlIiwKICAgICAgICAgICB3aWR0aCA9IDAuNSkgKwogIGxhYnModGl0bGUgPSAiRklHVVJFIFggWU9VVEggRElTQ09OTkVDVElPTiBCWSBMQVRJTk8vQSBTVUJHUk9VUCwgMjAxNyIsCiAgICAgICBzdWJ0aXRsZSA9ICJPUkRFUkVEIEJZIE9WRVJBTEwgRElTQ09OTkVDVElPTiIsCiAgICAgICB5ID0gIllPVVRIIERJU0NPTk5FQ1RJT04gKCUpIiwKICAgICAgIGZpbGwgPSAiR2VuZGVyIikgKwogIHNjYWxlX2ZpbGxfbWFudWFsKHZhbHVlcyA9IHJldihjdXN0b21fcGFsKGdlbmRlcl9uICsgMSkpKSArCiAgc2NhbGVfeV9jb250aW51b3VzKGJyZWFrcyA9IHNlcSgwLDIwLDIpLAogICAgICAgICAgICAgICAgICAgICBsYWJlbHMgPSBzZXEoMCwyMCwyKSwKICAgICAgICAgICAgICAgICAgICAgbGltaXRzID0gYygwLDIwKSkgKwogIHRoZW1lX2NsYXNzaWMoKSArCiAgdGhlbWUodGl0bGUgPSBlbGVtZW50X3RleHQoc2l6ZSA9IDEwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yID0gIiMwMDgzOTMiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhY2UgPSAiYm9sZCIpLAogICAgICAgIGF4aXMudGl0bGUueCA9IGVsZW1lbnRfYmxhbmsoKSwKICAgICAgICBheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDkwLCBoanVzdCA9IDEpKQpgYGAKCiMjICoqU3VtbWFyeSoqCioqKiAKCiMjICoqU3VnZ2VzdGVkIEhvbWV3b3JrKioKKioqIAoKMSkgRmluZCBhbm90aGVyIHRhYmxlIGluIHRoZSBkb2N1bWVudC4gRmluZCBkaWZmZXJlbmNlcyBiZXR3ZWVuIGdyb3VwcyB3aXRoIHRoZSBwcm9jZXNzIGRlc2NyaWJlZCBhYm92ZS4gCgojIyAqKkhlbHBmdWwgTGlua3MqKgoqKiogCgoKYXZvY2FkbypUaGlzIGNvbmNlcHRzIGxpc3RlZCBoZXJlIG11c3QgYmUgcmV2aXNpdGVkLioKCgo8dT5UZXJtcyBhbmQgY29uY2VwdHMgY292ZXJlZDo8L3U+ICAKCltUaWR5dmVyc2VdKGh0dHBzOi8vd3d3LnRpZHl2ZXJzZS5vcmcvKXt0YXJnZXQ9Il9ibGFuayJ9ICAKW1JTdHVkaW8gY2hlYXRzaGVldHNdKGh0dHBzOi8vcnN0dWRpby5jb20vcmVzb3VyY2VzL2NoZWF0c2hlZXRzLyl7dGFyZ2V0PSJfYmxhbmsifSAgCltJbmZlcmVuY2VdKGh0dHBzOi8vd3d3LmJyaXRhbm5pY2EuY29tL3NjaWVuY2UvaW5mZXJlbmNlLXN0YXRpc3RpY3Mpe3RhcmdldD0iX2JsYW5rIn0gIApbUmVncmVzc2lvbl0oaHR0cHM6Ly9saW5kZWxvZXYuZ2l0aHViLmlvL3Rlc3RzLWFzLWxpbmVhci8pe3RhcmdldD0iX2JsYW5rIn0gIApbRGlmZmVyZW50IHR5cGVzIG9mIHJlZ3Jlc3Npb25dKGh0dHBzOi8vd3d3LmFuYWx5dGljc3ZpZGh5YS5jb20vYmxvZy8yMDE1LzA4L2NvbXByZWhlbnNpdmUtZ3VpZGUtcmVncmVzc2lvbi8pe3RhcmdldD0iX2JsYW5rIn0gIApbT3JkaW5hcnkgbGVhc3Qgc3F1YXJlcyBtZXRob2RdKGh0dHA6Ly9zZXRvc2EuaW8vZXYvb3JkaW5hcnktbGVhc3Qtc3F1YXJlcy1yZWdyZXNzaW9uLyl7dGFyZ2V0PSJfYmxhbmsifSAgCltSZXNpZHVhbF0oaHR0cHM6Ly93d3cuc3RhdGlzdGljc2hvd3RvLmRhdGFzY2llbmNlY2VudHJhbC5jb20vcmVzaWR1YWwvKXt0YXJnZXQ9Il9ibGFuayJ9ICAKCjx1PlBhY2thZ2VzIHVzZWQgaW4gdGhpcyBjYXNlIHN0dWR5OiA8L3U+CgogUGFja2FnZSAgIHwgVXNlICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAotLS0tLS0tLS0tIHwtLS0tLS0tLS0tLS0tClsqKmhlcmUqKl0oaHR0cHM6Ly9naXRodWIuY29tL2plbm55YmMvaGVyZV9oZXJlKXt0YXJnZXQ9Il9ibGFuayJ9ICAgICAgIHwgdG8gZWFzaWx5IGxvYWQgYW5kIHNhdmUgZGF0YQpbKip0aWR5dmVyc2UqKl0oaHR0cHM6Ly9yZWFkci50aWR5dmVyc2Uub3JnLyl7dGFyZ2V0PSJfYmxhbmsifSAgICAgIHwgZm9yIGRhdGEgc2NpZW5jZSBvcGVyYXRpb25zClsqKnBkZnRvb2xzKipdKGh0dHBzOi8vcmVhZHIudGlkeXZlcnNlLm9yZy8pe3RhcmdldD0iX2JsYW5rIn0gICAgICB8IHRvIG1hbmFnZSBQREYgZG9jdW1lbnRzClsqKm1hZ2ljayoqXShodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvbWFnaWNrL3ZpZ25ldHRlcy9pbnRyby5odG1sI0tlcm5lbF9jb252b2x1dGlvbil7dGFyZ2V0PSJfYmxhbmsifSAgICAgIHwgZm9yIGltYWdlIHByb2Nlc3NpbmcgCgojIyBBY2tub3dsZWRnZW1lbnRzCgpXZSB3b3VsZCBsaWtlIHRvIGFja25vd2xlZGdlIFtUYW1hciBNZW5kZWxzb25dKGh0dHBzOi8vd3d3Lmpoc3BoLmVkdS9mYWN1bHR5L2RpcmVjdG9yeS9wcm9maWxlLzE3NzAvdGFtYXItbWVuZGVsc29uKSBmb3IgYXNzaXN0aW5nIGluIGZyYW1pbmcgdGhlIG1ham9yIGRpcmVjdGlvbiBvZiB0aGUgY2FzZSBzdHVkeS4KCldlIHdvdWxkIGFsc28gbGlrZSB0byBhY2tub3dsZWRnZSB0aGUgW0Jsb29tYmVyZyBBbWVyaWNhbiBIZWFsdGggSW5pdGlhdGl2ZV0oaHR0cHM6Ly9hbWVyaWNhbmhlYWx0aC5qaHUuZWR1LykgZm9yIGZ1bmRpbmcgdGhpcyB3b3JrLiA=</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("index.Rmd");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
